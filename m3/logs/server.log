2023-03-18 21:24:33,976 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:24:33,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:24:33,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:24:33,978 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:24:33,978 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:24:33,979 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:24:33,979 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:24:33,980 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:24:33,980 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:24:33,981 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:24:33,981 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:24:33,982 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:24:33,982 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:24:33,983 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:24:33,983 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:24:33,984 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:24:33,994 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:24:33,999 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:24:34,004 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980077, negotiated timeout = 40000
2023-03-18 21:24:34,006 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:24:34,006 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:24:34,006 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:24:34,008 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980078, negotiated timeout = 40000
2023-03-18 21:24:34,015 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:24:34,017 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:24:34,023 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:24:34,024 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 21:24:34,025 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:24:42,451 INFO  [Thread-0] root: Connected to localhost on port 57088
2023-03-18 21:24:45,362 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:24:45,362 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:24:45,363 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:24:45,363 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:24:45,364 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:24:45,364 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:24:45,365 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:24:45,365 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:24:45,366 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:24:45,367 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:24:45,367 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:24:45,368 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:24:45,368 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:24:45,369 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:24:45,369 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:24:45,370 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:24:45,381 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:24:45,387 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:24:45,393 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980079, negotiated timeout = 40000
2023-03-18 21:24:45,395 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:24:45,396 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:24:45,396 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:24:45,398 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98007a, negotiated timeout = 40000
2023-03-18 21:24:45,405 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:24:45,408 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:24:45,413 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:24:45,414 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:24:45,415 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:24:45,416 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:24:45,416 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:24:45,416 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:24:45,417 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:24:45,418 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:24:45,418 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 21:24:45,418 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:24:45,420 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:24:45,420 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:24:45,420 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:24:45,421 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:24:45,421 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 21:24:45,421 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:24:45,421 INFO  [Thread-0] root: Connected to localhost on port 57102
2023-03-18 21:24:45,422 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:24:45,422 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:24:45,423 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:24:45,426 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:24:45,426 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:24:45,426 INFO  [Thread-2] root: Recieved message with raw bytes [B@bf93ff9
2023-03-18 21:24:45,427 INFO  [Thread-0] root: Connected to localhost on port 43802
2023-03-18 21:24:45,426 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:24:45,427 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:45,427 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:24:45,427 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:24:45,434 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:24:45,434 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:24:45,434 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3ffdea8e
2023-03-18 21:24:45,434 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:45,434 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:24:45,434 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:24:45,435 INFO  [Thread-2] root: Recieved message with raw bytes [B@1ca8a96a
2023-03-18 21:24:45,435 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:24:45,435 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:45,437 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:24:45,437 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:24:45,439 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:24:45,439 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:24:45,439 INFO  [main-EventThread] root: Recieved message with raw bytes [B@29552263
2023-03-18 21:24:45,439 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:45,439 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:24:45,439 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:24:45,440 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:24:45,441 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:24:48,012 INFO  [Thread-2] root: Recieved message with raw bytes [B@8591c4a
2023-03-18 21:24:48,013 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:24:48,013 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 21:24:48,013 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:24:48,014 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,<127.0.0.1:8086>;
'
2023-03-18 21:24:50,955 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:24:50,956 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:24:50,957 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:24:50,957 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:24:50,958 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:24:50,958 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:24:50,958 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:24:50,959 INFO  [Thread-4] root: Recieved message with raw bytes [B@158f0749
2023-03-18 21:24:50,959 INFO  [Thread-0] root: Connected to localhost on port 57110
2023-03-18 21:24:50,960 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:50,961 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 21:24:50,961 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:24:50,963 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:24:50,963 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:24:50,963 INFO  [Thread-1] root: Recieved message with raw bytes [B@343a6e4e
2023-03-18 21:24:50,963 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:50,963 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:24:50,963 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:24:50,963 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:24:50,963 INFO  [Thread-4] root: Recieved message with raw bytes [B@1b48fb88
2023-03-18 21:24:50,964 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:50,964 INFO  [Thread-4] root: Message: DATATRANSFERfuckthis

2023-03-18 21:24:50,965 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:24:50,966 INFO  [Thread-4] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:24:50,966 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:24:50,966 INFO  [Thread-1] root: Recieved message with raw bytes [B@3afd86b9
2023-03-18 21:24:50,967 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:24:50,967 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:24:50,967 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:24:50,967 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 21:24:50,974 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:24:50,975 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:24:50,976 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:24:50,976 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:24:50,977 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:24:53,440 INFO  [Thread-2] root: Recieved message with raw bytes [B@64bb518c
2023-03-18 21:24:53,440 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:24:53,440 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 21:24:53,440 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:24:53,440 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:27:43,945 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:27:43,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:27:43,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:27:43,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:27:43,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:27:43,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:27:43,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:27:43,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:27:43,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:27:43,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:27:43,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:27:43,951 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:27:43,951 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:27:43,952 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:27:43,953 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:27:43,954 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:27:43,963 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:27:43,968 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:27:43,972 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98007b, negotiated timeout = 40000
2023-03-18 21:27:43,974 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:27:43,974 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:27:43,975 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:27:43,977 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98007c, negotiated timeout = 40000
2023-03-18 21:27:43,983 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:27:43,985 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:27:43,992 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:27:43,993 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:27:43,994 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 21:27:50,385 INFO  [Thread-0] root: Connected to localhost on port 45502
2023-03-18 21:27:53,757 INFO  [Thread-2] root: Recieved message with raw bytes [B@6fd3ec05
2023-03-18 21:27:53,758 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:27:53,759 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 21:27:53,759 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:27:53,760 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '
'
2023-03-18 21:27:58,366 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:27:58,366 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:27:58,367 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:27:58,368 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:27:58,368 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:27:58,369 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:27:58,370 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:27:58,370 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:27:58,371 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:27:58,372 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:27:58,372 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:27:58,373 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:27:58,374 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:27:58,374 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:27:58,375 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:27:58,376 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:27:58,386 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:27:58,391 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:27:58,397 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98007d, negotiated timeout = 40000
2023-03-18 21:27:58,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:27:58,399 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:27:58,399 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:27:58,401 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98007e, negotiated timeout = 40000
2023-03-18 21:27:58,408 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:27:58,411 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:27:58,416 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:27:58,417 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:27:58,418 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:27:58,418 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:27:58,419 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:27:58,420 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:27:58,421 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:27:58,421 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 21:27:58,421 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:27:58,421 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:27:58,423 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:27:58,423 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:27:58,423 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:27:58,424 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:27:58,424 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:27:58,425 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:27:58,425 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:27:58,425 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:27:58,425 INFO  [Thread-0] root: Connected to localhost on port 47710
2023-03-18 21:27:58,425 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 21:27:58,426 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:27:58,426 INFO  [Thread-3] root: Closing connection
2023-03-18 21:27:58,429 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:27:58,430 INFO  [Thread-2] root: Recieved message with raw bytes [B@2cb1dee7
2023-03-18 21:27:58,430 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:27:58,431 INFO  [Thread-0] root: Connected to localhost on port 56136
2023-03-18 21:27:58,431 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:27:58,430 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:58,432 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:27:58,432 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:27:58,438 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:27:58,439 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:27:58,439 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3ffdea8e
2023-03-18 21:27:58,439 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:58,439 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:27:58,439 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:27:58,439 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:27:58,439 INFO  [Thread-2] root: Recieved message with raw bytes [B@227432e8
2023-03-18 21:27:58,441 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:58,441 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:27:58,442 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:27:58,443 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:27:58,444 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:27:58,444 INFO  [main-EventThread] root: Recieved message with raw bytes [B@29552263
2023-03-18 21:27:58,444 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:58,444 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:27:58,444 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:27:58,444 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:27:58,445 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:27:58,446 INFO  [Thread-2] root: Closing connection
2023-03-18 21:27:58,446 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:27:59,404 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:27:59,405 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:27:59,406 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:27:59,406 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:27:59,407 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:27:59,407 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:27:59,407 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:27:59,408 INFO  [Thread-4] root: Recieved message with raw bytes [B@73a78a18
2023-03-18 21:27:59,408 INFO  [Thread-0] root: Connected to localhost on port 47714
2023-03-18 21:27:59,408 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:59,409 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 21:27:59,409 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:27:59,411 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:27:59,411 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:27:59,411 INFO  [Thread-1] root: Recieved message with raw bytes [B@12aba607
2023-03-18 21:27:59,411 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:59,411 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:27:59,411 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:27:59,412 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:27:59,412 INFO  [Thread-4] root: Recieved message with raw bytes [B@7d606a1c
2023-03-18 21:27:59,412 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:59,413 INFO  [Thread-4] root: Message: DATATRANSFERfuckthis

2023-03-18 21:27:59,414 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:27:59,415 INFO  [Thread-4] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:27:59,415 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:27:59,415 INFO  [Thread-1] root: Recieved message with raw bytes [B@1c6c4a22
2023-03-18 21:27:59,415 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:27:59,415 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:27:59,416 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:27:59,416 INFO  [Thread-1] root: Closing connection
2023-03-18 21:27:59,416 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 21:27:59,417 INFO  [Thread-4] root: Closing connection
2023-03-18 21:27:59,423 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:27:59,424 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:27:59,425 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:27:59,426 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:27:59,426 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:28:02,770 INFO  [Thread-2] root: Recieved message with raw bytes [B@42fa52ef
2023-03-18 21:28:02,770 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:28:02,770 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 21:28:02,771 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:28:02,771 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:33:16,514 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:33:16,514 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:33:16,515 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:33:16,515 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:33:16,516 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:33:16,516 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:33:16,517 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:33:16,517 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:33:16,518 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:33:16,518 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:33:16,519 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:33:16,519 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:33:16,520 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:33:16,520 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:33:16,521 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:33:16,522 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:33:16,532 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:33:16,537 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:33:16,542 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98007f, negotiated timeout = 40000
2023-03-18 21:33:16,544 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:33:16,544 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:33:16,545 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:33:16,547 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980080, negotiated timeout = 40000
2023-03-18 21:33:16,553 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:33:16,557 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:33:16,563 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:33:16,564 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:33:16,565 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 21:33:22,780 INFO  [Thread-0] root: 0
2023-03-18 21:33:22,781 INFO  [Thread-0] root: Connected to localhost on port 41320
2023-03-18 21:33:25,135 INFO  [Thread-2] root: Recieved message with raw bytes [B@1bbbd253
2023-03-18 21:33:25,135 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 21:33:25,136 INFO  [Thread-2] root: Message: GETthis

2023-03-18 21:33:25,137 INFO  [Thread-2] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 21:33:25,137 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 21:33:25,138 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 21:33:25,138 INFO  [Thread-2] root: false
2023-03-18 21:33:25,139 INFO  [Thread-2] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:33:25,140 INFO  [Thread-2] root: []
2023-03-18 21:33:25,140 ERROR [Thread-2] root: 
2023-03-18 21:33:25,141 INFO  [Thread-2] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 21:33:27,960 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:33:27,960 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:33:27,961 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:33:27,961 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:33:27,962 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:33:27,963 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:33:27,963 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:33:27,964 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:33:27,964 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:33:27,965 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:33:27,966 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:33:27,966 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:33:27,966 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:33:27,966 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:33:27,966 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:33:27,966 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:33:27,976 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:33:27,980 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:33:27,985 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980081, negotiated timeout = 40000
2023-03-18 21:33:27,987 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:33:27,987 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:33:27,988 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:33:27,990 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980082, negotiated timeout = 40000
2023-03-18 21:33:27,997 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:33:27,999 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:33:28,004 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:33:28,006 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:33:28,006 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:33:28,006 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:33:28,007 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:33:28,007 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:33:28,008 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:33:28,009 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:33:28,009 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 21:33:28,009 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:33:28,009 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:33:28,010 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:33:28,010 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:33:28,011 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:33:28,012 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:33:28,012 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:33:28,012 INFO  [main-EventThread] root: 0
2023-03-18 21:33:28,012 INFO  [Thread-0] root: 0
2023-03-18 21:33:28,013 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:33:28,013 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:33:28,014 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:33:28,014 INFO  [Thread-0] root: Connected to localhost on port 41330
2023-03-18 21:33:28,015 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 21:33:28,015 INFO  [main-EventThread] root: 0
2023-03-18 21:33:28,016 INFO  [Thread-3] root: Closing connection
2023-03-18 21:33:28,015 INFO  [Thread-0] root: 0
2023-03-18 21:33:28,016 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:33:28,017 INFO  [Thread-2] root: Recieved message with raw bytes [B@102fe977
2023-03-18 21:33:28,017 INFO  [Thread-0] root: Connected to localhost on port 33614
2023-03-18 21:33:28,017 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:33:28,018 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:28,019 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:33:28,020 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:33:28,020 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:33:28,026 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:33:28,026 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:33:28,026 INFO  [main-EventThread] root: Recieved message with raw bytes [B@1d5ef9dc
2023-03-18 21:33:28,026 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:28,026 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:33:28,026 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:33:28,026 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:33:28,026 INFO  [Thread-2] root: Recieved message with raw bytes [B@7ba31fd
2023-03-18 21:33:28,027 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:28,028 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:33:28,029 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:33:28,030 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:33:28,030 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:33:28,030 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2c999d1e
2023-03-18 21:33:28,030 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:28,030 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:33:28,030 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:33:28,031 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:33:28,032 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:33:28,032 INFO  [Thread-2] root: Closing connection
2023-03-18 21:33:28,033 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:33:29,479 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:33:29,480 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:33:29,481 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:33:29,481 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:33:29,482 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:33:29,483 INFO  [Thread-1] root: 0
2023-03-18 21:33:29,483 INFO  [Thread-0] root: 0
2023-03-18 21:33:29,483 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:33:29,484 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:33:29,484 INFO  [Thread-0] root: Connected to localhost on port 41332
2023-03-18 21:33:29,484 INFO  [Thread-4] root: Recieved message with raw bytes [B@2b8daf45
2023-03-18 21:33:29,485 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:29,486 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 21:33:29,487 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:33:29,488 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:33:29,488 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:33:29,488 INFO  [Thread-1] root: Recieved message with raw bytes [B@3125a33
2023-03-18 21:33:29,489 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:29,489 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:33:29,489 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:33:29,489 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:33:29,489 INFO  [Thread-4] root: Recieved message with raw bytes [B@254a4444
2023-03-18 21:33:29,490 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:29,491 INFO  [Thread-4] root: Message: DATATRANSFERfuckthis

2023-03-18 21:33:29,492 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:33:29,493 INFO  [Thread-4] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:33:29,493 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:33:29,493 INFO  [Thread-1] root: Recieved message with raw bytes [B@dd5b421
2023-03-18 21:33:29,494 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:33:29,494 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:33:29,494 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:33:29,494 INFO  [Thread-1] root: Closing connection
2023-03-18 21:33:29,495 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 21:33:29,495 INFO  [Thread-4] root: Closing connection
2023-03-18 21:33:29,501 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:33:29,502 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:33:29,503 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:33:29,504 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:33:29,504 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:33:32,049 INFO  [Thread-2] root: Recieved message with raw bytes [B@4a6bfcc5
2023-03-18 21:33:32,049 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:33:32,049 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 21:33:32,049 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:33:32,049 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:33:53,262 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:33:53,262 INFO  [Thread-2] root: Closing connection
2023-03-18 21:33:58,784 INFO  [Thread-0] root: 0
2023-03-18 21:33:58,785 INFO  [Thread-0] root: Connected to localhost on port 34456
2023-03-18 21:37:43,288 ERROR [Thread-5] root: Error! Connection lost!
2023-03-18 21:37:43,288 INFO  [Thread-5] root: Closing connection
2023-03-18 21:37:51,198 INFO  [Thread-0] root: 0
2023-03-18 21:37:51,219 INFO  [Thread-0] root: Connected to localhost on port 34068
2023-03-18 21:37:59,927 ERROR [Thread-6] root: Error! Connection lost!
2023-03-18 21:37:59,927 INFO  [Thread-6] root: Closing connection
2023-03-18 21:38:21,414 INFO  [Thread-0] root: 0
2023-03-18 21:38:21,416 INFO  [Thread-0] root: Connected to localhost on port 33318
2023-03-18 21:38:28,063 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:38:28,064 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:38:28,064 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:38:28,064 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:38:28,065 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:38:28,066 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:38:28,066 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:38:28,067 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:38:28,067 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:38:28,068 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:38:28,069 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:38:28,069 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:38:28,070 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:38:28,070 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:38:28,070 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:38:28,071 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:38:28,080 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:38:28,085 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:38:28,090 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980083, negotiated timeout = 40000
2023-03-18 21:38:28,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:38:28,092 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:38:28,092 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:38:28,096 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980084, negotiated timeout = 40000
2023-03-18 21:38:28,104 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:38:28,107 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:38:28,111 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:28,113 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:38:28,113 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:38:28,114 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:38:28,114 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:38:28,114 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:38:28,115 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:38:28,115 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:28,116 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:38:28,117 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:38:28,118 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:38:28,118 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:38:28,119 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:38:28,120 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:38:28,120 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:38:28,121 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:38:28,122 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 21:38:28,123 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:38:28,123 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:38:28,124 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:28,124 INFO  [Thread-2] root: Recieved message with raw bytes [B@7e7f24cd
2023-03-18 21:38:28,124 INFO  [Thread-0] root: Connected to localhost on port 34928
2023-03-18 21:38:28,125 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,126 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:38:28,127 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:28,132 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:38:28,132 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:28,132 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3607e23f
2023-03-18 21:38:28,132 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,132 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:38:28,132 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:28,132 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:28,132 INFO  [Thread-2] root: Recieved message with raw bytes [B@634efcb8
2023-03-18 21:38:28,133 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,134 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:38:28,135 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:28,136 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:38:28,136 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:28,137 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5c2f5111
2023-03-18 21:38:28,137 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,137 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:38:28,137 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:28,137 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:38:28,138 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:38:28,139 INFO  [Thread-2] root: Closing connection
2023-03-18 21:38:28,139 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:38:28,813 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:38:28,813 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:38:28,814 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:38:28,814 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:38:28,815 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:38:28,816 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 21:38:28,816 INFO  [Thread-0] root: 0
2023-03-18 21:38:28,816 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:38:28,817 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:28,817 INFO  [Thread-0] root: Connected to localhost on port 33326
2023-03-18 21:38:28,817 INFO  [Thread-8] root: Recieved message with raw bytes [B@1033d8ce
2023-03-18 21:38:28,818 INFO  [Thread-8] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,818 INFO  [Thread-8] root: Message: DATATRANSFERecethis

2023-03-18 21:38:28,819 INFO  [Thread-8] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:28,820 INFO  [Thread-8] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:38:28,820 INFO  [Thread-8] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:28,820 INFO  [Thread-1] root: Recieved message with raw bytes [B@713baa5f
2023-03-18 21:38:28,821 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,821 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:38:28,821 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:28,821 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:28,821 INFO  [Thread-8] root: Recieved message with raw bytes [B@1ef424b8
2023-03-18 21:38:28,822 INFO  [Thread-8] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,822 INFO  [Thread-8] root: Message: DATATRANSFERfuckthis

2023-03-18 21:38:28,823 INFO  [Thread-8] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:28,825 INFO  [Thread-8] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:38:28,825 INFO  [Thread-8] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:28,825 INFO  [Thread-1] root: Recieved message with raw bytes [B@7ffc4a08
2023-03-18 21:38:28,825 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:28,825 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:38:28,825 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:28,825 INFO  [Thread-1] root: Closing connection
2023-03-18 21:38:28,825 ERROR [Thread-8] root: Error! Connection lost!
2023-03-18 21:38:28,825 INFO  [Thread-8] root: Closing connection
2023-03-18 21:38:28,831 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:28,832 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:38:28,833 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:38:28,834 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:38:28,834 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:31,687 INFO  [Thread-7] root: Recieved message with raw bytes [B@367a29fb
2023-03-18 21:38:31,687 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:38:31,687 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:38:31,687 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:38:31,687 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:38:40,174 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:38:40,174 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:38:40,174 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:38:40,175 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:38:40,175 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:38:40,176 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:38:40,176 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:38:40,177 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:38:40,177 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:38:40,178 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:38:40,178 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:38:40,179 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:38:40,180 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:38:40,180 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:38:40,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:38:40,182 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:38:40,191 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:38:40,198 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:38:40,203 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980085, negotiated timeout = 40000
2023-03-18 21:38:40,204 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:38:40,205 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:38:40,205 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:38:40,207 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980086, negotiated timeout = 40000
2023-03-18 21:38:40,214 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:38:40,216 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:38:40,220 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:40,222 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:38:40,223 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:38:40,224 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:38:40,224 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:40,225 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:38:40,226 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:38:40,226 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:38:40,226 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:38:40,229 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:38:40,229 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:38:40,230 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:38:40,231 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:38:40,231 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:38:40,231 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:38:40,232 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:38:40,234 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 21:38:40,234 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:38:40,235 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:38:40,236 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:40,236 INFO  [Thread-0] root: Connected to localhost on port 59280
2023-03-18 21:38:40,236 INFO  [Thread-2] root: Recieved message with raw bytes [B@102fe977
2023-03-18 21:38:40,238 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:40,238 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:38:40,239 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:40,244 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:38:40,244 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:40,244 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3607e23f
2023-03-18 21:38:40,244 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:40,244 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:38:40,244 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:40,244 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:40,245 INFO  [Thread-2] root: Recieved message with raw bytes [B@7ba31fd
2023-03-18 21:38:40,246 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:40,246 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:38:40,247 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:40,248 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:38:40,248 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:40,248 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5c2f5111
2023-03-18 21:38:40,248 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:40,248 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:38:40,248 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:40,249 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:38:40,249 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:38:40,249 INFO  [Thread-2] root: Closing connection
2023-03-18 21:38:40,250 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:38:41,672 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:38:41,672 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:38:41,673 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:38:41,673 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:38:41,674 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:38:41,674 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 21:38:41,674 INFO  [Thread-0] root: 0
2023-03-18 21:38:41,675 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:38:41,675 INFO  [Thread-0] root: Connected to localhost on port 59438
2023-03-18 21:38:41,675 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:41,675 INFO  [Thread-9] root: Recieved message with raw bytes [B@779619db
2023-03-18 21:38:41,677 INFO  [Thread-9] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:41,677 INFO  [Thread-9] root: Message: DATATRANSFERecethis

2023-03-18 21:38:41,678 INFO  [Thread-9] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:38:41,679 INFO  [Thread-9] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:38:41,679 INFO  [Thread-9] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:41,679 INFO  [Thread-1] root: Recieved message with raw bytes [B@343a6e4e
2023-03-18 21:38:41,680 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:41,680 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:38:41,680 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:38:41,680 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:41,680 INFO  [Thread-9] root: Recieved message with raw bytes [B@7951f959
2023-03-18 21:38:41,681 INFO  [Thread-9] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:41,681 INFO  [Thread-9] root: Message: DATATRANSFERfuckthis

2023-03-18 21:38:41,682 INFO  [Thread-9] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:38:41,683 INFO  [Thread-9] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:38:41,683 INFO  [Thread-9] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:41,683 INFO  [Thread-1] root: Recieved message with raw bytes [B@3afd86b9
2023-03-18 21:38:41,683 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:38:41,683 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:38:41,683 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:38:41,684 INFO  [Thread-1] root: Closing connection
2023-03-18 21:38:41,684 ERROR [Thread-9] root: Error! Connection lost!
2023-03-18 21:38:41,685 INFO  [Thread-9] root: Closing connection
2023-03-18 21:38:41,690 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:41,692 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:38:41,692 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:38:41,693 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:38:41,693 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:38:44,178 INFO  [Thread-7] root: Recieved message with raw bytes [B@38bdc144
2023-03-18 21:38:44,178 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:38:44,178 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:38:44,179 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:38:44,179 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:39:14,238 INFO  [Thread-7] root: Recieved message with raw bytes [B@3c82428b
2023-03-18 21:39:14,238 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 21:39:14,238 INFO  [Thread-7] root: Message: GETthis

2023-03-18 21:39:14,239 INFO  [Thread-7] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 21:39:14,240 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:39:14,240 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:39:14,240 INFO  [Thread-7] root: false
2023-03-18 21:39:14,240 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:14,240 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 21:39:14,240 INFO  [Thread-7] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 21:39:14,240 INFO  [Thread-7] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 21:39:14,240 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:14,240 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 21:39:14,241 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 21:39:14,242 ERROR [Thread-7] root: Key 'this' is not in the database
2023-03-18 21:39:14,242 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 21:39:33,231 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:39:33,231 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:39:33,232 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:39:33,233 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:39:33,233 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:39:33,234 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:39:33,234 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:39:33,235 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:39:33,235 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:39:33,236 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:39:33,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:39:33,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:39:33,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:39:33,239 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:39:33,239 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:39:33,240 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:39:33,250 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:39:33,257 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:39:33,262 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980087, negotiated timeout = 40000
2023-03-18 21:39:33,264 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:39:33,265 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:39:33,265 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:39:33,267 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980088, negotiated timeout = 40000
2023-03-18 21:39:33,274 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:39:33,277 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:39:33,281 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:33,283 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:39:33,284 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:39:33,284 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:39:33,284 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:39:33,285 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:39:33,285 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:33,286 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:33,286 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:39:33,288 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:33,288 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:39:33,288 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:39:33,289 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:39:33,290 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:39:33,290 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:39:33,291 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:39:33,293 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 21:39:33,293 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:39:33,293 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:39:33,295 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:39:33,295 INFO  [Thread-2] root: Recieved message with raw bytes [B@7e7f24cd
2023-03-18 21:39:33,295 INFO  [Thread-0] root: Connected to localhost on port 43838
2023-03-18 21:39:33,296 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:33,297 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:39:33,298 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:39:33,303 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:39:33,303 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:39:33,303 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3607e23f
2023-03-18 21:39:33,303 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:33,303 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:39:33,303 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:39:33,304 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:39:33,304 INFO  [Thread-2] root: Recieved message with raw bytes [B@634efcb8
2023-03-18 21:39:33,305 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:33,305 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:39:33,306 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:39:33,307 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:39:33,307 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:39:33,307 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5c2f5111
2023-03-18 21:39:33,307 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:33,307 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:39:33,308 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:39:33,308 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:39:33,309 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:39:33,309 INFO  [Thread-2] root: Closing connection
2023-03-18 21:39:33,310 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:39:34,309 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:39:34,310 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:39:34,310 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:39:34,311 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:39:34,312 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:39:34,312 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 21:39:34,312 INFO  [Thread-0] root: 0
2023-03-18 21:39:34,312 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:39:34,313 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:39:34,313 INFO  [Thread-10] root: Recieved message with raw bytes [B@7d9a789c
2023-03-18 21:39:34,313 INFO  [Thread-0] root: Connected to localhost on port 59470
2023-03-18 21:39:34,313 INFO  [Thread-10] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:34,315 INFO  [Thread-10] root: Message: DATATRANSFERecethis

2023-03-18 21:39:34,315 INFO  [Thread-10] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:39:34,317 INFO  [Thread-10] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:39:34,317 INFO  [Thread-10] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:39:34,317 INFO  [Thread-1] root: Recieved message with raw bytes [B@713baa5f
2023-03-18 21:39:34,317 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:34,317 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:39:34,317 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:39:34,317 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:39:34,317 INFO  [Thread-10] root: Recieved message with raw bytes [B@735d895f
2023-03-18 21:39:34,318 INFO  [Thread-10] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:34,318 INFO  [Thread-10] root: Message: DATATRANSFERfuckthis

2023-03-18 21:39:34,319 INFO  [Thread-10] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:39:34,320 INFO  [Thread-10] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:39:34,320 INFO  [Thread-10] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:39:34,320 INFO  [Thread-1] root: Recieved message with raw bytes [B@7ffc4a08
2023-03-18 21:39:34,320 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:39:34,320 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:39:34,320 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:39:34,321 INFO  [Thread-1] root: Closing connection
2023-03-18 21:39:34,321 ERROR [Thread-10] root: Error! Connection lost!
2023-03-18 21:39:34,321 INFO  [Thread-10] root: Closing connection
2023-03-18 21:39:34,327 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:34,328 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:39:34,329 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:39:34,329 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:34,330 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:36,447 INFO  [Thread-7] root: Recieved message with raw bytes [B@7980cb7f
2023-03-18 21:39:36,447 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:39:36,447 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:39:36,447 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:39:36,447 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:39:39,012 INFO  [Thread-7] root: Recieved message with raw bytes [B@1ed20045
2023-03-18 21:39:39,012 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 21:39:39,012 INFO  [Thread-7] root: Message: GETthis

2023-03-18 21:39:39,012 INFO  [Thread-7] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 21:39:39,015 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:39:39,015 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:39:39,015 INFO  [Thread-7] root: false
2023-03-18 21:39:39,015 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:39,015 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 21:39:39,019 INFO  [Thread-7] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 21:39:39,019 INFO  [Thread-7] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 21:39:39,020 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:39,020 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 21:39:39,021 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 21:39:39,022 ERROR [Thread-7] root: Key 'this' is not in the database
2023-03-18 21:39:39,022 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 21:39:46,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:39:46,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:39:46,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:39:46,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:39:46,641 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:39:46,641 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:39:46,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:39:46,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:39:46,643 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:39:46,644 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:39:46,644 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:39:46,645 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:39:46,645 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:39:46,646 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:39:46,646 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:39:46,647 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:39:46,657 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:39:46,662 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:39:46,667 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980089, negotiated timeout = 40000
2023-03-18 21:39:46,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:39:46,669 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:39:46,670 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:39:46,672 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98008a, negotiated timeout = 40000
2023-03-18 21:39:46,678 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:39:46,681 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:39:46,686 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:46,687 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:39:46,688 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:39:46,689 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:46,689 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:39:46,689 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:46,690 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:39:46,690 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:39:47,259 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:47,260 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:39:47,261 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:39:47,261 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:47,261 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:39:49,624 INFO  [Thread-7] root: Recieved message with raw bytes [B@3f8af035
2023-03-18 21:39:49,624 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 21:39:49,624 INFO  [Thread-7] root: Message: GETthis

2023-03-18 21:39:49,624 INFO  [Thread-7] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 21:39:49,624 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:39:49,624 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:39:49,624 INFO  [Thread-7] root: false
2023-03-18 21:39:49,624 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:49,624 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 21:39:49,624 INFO  [Thread-7] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 21:39:49,625 INFO  [Thread-7] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 21:39:49,625 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:39:49,625 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 21:39:49,625 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 21:39:49,625 ERROR [Thread-7] root: Key 'this' is not in the database
2023-03-18 21:39:49,625 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 21:40:51,835 INFO  [Thread-7] root: Recieved message with raw bytes [B@7e7edc0
2023-03-18 21:40:51,835 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-18 21:40:51,835 INFO  [Thread-7] root: Message: GETthat

2023-03-18 21:40:51,836 INFO  [Thread-7] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-18 21:40:51,836 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:40:51,836 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:40:51,836 INFO  [Thread-7] root: false
2023-03-18 21:40:51,836 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:40:51,836 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 21:40:51,837 INFO  [Thread-7] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-18 21:40:51,837 INFO  [Thread-7] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 21:40:51,837 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:40:51,837 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 21:40:51,837 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 21:40:51,837 ERROR [Thread-7] root: Key 'that' is not in the database
2023-03-18 21:40:51,837 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'that' and value ''
2023-03-18 21:40:55,079 INFO  [Thread-7] root: Recieved message with raw bytes [B@539410c2
2023-03-18 21:40:55,079 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-18 21:40:55,079 INFO  [Thread-7] root: Message: GETthat

2023-03-18 21:40:55,080 INFO  [Thread-7] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-18 21:40:55,080 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:40:55,080 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:40:55,080 INFO  [Thread-7] root: false
2023-03-18 21:40:55,080 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:40:55,080 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 21:40:55,081 INFO  [Thread-7] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-18 21:40:55,081 INFO  [Thread-7] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 21:40:55,081 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:40:55,081 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 21:40:55,081 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 21:40:55,081 ERROR [Thread-7] root: Key 'that' is not in the database
2023-03-18 21:40:55,081 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'that' and value ''
2023-03-18 21:40:57,219 INFO  [Thread-7] root: Recieved message with raw bytes [B@460a2680
2023-03-18 21:40:57,219 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-18 21:40:57,220 INFO  [Thread-7] root: Message: GETthat

2023-03-18 21:40:57,220 INFO  [Thread-7] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-18 21:40:57,221 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:40:57,222 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 21:40:57,222 INFO  [Thread-7] root: false
2023-03-18 21:40:57,222 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:40:57,222 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 21:40:57,222 INFO  [Thread-7] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-18 21:40:57,222 INFO  [Thread-7] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 21:40:57,222 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 21:40:57,223 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 21:40:57,223 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 21:40:57,223 ERROR [Thread-7] root: Key 'that' is not in the database
2023-03-18 21:40:57,223 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'that' and value ''
2023-03-18 21:43:50,975 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:43:50,976 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:43:50,976 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:43:50,976 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:43:50,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:43:50,978 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:43:50,978 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:43:50,979 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:43:50,979 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:43:50,989 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:43:50,994 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:43:50,999 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98008b, negotiated timeout = 40000
2023-03-18 21:43:51,001 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:43:51,002 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:43:51,002 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:43:51,004 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98008c, negotiated timeout = 40000
2023-03-18 21:43:51,012 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:43:51,014 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:43:51,019 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:43:51,020 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:43:51,021 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:43:51,021 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:43:51,021 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:43:51,021 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:43:51,023 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:43:51,023 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:43:52,574 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:43:52,575 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:43:52,576 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:43:52,576 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:43:52,577 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:43:55,423 INFO  [Thread-7] root: Recieved message with raw bytes [B@2ee96d2c
2023-03-18 21:43:55,423 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:43:55,423 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:43:55,423 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:43:55,423 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:44:01,392 INFO  [Thread-7] root: Recieved message with raw bytes [B@16d80cdc
2023-03-18 21:44:01,392 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:44:01,392 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:44:01,392 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:44:01,393 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:44:03,955 INFO  [Thread-7] root: Recieved message with raw bytes [B@65b90cc5
2023-03-18 21:44:03,955 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:44:03,955 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:44:03,955 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:44:03,956 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:44:05,765 INFO  [Thread-7] root: Recieved message with raw bytes [B@721008d4
2023-03-18 21:44:05,765 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:44:05,765 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:44:05,765 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:44:05,766 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:44:10,839 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:44:10,839 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:44:10,840 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:44:10,841 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:44:10,841 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:44:10,841 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:44:10,842 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:44:10,843 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:44:10,843 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:44:10,844 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:44:10,844 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:44:10,845 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:44:10,845 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:44:10,846 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:44:10,847 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:44:10,848 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:44:10,857 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:44:10,862 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:44:10,868 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98008d, negotiated timeout = 40000
2023-03-18 21:44:10,870 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:44:10,870 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:44:10,870 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:44:10,872 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98008e, negotiated timeout = 40000
2023-03-18 21:44:10,878 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:44:10,881 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:44:10,885 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:44:10,887 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:44:10,888 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:44:10,888 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:44:10,888 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:44:10,889 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:44:10,889 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:44:10,890 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:44:10,890 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:44:10,892 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:44:10,892 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:44:10,893 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:44:10,894 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:44:10,894 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:44:10,895 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:44:10,896 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:44:10,898 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 21:44:10,898 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:44:10,898 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:44:10,899 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:44:10,900 INFO  [Thread-0] root: Connected to localhost on port 43238
2023-03-18 21:44:10,899 INFO  [Thread-2] root: Recieved message with raw bytes [B@7e7f24cd
2023-03-18 21:44:10,901 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:10,901 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:44:10,902 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:44:10,909 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:44:10,909 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:44:10,909 INFO  [main-EventThread] root: Recieved message with raw bytes [B@29552263
2023-03-18 21:44:10,909 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:10,909 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:44:10,909 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:44:10,910 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:44:10,910 INFO  [Thread-2] root: Recieved message with raw bytes [B@634efcb8
2023-03-18 21:44:10,911 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:10,911 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:44:10,912 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:44:10,913 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:44:10,913 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:44:10,914 INFO  [main-EventThread] root: Recieved message with raw bytes [B@8ac408
2023-03-18 21:44:10,914 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:10,914 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:44:10,914 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:44:10,914 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:44:10,914 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:44:10,915 INFO  [Thread-2] root: Closing connection
2023-03-18 21:44:10,916 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:44:12,508 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:44:12,508 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:44:12,509 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:44:12,509 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:44:12,510 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:44:12,511 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 21:44:12,511 INFO  [Thread-0] root: 0
2023-03-18 21:44:12,511 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:44:12,512 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:44:12,512 INFO  [Thread-11] root: Recieved message with raw bytes [B@687cdb72
2023-03-18 21:44:12,512 INFO  [Thread-11] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:12,512 INFO  [Thread-0] root: Connected to localhost on port 55932
2023-03-18 21:44:12,513 INFO  [Thread-11] root: Message: DATATRANSFERecethis

2023-03-18 21:44:12,514 INFO  [Thread-11] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:44:12,516 INFO  [Thread-11] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:44:12,516 INFO  [Thread-11] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:44:12,516 INFO  [Thread-1] root: Recieved message with raw bytes [B@4d8a5eec
2023-03-18 21:44:12,516 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:12,516 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:44:12,516 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:44:12,516 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:44:12,516 INFO  [Thread-11] root: Recieved message with raw bytes [B@66bb380d
2023-03-18 21:44:12,516 INFO  [Thread-11] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:12,517 INFO  [Thread-11] root: Message: DATATRANSFERfuckthis

2023-03-18 21:44:12,517 INFO  [Thread-11] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:44:12,519 INFO  [Thread-11] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:44:12,519 INFO  [Thread-11] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:44:12,519 INFO  [Thread-1] root: Recieved message with raw bytes [B@434db92d
2023-03-18 21:44:12,519 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:44:12,519 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:44:12,519 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:44:12,519 INFO  [Thread-1] root: Closing connection
2023-03-18 21:44:12,519 ERROR [Thread-11] root: Error! Connection lost!
2023-03-18 21:44:12,519 INFO  [Thread-11] root: Closing connection
2023-03-18 21:44:12,525 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:44:12,526 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:44:12,527 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:44:12,527 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:44:12,528 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:44:14,970 INFO  [Thread-7] root: Recieved message with raw bytes [B@17f58bb7
2023-03-18 21:44:14,971 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:44:14,971 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:44:14,971 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:44:14,971 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:44:23,841 INFO  [Thread-7] root: Recieved message with raw bytes [B@411ddb79
2023-03-18 21:44:23,841 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:44:23,841 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 21:44:23,841 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:44:23,841 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:57:46,647 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:57:46,648 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:57:46,648 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:57:46,649 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:57:46,649 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:57:46,650 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:57:46,651 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:57:46,662 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:57:46,667 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:57:46,671 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98008f, negotiated timeout = 40000
2023-03-18 21:57:46,672 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:57:46,673 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:57:46,673 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:57:46,675 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980090, negotiated timeout = 40000
2023-03-18 21:57:46,681 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:57:46,684 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:57:46,690 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:57:46,691 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:57:46,692 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 21:58:08,595 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:58:08,596 INFO  [Thread-0] root: Connected to localhost on port 36084
2023-03-18 21:58:11,417 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:58:11,417 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:58:11,417 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:58:11,418 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:58:11,418 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:58:11,419 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:58:11,419 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:58:11,420 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:58:11,420 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:58:11,421 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:58:11,421 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:58:11,422 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:58:11,422 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:58:11,423 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:58:11,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:58:11,425 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:58:11,437 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:58:11,444 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:58:11,450 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980091, negotiated timeout = 40000
2023-03-18 21:58:11,451 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:58:11,452 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:58:11,452 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:58:11,454 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980092, negotiated timeout = 40000
2023-03-18 21:58:11,462 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:58:11,465 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:58:11,469 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:11,471 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:58:11,472 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:58:11,472 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:58:11,472 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 21:58:11,473 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:58:11,474 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:58:11,474 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:58:11,475 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 21:58:11,475 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:58:11,476 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:58:11,476 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 21:58:11,478 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 21:58:11,478 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:58:11,478 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 21:58:11,478 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:58:11,479 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 21:58:11,479 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:58:11,480 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 21:58:11,480 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 21:58:11,479 INFO  [Thread-0] root: Connected to localhost on port 45968
2023-03-18 21:58:11,480 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 21:58:11,481 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 21:58:11,481 INFO  [Thread-3] root: Closing connection
2023-03-18 21:58:11,483 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 21:58:11,483 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:58:11,483 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 21:58:11,484 INFO  [Thread-2] root: Recieved message with raw bytes [B@68906335
2023-03-18 21:58:11,484 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:58:11,485 INFO  [Thread-0] root: Connected to localhost on port 46562
2023-03-18 21:58:11,485 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:11,486 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 21:58:11,486 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:11,487 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:58:11,493 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:58:11,493 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:58:11,493 INFO  [main-EventThread] root: Recieved message with raw bytes [B@29552263
2023-03-18 21:58:11,493 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:11,493 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 21:58:11,493 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:58:11,493 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:58:11,493 INFO  [Thread-2] root: Recieved message with raw bytes [B@1d6b2f75
2023-03-18 21:58:11,495 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:11,495 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 21:58:11,496 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:58:11,497 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:58:11,498 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:58:11,498 INFO  [main-EventThread] root: Recieved message with raw bytes [B@8ac408
2023-03-18 21:58:11,498 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:11,498 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:58:11,498 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:58:11,499 INFO  [main-EventThread] root: Closing connection
2023-03-18 21:58:11,500 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:58:11,500 INFO  [Thread-2] root: Closing connection
2023-03-18 21:58:11,501 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:58:12,146 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 21:58:12,146 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 21:58:12,147 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 21:58:12,147 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 21:58:12,148 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 21:58:12,149 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 21:58:12,149 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 21:58:12,149 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 21:58:12,150 INFO  [Thread-0] root: Connected to localhost on port 45974
2023-03-18 21:58:12,150 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:58:12,151 INFO  [Thread-4] root: Recieved message with raw bytes [B@75e88567
2023-03-18 21:58:12,152 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:12,152 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 21:58:12,153 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 21:58:12,154 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 21:58:12,154 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:58:12,154 INFO  [Thread-1] root: Recieved message with raw bytes [B@343a6e4e
2023-03-18 21:58:12,154 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:12,154 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 21:58:12,155 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 21:58:12,155 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:58:12,155 INFO  [Thread-4] root: Recieved message with raw bytes [B@51e685ce
2023-03-18 21:58:12,156 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:12,156 INFO  [Thread-4] root: Message: DATATRANSFERfuckthis

2023-03-18 21:58:12,157 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 21:58:12,158 INFO  [Thread-4] root: Added key 'fuck' and value 'this' to the database
2023-03-18 21:58:12,158 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:58:12,158 INFO  [Thread-1] root: Recieved message with raw bytes [B@3afd86b9
2023-03-18 21:58:12,159 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 21:58:12,159 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 21:58:12,159 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 21:58:12,159 INFO  [Thread-1] root: Closing connection
2023-03-18 21:58:12,160 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 21:58:12,160 INFO  [Thread-4] root: Closing connection
2023-03-18 21:58:12,166 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:12,167 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:58:12,168 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:58:12,168 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:58:12,169 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:14,698 INFO  [Thread-2] root: Recieved message with raw bytes [B@8ac91b0
2023-03-18 21:58:14,699 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 21:58:14,699 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 21:58:14,699 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 21:58:14,699 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 21:58:24,710 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 21:58:24,710 INFO  [Thread-2] root: Closing connection
2023-03-18 21:58:26,315 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 21:58:26,315 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 21:58:26,315 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 21:58:26,316 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 21:58:26,316 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 21:58:26,316 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 21:58:26,317 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 21:58:26,317 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 21:58:26,318 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 21:58:26,318 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 21:58:26,319 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 21:58:26,319 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 21:58:26,320 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 21:58:26,320 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 21:58:26,321 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 21:58:26,322 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 21:58:26,334 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:58:26,339 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:58:26,345 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980093, negotiated timeout = 40000
2023-03-18 21:58:26,346 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 21:58:26,347 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 21:58:26,347 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 21:58:26,349 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980094, negotiated timeout = 40000
2023-03-18 21:58:26,356 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:58:26,359 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 21:58:26,364 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:26,366 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:58:26,366 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 21:58:26,367 INFO  [Thread-0] root: Initialize server ...
2023-03-18 21:58:26,367 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 21:58:26,368 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:26,368 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 21:58:26,369 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 21:58:30,137 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 21:58:30,139 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 21:58:30,139 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 21:58:30,140 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 21:58:30,140 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:00:30,066 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:00:30,067 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:00:30,067 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:00:30,068 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:00:30,069 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:00:30,069 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:00:30,070 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:00:30,070 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:00:30,071 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:00:30,072 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:00:30,073 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:00:30,073 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:00:30,074 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:00:30,075 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:00:30,075 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:00:30,077 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:00:30,086 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:00:30,092 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:00:30,096 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980095, negotiated timeout = 40000
2023-03-18 22:00:30,098 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:00:30,099 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:00:30,099 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:00:30,101 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980096, negotiated timeout = 40000
2023-03-18 22:00:30,107 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:00:30,109 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:00:30,114 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:00:30,115 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:00:30,116 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 22:00:30,117 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:00:30,117 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 22:00:30,117 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 22:00:30,118 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:00:30,118 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 22:00:30,118 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 22:00:30,120 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 22:00:30,120 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 22:00:30,121 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 22:00:30,122 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:00:30,122 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:00:30,122 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:00:30,123 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 22:00:30,126 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:00:30,126 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:00:30,126 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 22:00:30,127 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:00:30,127 INFO  [Thread-2] root: Recieved message with raw bytes [B@4330076
2023-03-18 22:00:30,128 INFO  [Thread-0] root: Connected to localhost on port 48146
2023-03-18 22:00:30,128 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:30,129 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:00:30,130 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:00:30,136 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:00:30,136 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:00:30,136 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5a764c5f
2023-03-18 22:00:30,136 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:30,136 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:00:30,136 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:00:30,137 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:00:30,137 INFO  [Thread-2] root: Recieved message with raw bytes [B@1bb29d0d
2023-03-18 22:00:30,138 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:30,138 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 22:00:30,139 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:00:30,140 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 22:00:30,140 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:00:30,141 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c313ac6
2023-03-18 22:00:30,141 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:30,141 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 22:00:30,141 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:00:30,141 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:00:30,142 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:00:30,142 INFO  [Thread-2] root: Closing connection
2023-03-18 22:00:30,143 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 22:00:42,407 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:00:42,409 INFO  [Thread-0] root: Connected to localhost on port 33440
2023-03-18 22:00:46,318 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 22:00:46,319 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:00:46,319 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:00:46,319 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 22:00:46,320 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 22:00:46,321 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:00:46,321 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:00:46,321 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:00:46,322 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:00:46,322 INFO  [Thread-6] root: Recieved message with raw bytes [B@38229f0a
2023-03-18 22:00:46,322 INFO  [Thread-0] root: Connected to localhost on port 33454
2023-03-18 22:00:46,322 INFO  [Thread-6] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:46,324 INFO  [Thread-6] root: Message: DATATRANSFERecethis

2023-03-18 22:00:46,324 INFO  [Thread-6] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:00:46,326 INFO  [Thread-6] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:00:46,326 INFO  [Thread-6] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:00:46,326 INFO  [Thread-1] root: Recieved message with raw bytes [B@2921c155
2023-03-18 22:00:46,326 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:46,326 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:00:46,326 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:00:46,326 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:00:46,326 INFO  [Thread-6] root: Recieved message with raw bytes [B@36e5667e
2023-03-18 22:00:46,327 INFO  [Thread-6] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:46,328 INFO  [Thread-6] root: Message: DATATRANSFERfuckthis

2023-03-18 22:00:46,328 INFO  [Thread-6] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:00:46,330 INFO  [Thread-6] root: Added key 'fuck' and value 'this' to the database
2023-03-18 22:00:46,330 INFO  [Thread-6] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:00:46,330 INFO  [Thread-1] root: Recieved message with raw bytes [B@27e62a01
2023-03-18 22:00:46,330 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:00:46,330 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 22:00:46,331 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:00:46,331 INFO  [Thread-1] root: Closing connection
2023-03-18 22:00:46,331 ERROR [Thread-6] root: Error! Connection lost!
2023-03-18 22:00:46,331 INFO  [Thread-6] root: Closing connection
2023-03-18 22:00:46,337 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:00:46,338 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:00:46,339 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:00:46,339 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:00:46,339 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:00:49,778 ERROR [Thread-5] root: Error! Connection lost!
2023-03-18 22:00:49,778 INFO  [Thread-5] root: Closing connection
2023-03-18 22:00:55,769 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:00:55,770 INFO  [Thread-0] root: Connected to localhost on port 45556
2023-03-18 22:00:57,486 INFO  [Thread-7] root: Recieved message with raw bytes [B@25326e9d
2023-03-18 22:00:57,486 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:00:57,486 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-18 22:00:57,487 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:00:57,487 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:01:07,217 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:01:07,217 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:01:07,217 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:01:07,218 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:01:07,218 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:01:07,219 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:01:07,219 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:01:07,220 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:01:07,220 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:01:07,221 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:01:07,222 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:01:07,222 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:01:07,223 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:01:07,223 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:01:07,224 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:01:07,225 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:01:07,235 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:01:07,239 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:01:07,244 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980097, negotiated timeout = 40000
2023-03-18 22:01:07,246 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:01:07,247 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:01:07,247 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:01:07,249 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980098, negotiated timeout = 40000
2023-03-18 22:01:07,255 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:01:07,258 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:01:07,262 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:01:07,265 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:01:07,266 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:01:07,266 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 22:01:07,266 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8086
2023-03-18 22:01:07,267 INFO  [Thread-0] root: Server listening on port: 8086
2023-03-18 22:01:07,267 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,9dc87807300a5c64a1ec3d8a7e1438d2,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8086,127.0.0.1,8086,0725393394f806b42f6213da4dabc3db,9dc87807300a5c64a1ec3d8a7e1438d2,15;
2023-03-18 22:01:07,267 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 22:01:07,268 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:01:07,269 INFO  [main-EventThread] root: 9dc87807300a5c64a1ec3d8a7e1438d2:0725393394f806b42f6213da4dabc3db
2023-03-18 22:01:07,269 INFO  [main-EventThread] root: 127.0.0.1:8086 was added and is obtaining keys from successor
2023-03-18 22:01:07,270 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8086
2023-03-18 22:01:07,271 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:01:07,271 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:01:07,271 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:01:07,273 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-18 22:01:07,274 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:01:07,274 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:01:07,275 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8086
2023-03-18 22:01:07,276 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:01:07,276 INFO  [Thread-2] root: Recieved message with raw bytes [B@7e7f24cd
2023-03-18 22:01:07,276 INFO  [Thread-0] root: Connected to localhost on port 44158
2023-03-18 22:01:07,277 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:07,278 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:01:07,278 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:01:07,283 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:01:07,283 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:01:07,283 INFO  [main-EventThread] root: Recieved message with raw bytes [B@29552263
2023-03-18 22:01:07,283 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:07,283 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:01:07,284 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:01:07,284 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:01:07,284 INFO  [Thread-2] root: Recieved message with raw bytes [B@634efcb8
2023-03-18 22:01:07,285 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:07,285 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-18 22:01:07,286 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:01:07,287 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-18 22:01:07,288 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:01:07,288 INFO  [main-EventThread] root: Recieved message with raw bytes [B@8ac408
2023-03-18 22:01:07,288 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:07,288 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-18 22:01:07,288 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:01:07,288 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:01:07,289 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:01:07,290 INFO  [Thread-2] root: Closing connection
2023-03-18 22:01:07,290 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8086
2023-03-18 22:01:07,488 ERROR [Thread-7] root: Error! Connection lost!
2023-03-18 22:01:07,488 INFO  [Thread-7] root: Closing connection
2023-03-18 22:01:28,389 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8086to node 127.0.0.1:8085
2023-03-18 22:01:28,390 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:01:28,391 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:01:28,391 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 22:01:28,392 INFO  [Thread-1] root: Transferring key: fuck
2023-03-18 22:01:28,392 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:01:28,392 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:01:28,393 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:01:28,394 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:01:28,394 INFO  [Thread-8] root: Recieved message with raw bytes [B@5d4a6aec
2023-03-18 22:01:28,394 INFO  [Thread-8] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:28,394 INFO  [Thread-0] root: Connected to localhost on port 54894
2023-03-18 22:01:28,395 INFO  [Thread-8] root: Message: DATATRANSFERecethis

2023-03-18 22:01:28,396 INFO  [Thread-8] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:01:28,397 INFO  [Thread-8] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:01:28,397 INFO  [Thread-8] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:01:28,398 INFO  [Thread-1] root: Recieved message with raw bytes [B@73a78a18
2023-03-18 22:01:28,398 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:28,398 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:01:28,398 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:01:28,398 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:01:28,398 INFO  [Thread-8] root: Recieved message with raw bytes [B@538d9f35
2023-03-18 22:01:28,399 INFO  [Thread-8] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:28,399 INFO  [Thread-8] root: Message: DATATRANSFERfuckthis

2023-03-18 22:01:28,400 INFO  [Thread-8] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-18 22:01:28,401 INFO  [Thread-8] root: Added key 'fuck' and value 'this' to the database
2023-03-18 22:01:28,402 INFO  [Thread-8] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:01:28,402 INFO  [Thread-1] root: Recieved message with raw bytes [B@7d606a1c
2023-03-18 22:01:28,402 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:01:28,402 INFO  [Thread-1] root: Message: PUT_SUCCESSfuckthis

2023-03-18 22:01:28,402 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-18 22:01:28,402 INFO  [Thread-1] root: Closing connection
2023-03-18 22:01:28,402 ERROR [Thread-8] root: Error! Connection lost!
2023-03-18 22:01:28,403 INFO  [Thread-8] root: Closing connection
2023-03-18 22:01:28,408 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:01:28,409 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:01:28,410 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:01:28,410 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:01:28,411 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:01:29,865 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:01:29,866 INFO  [Thread-0] root: Connected to localhost on port 54908
2023-03-18 22:01:31,241 INFO  [Thread-9] root: Recieved message with raw bytes [B@54bee4cc
2023-03-18 22:01:31,241 INFO  [Thread-9] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:01:31,241 INFO  [Thread-9] root: Message: KEYRANGE

2023-03-18 22:01:31,241 INFO  [Thread-9] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:01:31,241 INFO  [Thread-9] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:01:41,247 ERROR [Thread-9] root: Error! Connection lost!
2023-03-18 22:01:41,247 INFO  [Thread-9] root: Closing connection
2023-03-18 22:04:59,913 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:04:59,913 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:04:59,914 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:04:59,914 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:04:59,915 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:04:59,915 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:04:59,916 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:04:59,916 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:04:59,916 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:04:59,917 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:04:59,917 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:04:59,918 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:04:59,918 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:04:59,919 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:04:59,919 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:04:59,920 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:04:59,930 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:04:59,935 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:04:59,940 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c980099, negotiated timeout = 40000
2023-03-18 22:04:59,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:04:59,943 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:04:59,943 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:04:59,945 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98009a, negotiated timeout = 40000
2023-03-18 22:04:59,951 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:04:59,953 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:04:59,961 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:04:59,961 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:04:59,962 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:05:24,854 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:05:24,855 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:05:24,855 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:05:24,856 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:05:24,856 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:05:24,857 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:05:24,857 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:05:24,858 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:05:24,859 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:05:24,859 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:05:24,860 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:05:24,860 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:05:24,861 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:05:24,861 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:05:24,862 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:05:24,863 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:05:24,873 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:24,878 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:24,883 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98009b, negotiated timeout = 40000
2023-03-18 22:05:24,885 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:05:24,886 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:24,886 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:24,888 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98009c, negotiated timeout = 40000
2023-03-18 22:05:24,895 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:24,897 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:24,902 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:24,903 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:24,904 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:05:24,904 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:05:24,905 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:24,905 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 22:05:24,906 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:05:24,906 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:05:24,906 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:05:24,907 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:05:24,909 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:05:24,909 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:05:24,910 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:05:24,910 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:05:24,911 INFO  [Thread-0] root: Connected to localhost on port 42890
2023-03-18 22:05:24,911 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:05:24,912 INFO  [Thread-2] root: Closing connection
2023-03-18 22:05:24,916 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:34,202 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:05:34,203 INFO  [Thread-0] root: Connected to localhost on port 42710
2023-03-18 22:05:36,029 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:36,030 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:36,031 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:05:36,032 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:36,032 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:39,090 INFO  [Thread-3] root: Recieved message with raw bytes [B@2b5320da
2023-03-18 22:05:39,091 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:05:39,091 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-18 22:05:39,091 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:05:39,092 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:05:42,121 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:05:42,122 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:05:42,122 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:05:42,123 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:05:42,123 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:05:42,124 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:05:42,125 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:05:42,125 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:05:42,126 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:05:42,127 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:05:42,128 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:05:42,128 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:05:42,129 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:05:42,129 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:05:42,130 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:05:42,131 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:05:42,141 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:42,146 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:42,151 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98009d, negotiated timeout = 40000
2023-03-18 22:05:42,153 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:05:42,154 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:42,154 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:42,156 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98009e, negotiated timeout = 40000
2023-03-18 22:05:42,164 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:42,167 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:42,172 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:42,173 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:42,174 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:05:42,174 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:05:42,174 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:05:42,175 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:42,176 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:05:42,176 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:05:42,176 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:42,178 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:42,178 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:05:42,179 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:05:42,180 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:05:42,181 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:05:42,181 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:05:42,184 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:05:42,184 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:05:42,185 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:05:42,186 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:42,186 INFO  [Thread-2] root: Recieved message with raw bytes [B@7e7f24cd
2023-03-18 22:05:42,186 INFO  [Thread-0] root: Connected to localhost on port 42224
2023-03-18 22:05:42,187 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:42,188 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:05:42,189 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:42,196 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:05:42,196 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:42,196 INFO  [main-EventThread] root: Recieved message with raw bytes [B@4705e2c6
2023-03-18 22:05:42,196 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:42,196 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:05:42,196 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:42,197 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:05:42,198 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:05:42,198 INFO  [Thread-2] root: Closing connection
2023-03-18 22:05:42,199 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:05:42,916 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:05:42,917 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:05:42,917 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:05:42,918 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:05:42,918 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:05:42,919 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:05:42,920 INFO  [Thread-0] root: Connected to localhost on port 38604
2023-03-18 22:05:42,920 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:42,920 INFO  [Thread-4] root: Recieved message with raw bytes [B@73a78a18
2023-03-18 22:05:42,921 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:42,921 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 22:05:42,922 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:42,924 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:05:42,924 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:42,924 INFO  [Thread-1] root: Recieved message with raw bytes [B@343a6e4e
2023-03-18 22:05:42,925 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:42,925 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:05:42,925 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:42,925 INFO  [Thread-1] root: Closing connection
2023-03-18 22:05:42,926 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 22:05:42,927 INFO  [Thread-4] root: Closing connection
2023-03-18 22:05:42,933 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:42,934 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:42,935 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:05:42,936 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:42,936 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:45,416 INFO  [Thread-3] root: Recieved message with raw bytes [B@350e3d08
2023-03-18 22:05:45,416 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:05:45,416 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-18 22:05:45,416 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:05:45,416 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:05:50,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:05:50,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:05:50,439 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:05:50,440 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:05:50,440 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:05:50,441 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:05:50,442 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:05:50,442 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:05:50,443 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:05:50,443 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:05:50,444 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:05:50,445 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:05:50,445 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:05:50,446 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:05:50,447 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:05:50,448 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:05:50,458 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:50,464 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:50,469 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c98009f, negotiated timeout = 40000
2023-03-18 22:05:50,471 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:05:50,471 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:50,472 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:50,474 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a0, negotiated timeout = 40000
2023-03-18 22:05:50,480 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:50,482 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:50,486 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:50,488 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:50,488 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:05:50,489 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:05:50,489 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:50,489 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:50,490 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:05:50,491 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:05:52,877 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:52,878 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:52,879 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:05:52,879 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:52,879 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:55,193 INFO  [Thread-3] root: Recieved message with raw bytes [B@c85693
2023-03-18 22:05:55,193 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:05:55,193 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-18 22:05:55,193 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:05:55,194 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:05:59,011 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:05:59,012 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:05:59,012 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:05:59,014 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:05:59,015 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:05:59,015 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:05:59,016 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:05:59,017 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:05:59,017 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:05:59,018 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:05:59,018 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:05:59,019 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:05:59,019 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:05:59,020 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:05:59,020 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:05:59,022 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:05:59,034 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:59,039 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:59,043 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a1, negotiated timeout = 40000
2023-03-18 22:05:59,045 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:05:59,046 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:05:59,046 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:05:59,048 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a2, negotiated timeout = 40000
2023-03-18 22:05:59,054 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:59,056 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:05:59,060 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:59,063 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:05:59,064 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:05:59,069 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:59,070 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:05:59,071 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:05:59,071 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:59,072 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:59,072 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:05:59,074 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:59,074 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:05:59,075 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:05:59,076 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:05:59,077 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:05:59,077 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:05:59,080 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:05:59,080 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:05:59,080 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:05:59,082 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:59,082 INFO  [Thread-0] root: Connected to localhost on port 56692
2023-03-18 22:05:59,082 INFO  [Thread-2] root: Recieved message with raw bytes [B@10f40c3b
2023-03-18 22:05:59,084 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:59,084 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:05:59,085 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:59,091 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:05:59,091 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:59,091 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2a2d343a
2023-03-18 22:05:59,091 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:59,091 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:05:59,091 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:59,091 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:05:59,092 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:05:59,093 INFO  [Thread-2] root: Closing connection
2023-03-18 22:05:59,094 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:05:59,822 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:05:59,823 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:05:59,823 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:05:59,823 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:05:59,823 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:05:59,824 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:05:59,825 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:59,825 INFO  [Thread-5] root: Recieved message with raw bytes [B@1ab2b767
2023-03-18 22:05:59,825 INFO  [Thread-5] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:59,825 INFO  [Thread-0] root: Connected to localhost on port 37298
2023-03-18 22:05:59,826 INFO  [Thread-5] root: Message: DATATRANSFERecethis

2023-03-18 22:05:59,828 INFO  [Thread-5] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:05:59,830 INFO  [Thread-5] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:05:59,830 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:59,830 INFO  [Thread-1] root: Recieved message with raw bytes [B@343a6e4e
2023-03-18 22:05:59,830 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:05:59,830 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:05:59,830 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:05:59,830 INFO  [Thread-1] root: Closing connection
2023-03-18 22:05:59,830 ERROR [Thread-5] root: Error! Connection lost!
2023-03-18 22:05:59,830 INFO  [Thread-5] root: Closing connection
2023-03-18 22:05:59,837 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:05:59,838 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:05:59,839 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:05:59,840 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:05:59,841 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:02,085 INFO  [Thread-3] root: Recieved message with raw bytes [B@5a6c9288
2023-03-18 22:06:02,085 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:06:02,085 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-18 22:06:02,085 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:06:02,085 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:06:05,497 INFO  [Thread-3] root: Recieved message with raw bytes [B@643a97fb
2023-03-18 22:06:05,497 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 22:06:05,497 INFO  [Thread-3] root: Message: GETthis

2023-03-18 22:06:05,498 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 22:06:05,499 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:06:05,499 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:06:05,499 INFO  [Thread-3] root: false
2023-03-18 22:06:05,499 INFO  [Thread-3] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:05,499 INFO  [Thread-3] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:06:05,500 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 22:06:05,500 INFO  [Thread-3] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:06:05,501 INFO  [Thread-3] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:05,502 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:06:05,502 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:06:05,503 ERROR [Thread-3] root: Key 'this' is not in the database
2023-03-18 22:06:05,504 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 22:06:08,987 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:06:08,987 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:06:08,988 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:06:08,988 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:06:08,989 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:06:08,990 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:06:08,990 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:06:08,991 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:06:08,992 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:06:08,992 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:06:08,993 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:06:08,993 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:06:08,994 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:06:08,995 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:06:08,995 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:06:08,996 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:06:09,006 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:06:09,010 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:06:09,016 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a3, negotiated timeout = 40000
2023-03-18 22:06:09,017 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:06:09,018 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:06:09,018 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:06:09,020 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a4, negotiated timeout = 40000
2023-03-18 22:06:09,026 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:06:09,028 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:06:09,033 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:09,035 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:06:09,035 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:06:09,036 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:06:09,036 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:06:09,036 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:09,037 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:09,037 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:06:09,038 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:06:09,040 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:09,040 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:06:09,040 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:06:09,042 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:06:09,042 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:06:09,042 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:06:09,045 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:06:09,045 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:06:09,045 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:06:09,047 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:06:09,047 INFO  [Thread-2] root: Recieved message with raw bytes [B@4368aaf1
2023-03-18 22:06:09,047 INFO  [Thread-0] root: Connected to localhost on port 42462
2023-03-18 22:06:09,048 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:06:09,049 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:06:09,050 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:06:09,055 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:06:09,055 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:06:09,055 INFO  [main-EventThread] root: Recieved message with raw bytes [B@77f38be7
2023-03-18 22:06:09,055 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:06:09,055 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:06:09,055 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:06:09,056 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:06:09,056 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:06:09,057 INFO  [Thread-2] root: Closing connection
2023-03-18 22:06:09,058 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:06:09,582 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:06:09,583 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:06:09,583 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:06:09,584 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:06:09,584 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:06:09,584 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:06:09,585 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:06:09,585 INFO  [Thread-0] root: Connected to localhost on port 51808
2023-03-18 22:06:09,585 INFO  [Thread-6] root: Recieved message with raw bytes [B@2f89d9d9
2023-03-18 22:06:09,587 INFO  [Thread-6] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:06:09,587 INFO  [Thread-6] root: Message: DATATRANSFERecethis

2023-03-18 22:06:09,588 INFO  [Thread-6] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:06:09,590 INFO  [Thread-6] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:06:09,590 INFO  [Thread-6] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:06:09,590 INFO  [Thread-1] root: Recieved message with raw bytes [B@6588180
2023-03-18 22:06:09,590 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:06:09,590 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:06:09,590 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:06:09,591 INFO  [Thread-1] root: Closing connection
2023-03-18 22:06:09,592 ERROR [Thread-6] root: Error! Connection lost!
2023-03-18 22:06:09,593 INFO  [Thread-6] root: Closing connection
2023-03-18 22:06:09,599 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:09,600 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:06:09,601 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:06:09,601 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:09,602 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:11,797 INFO  [Thread-3] root: Recieved message with raw bytes [B@7e779ee6
2023-03-18 22:06:11,797 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:06:11,797 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-18 22:06:11,797 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:06:11,797 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:06:21,808 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 22:06:21,808 INFO  [Thread-3] root: Closing connection
2023-03-18 22:06:30,303 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:06:30,304 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:06:30,304 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:06:30,305 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:06:30,305 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:06:30,306 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:06:30,306 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:06:30,307 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:06:30,308 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:06:30,308 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:06:30,309 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:06:30,310 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:06:30,311 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:06:30,312 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:06:30,312 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:06:30,313 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:06:30,324 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:06:30,329 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:06:30,334 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a5, negotiated timeout = 40000
2023-03-18 22:06:30,336 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:06:30,337 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:06:30,337 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:06:30,339 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a6, negotiated timeout = 40000
2023-03-18 22:06:30,346 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:06:30,348 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:06:30,353 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:30,354 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:06:30,354 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:06:30,355 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:06:30,355 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:06:30,356 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:30,356 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:06:30,356 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:06:30,356 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:06:30,359 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:06:30,359 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:06:30,360 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:06:30,361 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:06:30,361 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:06:30,361 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:06:30,365 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:06:30,365 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:06:30,365 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:06:30,366 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:06:30,366 INFO  [Thread-2] root: Recieved message with raw bytes [B@68906335
2023-03-18 22:06:30,367 INFO  [Thread-0] root: Connected to localhost on port 60070
2023-03-18 22:06:30,368 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:06:30,369 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:06:30,370 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:06:30,375 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:06:30,375 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:06:30,375 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2a2d343a
2023-03-18 22:06:30,375 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:06:30,375 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:06:30,376 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:06:30,376 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:06:30,376 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:06:30,376 INFO  [Thread-2] root: Closing connection
2023-03-18 22:06:30,377 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:18:01,560 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:18:01,561 INFO  [Thread-1] root: Checking key key: fuck
2023-03-18 22:18:01,561 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:18:01,561 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:18:01,562 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:18:01,563 INFO  [Thread-1] root: Closing connection
2023-03-18 22:18:01,563 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 22:18:01,564 INFO  [Thread-0] root: Connected to localhost on port 37774
2023-03-18 22:18:01,564 INFO  [Thread-3] root: Closing connection
2023-03-18 22:18:01,570 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:18:01,572 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:18:01,573 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,85d27949e81cbe4c3d605c59cd7d7dc4,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:18:01,573 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc4:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:18:01,573 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:18:04,382 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:18:04,382 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:18:04,383 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:18:04,384 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:18:04,384 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:18:04,385 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:18:04,386 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:18:04,386 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:18:04,387 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:18:04,387 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:18:04,388 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:18:04,389 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:18:04,389 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:18:04,390 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:18:04,390 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:18:04,391 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:18:04,404 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:18:04,409 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:18:04,414 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a7, negotiated timeout = 40000
2023-03-18 22:18:04,416 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:18:04,416 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:18:04,417 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:18:04,419 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a8, negotiated timeout = 40000
2023-03-18 22:18:04,426 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:18:04,428 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:18:04,434 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:18:04,435 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:18:04,436 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:18:34,795 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:18:34,795 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:18:34,795 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:18:34,796 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:18:34,797 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:18:34,797 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:18:34,798 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:18:34,798 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:18:34,799 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:18:34,799 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:18:34,800 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:18:34,800 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:18:34,801 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:18:34,801 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:18:34,802 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:18:34,803 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:18:34,813 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:18:34,820 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:18:34,825 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800a9, negotiated timeout = 40000
2023-03-18 22:18:34,827 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:18:34,828 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:18:34,828 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:18:34,830 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800aa, negotiated timeout = 40000
2023-03-18 22:18:34,836 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:18:34,838 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:18:34,844 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:18:34,845 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:18:34,846 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:18:48,661 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:18:48,662 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:18:48,662 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:18:48,663 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:18:48,663 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:18:48,664 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:18:48,664 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:18:48,665 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:18:48,665 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:18:48,666 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:18:48,667 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:18:48,667 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:18:48,668 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:18:48,668 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:18:48,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:18:48,670 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:18:48,680 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:18:48,685 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:18:48,690 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800ab, negotiated timeout = 40000
2023-03-18 22:18:48,691 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:18:48,692 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:18:48,692 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:18:48,694 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800ac, negotiated timeout = 40000
2023-03-18 22:18:48,701 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:18:48,703 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:18:48,707 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:18:48,709 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:18:48,710 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:18:48,710 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:18:48,710 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:18:48,711 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:18:48,711 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:18:48,712 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:18:48,712 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:18:48,713 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:18:48,716 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:18:48,716 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:18:48,716 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:18:48,717 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:18:48,717 INFO  [Thread-0] root: Connected to localhost on port 57850
2023-03-18 22:18:48,718 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:18:48,719 INFO  [Thread-2] root: Closing connection
2023-03-18 22:18:48,722 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:18:54,656 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:18:54,657 INFO  [Thread-0] root: Connected to localhost on port 52184
2023-03-18 22:18:57,305 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:18:57,306 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:18:57,307 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:18:57,307 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:18:57,307 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:18:57,308 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:18:57,308 INFO  [Thread-0] root: Connected to localhost on port 52188
2023-03-18 22:18:57,309 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:18:57,309 INFO  [Thread-3] root: Recieved message with raw bytes [B@8ac91b0
2023-03-18 22:18:57,310 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:18:57,310 INFO  [Thread-3] root: Message: DATATRANSFERecethis

2023-03-18 22:18:57,311 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:18:57,316 INFO  [Thread-3] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:18:57,316 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:18:57,316 INFO  [Thread-1] root: Recieved message with raw bytes [B@13e72d03
2023-03-18 22:18:57,317 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:18:57,317 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:18:57,318 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:18:57,318 INFO  [Thread-1] root: Closing connection
2023-03-18 22:18:57,319 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 22:18:57,319 INFO  [Thread-3] root: Closing connection
2023-03-18 22:18:57,327 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:18:57,328 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:18:57,329 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:18:57,330 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:18:57,330 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 22:18:57,330 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:18:59,188 INFO  [Thread-2] root: Recieved message with raw bytes [B@29559d78
2023-03-18 22:18:59,188 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:18:59,188 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 22:18:59,188 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:18:59,189 INFO  [Thread-2] root: Sending keyrange according to metadata
2023-03-18 22:18:59,189 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:19:06,710 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:19:06,710 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:19:06,711 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:19:06,712 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:19:06,712 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:19:06,713 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:19:06,714 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:19:06,714 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:19:06,715 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:19:06,715 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:19:06,716 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:19:06,716 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:19:06,717 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:19:06,717 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:19:06,718 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:19:06,719 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:19:06,730 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:19:06,734 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:19:06,740 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800ad, negotiated timeout = 40000
2023-03-18 22:19:06,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:19:06,742 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:19:06,742 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:19:06,744 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800ae, negotiated timeout = 40000
2023-03-18 22:19:06,750 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:19:06,752 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:19:06,757 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:19:06,759 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:19:06,759 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:19:06,759 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:19:06,760 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:19:06,760 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:19:06,761 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:19:06,761 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:19:06,762 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:19:06,762 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:19:06,763 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:19:06,763 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:19:06,764 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:19:06,765 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:19:06,765 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:19:06,768 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:19:06,768 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:19:06,768 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:19:06,770 INFO  [Thread-2] root: Recieved message with raw bytes [B@10f40c3b
2023-03-18 22:19:06,770 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:19:06,770 INFO  [Thread-0] root: Connected to localhost on port 47178
2023-03-18 22:19:06,770 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:19:06,771 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:19:06,772 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:19:06,777 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:19:06,777 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:19:06,777 INFO  [main-EventThread] root: Recieved message with raw bytes [B@29552263
2023-03-18 22:19:06,777 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:19:06,777 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:19:06,778 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:19:06,778 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:19:06,778 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:19:06,778 INFO  [Thread-2] root: Closing connection
2023-03-18 22:19:06,779 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:19:08,636 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:19:08,637 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:19:08,638 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:19:08,638 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:19:08,638 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:19:08,638 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:19:08,639 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:19:08,639 INFO  [Thread-0] root: Connected to localhost on port 52690
2023-03-18 22:19:08,639 INFO  [Thread-4] root: Recieved message with raw bytes [B@37ebc37a
2023-03-18 22:19:08,640 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:19:08,641 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 22:19:08,641 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:19:08,643 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:19:08,643 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:19:08,643 INFO  [Thread-1] root: Recieved message with raw bytes [B@343a6e4e
2023-03-18 22:19:08,643 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:19:08,643 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:19:08,643 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:19:08,643 INFO  [Thread-1] root: Closing connection
2023-03-18 22:19:08,643 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 22:19:08,644 INFO  [Thread-4] root: Closing connection
2023-03-18 22:19:08,650 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:19:08,651 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:19:08,652 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:19:08,652 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:19:08,653 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:19:09,198 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:19:09,198 INFO  [Thread-2] root: Closing connection
2023-03-18 22:23:30,377 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:23:30,377 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:23:30,378 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:23:30,378 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:23:30,379 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:23:30,380 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:23:30,380 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:23:30,381 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:23:30,381 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:23:30,382 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:23:30,383 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:23:30,383 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:23:30,384 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:23:30,384 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:23:30,385 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:23:30,386 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:23:30,396 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:30,401 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:30,406 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800af, negotiated timeout = 40000
2023-03-18 22:23:30,408 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:23:30,409 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:30,409 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:30,411 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b0, negotiated timeout = 40000
2023-03-18 22:23:30,417 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:23:30,420 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:23:30,426 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:23:30,427 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:30,427 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:23:36,986 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:23:36,988 INFO  [Thread-0] root: Connected to localhost on port 35796
2023-03-18 22:23:39,944 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:23:39,944 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:23:39,945 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:23:39,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:23:39,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:23:39,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:23:39,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:23:39,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:23:39,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:23:39,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:23:39,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:23:39,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:23:39,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:23:39,951 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:23:39,951 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:23:39,952 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:23:39,963 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:39,968 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:39,973 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b1, negotiated timeout = 40000
2023-03-18 22:23:39,975 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:23:39,976 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:39,976 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:39,978 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b2, negotiated timeout = 40000
2023-03-18 22:23:39,986 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:23:39,988 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:23:39,992 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:39,994 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:23:39,996 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:23:39,997 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:23:39,998 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:23:39,998 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:23:39,999 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 22:23:39,999 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:23:39,999 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:23:40,002 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:23:40,002 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:23:40,002 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:23:40,003 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:23:40,003 INFO  [Thread-0] root: Connected to localhost on port 35798
2023-03-18 22:23:40,004 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 22:23:40,005 INFO  [Thread-3] root: Closing connection
2023-03-18 22:23:40,010 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:40,569 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:40,571 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:23:40,571 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:23:40,572 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:23:40,572 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:43,661 INFO  [Thread-2] root: Recieved message with raw bytes [B@29559d78
2023-03-18 22:23:43,662 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:23:43,662 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 22:23:43,662 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:23:43,663 INFO  [Thread-2] root: Sending keyrange according to metadata
2023-03-18 22:23:43,663 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:23:47,260 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:23:47,260 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:23:47,260 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:23:47,261 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:23:47,262 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:23:47,262 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:23:47,263 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:23:47,264 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:23:47,264 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:23:47,265 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:23:47,266 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:23:47,266 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:23:47,267 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:23:47,267 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:23:47,268 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:23:47,269 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:23:47,279 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:47,284 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:47,289 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b3, negotiated timeout = 40000
2023-03-18 22:23:47,290 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:23:47,291 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:47,291 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:47,293 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b4, negotiated timeout = 40000
2023-03-18 22:23:47,300 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:23:47,302 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:23:47,309 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:47,310 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:23:47,311 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:23:47,312 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:23:47,312 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:23:47,312 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:47,313 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:23:47,313 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:23:49,038 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:49,039 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:23:49,040 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:23:49,041 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:23:49,041 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:23:53,259 INFO  [Thread-2] root: Recieved message with raw bytes [B@d6c018
2023-03-18 22:23:53,259 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:23:53,260 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-18 22:23:53,260 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:23:53,260 INFO  [Thread-2] root: Sending keyrange according to metadata
2023-03-18 22:23:53,260 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:23:56,032 INFO  [Thread-2] root: Recieved message with raw bytes [B@2cee977
2023-03-18 22:23:56,032 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 22:23:56,032 INFO  [Thread-2] root: Message: GETthis

2023-03-18 22:23:56,032 INFO  [Thread-2] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 22:23:56,032 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:23:56,032 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:23:56,032 INFO  [Thread-2] root: false
2023-03-18 22:23:56,032 INFO  [Thread-2] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:23:56,032 INFO  [Thread-2] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:23:56,033 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 22:23:56,033 INFO  [Thread-2] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:23:56,033 INFO  [Thread-2] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:23:56,033 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:23:56,033 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:23:56,033 ERROR [Thread-2] root: Key 'this' is not in the database
2023-03-18 22:23:56,034 INFO  [Thread-2] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 22:23:59,971 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:23:59,971 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:23:59,972 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:23:59,972 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:23:59,973 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:23:59,983 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:59,988 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:59,993 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b5, negotiated timeout = 40000
2023-03-18 22:23:59,995 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:23:59,995 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:23:59,996 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:23:59,997 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b6, negotiated timeout = 40000
2023-03-18 22:24:00,004 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:24:00,006 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:24:00,011 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:00,012 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:24:00,013 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:24:00,013 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:24:00,014 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:24:00,014 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:24:00,015 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:00,015 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:24:00,015 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:00,017 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:00,017 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:24:00,017 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:24:00,019 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:24:00,020 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:24:00,020 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:24:00,023 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:24:00,023 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:24:00,024 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:24:00,025 INFO  [Thread-2] root: Recieved message with raw bytes [B@461ef9e3
2023-03-18 22:24:00,025 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:24:00,025 INFO  [Thread-0] root: Connected to localhost on port 33822
2023-03-18 22:24:00,025 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:24:00,027 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:24:00,028 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:24:00,034 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:24:00,034 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:24:00,034 INFO  [main-EventThread] root: Recieved message with raw bytes [B@354888b5
2023-03-18 22:24:00,034 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:24:00,034 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:24:00,034 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:24:00,034 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:24:00,034 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:24:00,035 INFO  [Thread-2] root: Closing connection
2023-03-18 22:24:00,036 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:24:04,648 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:24:04,649 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:24:04,650 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:24:04,650 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:24:04,650 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:24:04,650 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:24:04,651 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:24:04,651 INFO  [Thread-4] root: Recieved message with raw bytes [B@5e9b15a5
2023-03-18 22:24:04,651 INFO  [Thread-0] root: Connected to localhost on port 49652
2023-03-18 22:24:04,652 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:24:04,653 INFO  [Thread-4] root: Message: DATATRANSFERecethis

2023-03-18 22:24:04,654 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:24:04,656 INFO  [Thread-4] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:24:04,656 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:24:04,656 INFO  [Thread-1] root: Recieved message with raw bytes [B@75e88567
2023-03-18 22:24:04,656 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:24:04,656 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:24:04,656 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:24:04,656 INFO  [Thread-1] root: Closing connection
2023-03-18 22:24:04,656 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 22:24:04,657 INFO  [Thread-4] root: Closing connection
2023-03-18 22:24:04,662 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:04,665 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:24:04,665 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:24:04,666 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:04,666 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:05,834 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:24:05,834 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:24:05,835 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:24:05,836 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:24:05,836 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:24:05,837 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:24:05,838 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:24:05,838 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:24:05,839 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:24:05,839 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:24:05,840 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:24:05,840 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:24:05,841 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:24:05,841 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:24:05,842 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:24:05,843 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:24:05,853 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:24:05,858 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:24:05,864 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b7, negotiated timeout = 40000
2023-03-18 22:24:05,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:24:05,866 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:24:05,866 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:24:05,868 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b8, negotiated timeout = 40000
2023-03-18 22:24:05,875 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:24:05,878 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:24:05,883 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:05,884 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:24:05,884 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:24:05,885 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:24:05,885 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:05,886 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:05,887 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:24:05,888 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:24:06,042 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:24:06,042 INFO  [Thread-2] root: Closing connection
2023-03-18 22:24:12,288 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:12,289 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:24:12,290 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:24:12,290 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:12,291 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:53,961 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:24:53,963 INFO  [Thread-0] root: Connected to localhost on port 52380
2023-03-18 22:24:57,115 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:24:57,115 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:24:57,116 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:24:57,116 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:24:57,117 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:24:57,117 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:24:57,118 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:24:57,119 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:24:57,119 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:24:57,120 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:24:57,120 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:24:57,121 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:24:57,121 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:24:57,122 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:24:57,123 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:24:57,124 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:24:57,134 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:24:57,139 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:24:57,143 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800b9, negotiated timeout = 40000
2023-03-18 22:24:57,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:24:57,145 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:24:57,146 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:24:57,148 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800ba, negotiated timeout = 40000
2023-03-18 22:24:57,154 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:24:57,156 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:24:57,160 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:57,161 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:24:57,162 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:24:57,163 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:24:57,164 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:24:57,164 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:24:57,165 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:57,165 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:59,571 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:24:59,572 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:24:59,574 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:24:59,574 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:24:59,575 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:03,971 ERROR [Thread-5] root: Error! Connection lost!
2023-03-18 22:25:03,971 INFO  [Thread-5] root: Closing connection
2023-03-18 22:25:20,793 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:25:20,794 INFO  [Thread-0] root: Connected to localhost on port 52144
2023-03-18 22:25:22,187 INFO  [Thread-6] root: Recieved message with raw bytes [B@3675d787
2023-03-18 22:25:22,187 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 22:25:22,187 INFO  [Thread-6] root: Message: GETthis

2023-03-18 22:25:22,187 INFO  [Thread-6] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 22:25:22,187 INFO  [Thread-6] root: SERVER_IDLE
2023-03-18 22:25:22,188 INFO  [Thread-6] root: SERVER_IDLE
2023-03-18 22:25:22,188 INFO  [Thread-6] root: false
2023-03-18 22:25:22,188 INFO  [Thread-6] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:22,189 INFO  [Thread-6] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:25:22,190 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 22:25:22,190 INFO  [Thread-6] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:25:22,190 INFO  [Thread-6] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:22,191 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:25:22,192 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:25:22,192 ERROR [Thread-6] root: Key 'this' is not in the database
2023-03-18 22:25:22,193 INFO  [Thread-6] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 22:25:25,272 INFO  [Thread-6] root: Recieved message with raw bytes [B@38b23f39
2023-03-18 22:25:25,272 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:25:25,272 INFO  [Thread-6] root: Message: GETece

2023-03-18 22:25:25,272 INFO  [Thread-6] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:25:25,272 INFO  [Thread-6] root: SERVER_IDLE
2023-03-18 22:25:25,272 INFO  [Thread-6] root: SERVER_IDLE
2023-03-18 22:25:25,272 INFO  [Thread-6] root: false
2023-03-18 22:25:25,272 INFO  [Thread-6] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:25,272 INFO  [Thread-6] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:25:25,273 INFO  [Thread-6] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:25:25,273 INFO  [Thread-6] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:25:25,273 INFO  [Thread-6] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:25,273 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:25:25,273 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:25:25,273 INFO  [Thread-6] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:29,604 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:25:29,605 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:25:29,605 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:25:29,606 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:25:29,607 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:25:29,607 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:25:29,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:25:29,609 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:25:29,609 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:25:29,610 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:25:29,610 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:25:29,611 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:25:29,612 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:25:29,612 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:25:29,613 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:25:29,614 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:25:29,624 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:25:29,629 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:25:29,635 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800bb, negotiated timeout = 40000
2023-03-18 22:25:29,637 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:25:29,637 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:25:29,638 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:25:29,640 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800bc, negotiated timeout = 40000
2023-03-18 22:25:29,646 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:25:29,649 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:25:29,653 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:29,654 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:25:29,655 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:25:29,655 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:25:29,656 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:25:29,656 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:29,656 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:29,656 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:25:29,657 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:25:29,659 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:29,659 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:25:29,660 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:25:29,661 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:25:29,662 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:25:29,662 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:25:29,665 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:25:29,665 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:25:29,666 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:25:29,667 INFO  [Thread-2] root: Recieved message with raw bytes [B@41128478
2023-03-18 22:25:29,667 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:29,667 INFO  [Thread-0] root: Connected to localhost on port 49956
2023-03-18 22:25:29,667 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:29,669 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:25:29,670 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:29,675 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:25:29,675 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:29,675 INFO  [main-EventThread] root: Recieved message with raw bytes [B@156f4681
2023-03-18 22:25:29,675 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:29,675 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:25:29,676 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:29,676 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:25:29,676 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:25:29,676 INFO  [Thread-2] root: Closing connection
2023-03-18 22:25:29,677 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:25:30,782 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:25:30,782 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:25:30,783 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:25:30,783 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:25:30,784 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:25:30,784 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:25:30,785 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:30,785 INFO  [Thread-7] root: Recieved message with raw bytes [B@300dfa0f
2023-03-18 22:25:30,786 INFO  [Thread-7] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:30,785 INFO  [Thread-0] root: Connected to localhost on port 33646
2023-03-18 22:25:30,787 INFO  [Thread-7] root: Message: DATATRANSFERecethis

2023-03-18 22:25:30,788 INFO  [Thread-7] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:30,790 INFO  [Thread-7] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:25:30,790 INFO  [Thread-7] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:30,790 INFO  [Thread-1] root: Recieved message with raw bytes [B@2921c155
2023-03-18 22:25:30,790 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:30,790 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:25:30,790 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:30,790 INFO  [Thread-1] root: Closing connection
2023-03-18 22:25:30,790 ERROR [Thread-7] root: Error! Connection lost!
2023-03-18 22:25:30,791 INFO  [Thread-7] root: Closing connection
2023-03-18 22:25:30,797 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:30,798 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:25:30,799 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:25:30,800 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:30,800 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:33,972 INFO  [Thread-6] root: Recieved message with raw bytes [B@3c8dbcf7
2023-03-18 22:25:33,972 INFO  [Thread-6] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:25:33,972 INFO  [Thread-6] root: Message: KEYRANGE

2023-03-18 22:25:33,972 INFO  [Thread-6] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:25:33,972 INFO  [Thread-6] root: Sending keyrange according to metadata
2023-03-18 22:25:33,972 INFO  [Thread-6] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:25:37,656 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:25:37,656 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:25:37,656 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:25:37,657 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:25:37,657 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:25:37,658 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:25:37,658 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:25:37,659 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:25:37,659 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:25:37,660 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:25:37,660 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:25:37,661 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:25:37,662 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:25:37,663 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:25:37,663 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:25:37,663 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:25:37,673 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:25:37,680 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:25:37,685 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800bd, negotiated timeout = 40000
2023-03-18 22:25:37,687 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:25:37,687 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:25:37,688 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:25:37,690 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800be, negotiated timeout = 40000
2023-03-18 22:25:37,697 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:25:37,700 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:25:37,705 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:37,707 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:25:37,707 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:25:37,707 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:25:37,708 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:25:37,708 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:25:37,709 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:37,709 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:37,708 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:25:37,711 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:37,711 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:25:37,712 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:25:37,713 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:25:37,714 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:25:37,714 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:25:37,718 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:25:37,718 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:25:37,718 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:25:37,719 INFO  [Thread-2] root: Recieved message with raw bytes [B@461ef9e3
2023-03-18 22:25:37,719 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:37,720 INFO  [Thread-0] root: Connected to localhost on port 32860
2023-03-18 22:25:37,720 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:37,721 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:25:37,722 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:37,728 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:25:37,728 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:37,728 INFO  [main-EventThread] root: Recieved message with raw bytes [B@237ce5e8
2023-03-18 22:25:37,728 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:37,728 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:25:37,728 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:37,728 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:25:37,728 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:25:37,728 INFO  [Thread-2] root: Closing connection
2023-03-18 22:25:37,729 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:25:39,760 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:25:39,761 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:25:39,761 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:25:39,762 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:25:39,762 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:25:39,762 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:25:39,763 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:39,763 INFO  [Thread-8] root: Recieved message with raw bytes [B@6d9e2c42
2023-03-18 22:25:39,763 INFO  [Thread-8] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:39,764 INFO  [Thread-8] root: Message: DATATRANSFERecethis

2023-03-18 22:25:39,765 INFO  [Thread-8] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:25:39,766 INFO  [Thread-8] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:25:39,766 INFO  [Thread-0] root: Connected to localhost on port 39634
2023-03-18 22:25:39,767 INFO  [Thread-1] root: Recieved message with raw bytes [B@2921c155
2023-03-18 22:25:39,766 INFO  [Thread-8] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:39,767 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:25:39,767 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:25:39,767 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:25:39,767 INFO  [Thread-1] root: Closing connection
2023-03-18 22:25:39,767 ERROR [Thread-8] root: Error! Connection lost!
2023-03-18 22:25:39,767 INFO  [Thread-8] root: Closing connection
2023-03-18 22:25:39,773 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:39,774 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:25:39,775 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:25:39,775 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:25:39,776 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:25:43,981 ERROR [Thread-6] root: Error! Connection lost!
2023-03-18 22:25:43,982 INFO  [Thread-6] root: Closing connection
2023-03-18 22:27:32,461 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:27:32,463 INFO  [Thread-0] root: Connected to localhost on port 33010
2023-03-18 22:27:33,836 INFO  [Thread-9] root: Recieved message with raw bytes [B@7d51a43e
2023-03-18 22:27:33,836 INFO  [Thread-9] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:27:33,836 INFO  [Thread-9] root: Message: KEYRANGE

2023-03-18 22:27:33,837 INFO  [Thread-9] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:27:33,837 INFO  [Thread-9] root: Sending keyrange according to metadata
2023-03-18 22:27:33,837 INFO  [Thread-9] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:27:43,842 ERROR [Thread-9] root: Error! Connection lost!
2023-03-18 22:27:43,842 INFO  [Thread-9] root: Closing connection
2023-03-18 22:28:25,448 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:28:25,450 INFO  [Thread-0] root: Connected to localhost on port 44642
2023-03-18 22:28:27,772 INFO  [Thread-10] root: Recieved message with raw bytes [B@348dd041
2023-03-18 22:28:27,772 INFO  [Thread-10] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:28:27,772 INFO  [Thread-10] root: Message: GETece

2023-03-18 22:28:27,773 INFO  [Thread-10] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:28:27,774 INFO  [Thread-10] root: SERVER_IDLE
2023-03-18 22:28:27,774 INFO  [Thread-10] root: SERVER_IDLE
2023-03-18 22:28:27,774 INFO  [Thread-10] root: false
2023-03-18 22:28:27,774 INFO  [Thread-10] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:28:27,774 INFO  [Thread-10] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:28:27,774 INFO  [Thread-10] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:28:27,774 INFO  [Thread-10] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:28:27,774 INFO  [Thread-10] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:28:27,774 INFO  [Thread-10] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:28:27,774 INFO  [Thread-10] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:28:27,774 INFO  [Thread-10] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:28:37,784 ERROR [Thread-10] root: Error! Connection lost!
2023-03-18 22:28:37,784 INFO  [Thread-10] root: Closing connection
2023-03-18 22:28:56,940 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:28:56,942 INFO  [Thread-0] root: Connected to localhost on port 55972
2023-03-18 22:28:58,870 INFO  [Thread-11] root: Recieved message with raw bytes [B@6e6f973c
2023-03-18 22:28:58,870 INFO  [Thread-11] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:28:58,870 INFO  [Thread-11] root: Message: GETece

2023-03-18 22:28:58,871 INFO  [Thread-11] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:28:58,871 INFO  [Thread-11] root: SERVER_IDLE
2023-03-18 22:28:58,872 INFO  [Thread-11] root: SERVER_IDLE
2023-03-18 22:28:58,872 INFO  [Thread-11] root: false
2023-03-18 22:28:58,873 INFO  [Thread-11] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:28:58,873 INFO  [Thread-11] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:28:58,873 INFO  [Thread-11] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:28:58,873 INFO  [Thread-11] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:28:58,873 INFO  [Thread-11] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:28:58,873 INFO  [Thread-11] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:28:58,873 INFO  [Thread-11] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:28:58,873 INFO  [Thread-11] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:29:06,077 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:29:06,078 INFO  [Thread-0] root: Connected to localhost on port 57960
2023-03-18 22:29:08,118 INFO  [Thread-12] root: Recieved message with raw bytes [B@46e19366
2023-03-18 22:29:08,118 INFO  [Thread-12] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-18 22:29:08,118 INFO  [Thread-12] root: Message: KEYRANGE

2023-03-18 22:29:08,119 INFO  [Thread-12] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-18 22:29:08,119 INFO  [Thread-12] root: Sending keyrange according to metadata
2023-03-18 22:29:08,120 INFO  [Thread-12] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,<127.0.0.1:8085>;
'
2023-03-18 22:29:08,881 ERROR [Thread-11] root: Error! Connection lost!
2023-03-18 22:29:08,882 INFO  [Thread-11] root: Closing connection
2023-03-18 22:29:18,130 ERROR [Thread-12] root: Error! Connection lost!
2023-03-18 22:29:18,130 INFO  [Thread-12] root: Closing connection
2023-03-18 22:32:09,328 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:32:09,329 INFO  [Thread-0] root: Connected to localhost on port 39592
2023-03-18 22:32:11,016 INFO  [Thread-13] root: Recieved message with raw bytes [B@47bc7749
2023-03-18 22:32:11,017 INFO  [Thread-13] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:32:11,017 INFO  [Thread-13] root: Message: GETece

2023-03-18 22:32:11,017 INFO  [Thread-13] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:32:11,017 INFO  [Thread-13] root: SERVER_IDLE
2023-03-18 22:32:11,018 INFO  [Thread-13] root: SERVER_IDLE
2023-03-18 22:32:11,019 INFO  [Thread-13] root: false
2023-03-18 22:32:11,019 INFO  [Thread-13] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:32:11,019 INFO  [Thread-13] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:32:11,019 INFO  [Thread-13] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:32:11,019 INFO  [Thread-13] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:32:11,019 INFO  [Thread-13] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:32:11,019 INFO  [Thread-13] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:32:11,019 INFO  [Thread-13] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:32:11,019 INFO  [Thread-13] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:32:21,026 ERROR [Thread-13] root: Error! Connection lost!
2023-03-18 22:32:21,026 INFO  [Thread-13] root: Closing connection
2023-03-18 22:32:25,415 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:32:25,416 INFO  [Thread-0] root: Connected to localhost on port 43820
2023-03-18 22:32:26,961 INFO  [Thread-14] root: Recieved message with raw bytes [B@1e09bc21
2023-03-18 22:32:26,961 INFO  [Thread-14] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:32:26,961 INFO  [Thread-14] root: Message: GETece

2023-03-18 22:32:26,962 INFO  [Thread-14] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:32:26,962 INFO  [Thread-14] root: SERVER_IDLE
2023-03-18 22:32:26,962 INFO  [Thread-14] root: SERVER_IDLE
2023-03-18 22:32:26,962 INFO  [Thread-14] root: false
2023-03-18 22:32:26,962 INFO  [Thread-14] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:32:26,962 INFO  [Thread-14] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:32:26,962 INFO  [Thread-14] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:32:26,962 INFO  [Thread-14] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:32:26,962 INFO  [Thread-14] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:32:26,962 INFO  [Thread-14] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:32:26,962 INFO  [Thread-14] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:32:26,962 INFO  [Thread-14] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:32:28,681 INFO  [Thread-14] root: Recieved message with raw bytes [B@10ce5190
2023-03-18 22:32:28,681 INFO  [Thread-14] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:32:28,681 INFO  [Thread-14] root: Message: GETece

2023-03-18 22:32:28,682 INFO  [Thread-14] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:32:28,683 INFO  [Thread-14] root: SERVER_IDLE
2023-03-18 22:32:28,683 INFO  [Thread-14] root: SERVER_IDLE
2023-03-18 22:32:28,683 INFO  [Thread-14] root: false
2023-03-18 22:32:28,683 INFO  [Thread-14] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:32:28,683 INFO  [Thread-14] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:32:28,683 INFO  [Thread-14] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:32:28,683 INFO  [Thread-14] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:32:28,683 INFO  [Thread-14] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:32:28,683 INFO  [Thread-14] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:32:28,683 INFO  [Thread-14] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:32:28,683 INFO  [Thread-14] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:32:38,693 ERROR [Thread-14] root: Error! Connection lost!
2023-03-18 22:32:38,693 INFO  [Thread-14] root: Closing connection
2023-03-18 22:40:29,876 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:40:29,876 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:40:29,877 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:40:29,878 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:40:29,878 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:40:29,879 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:40:29,879 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:40:29,880 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:40:29,881 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:40:29,881 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:40:29,882 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:40:29,882 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:40:29,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:40:29,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:40:29,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:40:29,884 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:40:29,894 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:40:29,899 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:40:29,904 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800bf, negotiated timeout = 40000
2023-03-18 22:40:29,906 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:40:29,907 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:40:29,907 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:40:29,909 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c0, negotiated timeout = 40000
2023-03-18 22:40:29,915 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:40:29,918 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:40:29,927 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:40:29,927 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:40:29,928 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:40:41,483 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:40:41,485 INFO  [Thread-0] root: Connected to localhost on port 44708
2023-03-18 22:40:43,183 INFO  [Thread-2] root: Recieved message with raw bytes [B@29559d78
2023-03-18 22:40:43,183 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:40:43,184 INFO  [Thread-2] root: Message: GETece

2023-03-18 22:40:43,184 INFO  [Thread-2] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:40:43,184 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:40:43,185 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:40:43,185 INFO  [Thread-2] root: false
2023-03-18 22:40:43,186 INFO  [Thread-2] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:40:43,186 INFO  [Thread-2] root: []
2023-03-18 22:40:43,187 ERROR [Thread-2] root: 
2023-03-18 22:40:43,187 INFO  [Thread-2] root: Sent a message of type 'GET_ERROR' with key 'ece' and value ''
2023-03-18 22:40:53,198 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:40:53,198 INFO  [Thread-2] root: Closing connection
2023-03-18 22:41:53,647 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:41:53,650 INFO  [Thread-0] root: Connected to localhost on port 45840
2023-03-18 22:41:54,968 INFO  [Thread-3] root: Recieved message with raw bytes [B@aeb892b
2023-03-18 22:41:54,968 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:41:54,968 INFO  [Thread-3] root: Message: GETece

2023-03-18 22:41:54,968 INFO  [Thread-3] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:41:54,968 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:41:54,968 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:41:54,968 INFO  [Thread-3] root: false
2023-03-18 22:41:54,968 INFO  [Thread-3] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:41:54,968 INFO  [Thread-3] root: []
2023-03-18 22:41:54,968 ERROR [Thread-3] root: 
2023-03-18 22:41:54,968 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'ece' and value ''
2023-03-18 22:41:58,143 INFO  [Thread-3] root: Recieved message with raw bytes [B@42c6606
2023-03-18 22:41:58,143 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:41:58,143 INFO  [Thread-3] root: Message: GETece

2023-03-18 22:41:58,143 INFO  [Thread-3] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:41:58,143 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:41:58,144 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:41:58,144 INFO  [Thread-3] root: false
2023-03-18 22:41:58,144 INFO  [Thread-3] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:41:58,144 INFO  [Thread-3] root: []
2023-03-18 22:41:58,144 ERROR [Thread-3] root: 
2023-03-18 22:41:58,144 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'ece' and value ''
2023-03-18 22:42:06,334 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:42:06,334 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:42:06,334 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:42:06,335 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:42:06,335 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:42:06,336 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:42:06,337 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:42:06,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:42:06,339 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:42:06,349 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:42:06,355 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:42:06,361 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c1, negotiated timeout = 40000
2023-03-18 22:42:06,362 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:42:06,363 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:42:06,363 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:42:06,367 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c2, negotiated timeout = 40000
2023-03-18 22:42:06,373 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:42:06,375 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:42:06,383 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:42:06,383 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:42:06,384 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:42:13,298 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:42:13,300 INFO  [Thread-0] root: Connected to localhost on port 48756
2023-03-18 22:42:14,512 INFO  [Thread-2] root: Recieved message with raw bytes [B@5a459f99
2023-03-18 22:42:14,513 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:42:14,513 INFO  [Thread-2] root: Message: GETece

2023-03-18 22:42:14,513 INFO  [Thread-2] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:42:14,514 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:42:14,515 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:42:14,515 INFO  [Thread-2] root: false
2023-03-18 22:42:14,516 INFO  [Thread-2] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:42:14,516 INFO  [Thread-2] root: []
2023-03-18 22:42:14,517 ERROR [Thread-2] root: 
2023-03-18 22:42:14,517 INFO  [Thread-2] root: Sent a message of type 'GET_ERROR' with key 'ece' and value ''
2023-03-18 22:42:24,528 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:42:24,528 INFO  [Thread-2] root: Closing connection
2023-03-18 22:44:45,855 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:44:45,856 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:44:45,857 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:44:45,857 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:44:45,858 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:44:45,858 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:44:45,859 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:44:45,860 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:44:45,860 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:44:45,861 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:44:45,861 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:44:45,862 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:44:45,863 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:44:45,863 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:44:45,864 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:44:45,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:44:45,874 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:44:45,879 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:44:45,883 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c5, negotiated timeout = 40000
2023-03-18 22:44:45,885 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:44:45,885 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:44:45,886 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:44:45,887 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c6, negotiated timeout = 40000
2023-03-18 22:44:45,893 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:44:45,895 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:44:45,901 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:44:45,902 INFO  [Thread-0] root: Server listening on port: 8085
2023-03-18 22:44:45,909 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:44:45,910 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:44:45,911 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:44:45,911 INFO  [main-EventThread] root: 127.0.0.1:8085 was added and is obtaining keys from successor
2023-03-18 22:44:45,911 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:44:54,071 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:44:54,073 INFO  [Thread-0] root: Connected to localhost on port 36016
2023-03-18 22:44:57,697 INFO  [Thread-2] root: Recieved message with raw bytes [B@6a67838e
2023-03-18 22:44:57,697 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:44:57,697 INFO  [Thread-2] root: Message: GETece

2023-03-18 22:44:57,698 INFO  [Thread-2] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:44:57,698 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:44:57,699 INFO  [Thread-2] root: SERVER_IDLE
2023-03-18 22:44:57,699 INFO  [Thread-2] root: false
2023-03-18 22:44:57,700 INFO  [Thread-2] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:44:57,701 INFO  [Thread-2] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:44:57,702 INFO  [Thread-2] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:44:57,702 INFO  [Thread-2] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:44:57,703 INFO  [Thread-2] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:44:57,704 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:44:57,704 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:44:57,704 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:45:07,714 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:45:07,714 INFO  [Thread-2] root: Closing connection
2023-03-18 22:45:28,777 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:45:28,778 INFO  [Thread-0] root: Connected to localhost on port 46382
2023-03-18 22:45:35,606 INFO  [Thread-3] root: Recieved message with raw bytes [B@34863e6c
2023-03-18 22:45:35,606 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:45:35,606 INFO  [Thread-3] root: Message: GETece

2023-03-18 22:45:35,607 INFO  [Thread-3] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:45:35,607 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:45:35,607 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:45:35,607 INFO  [Thread-3] root: false
2023-03-18 22:45:35,607 INFO  [Thread-3] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:45:35,607 INFO  [Thread-3] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:45:35,607 INFO  [Thread-3] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:45:35,608 INFO  [Thread-3] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:45:35,609 INFO  [Thread-3] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:45:35,609 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:45:35,609 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:45:35,610 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:45:42,841 INFO  [Thread-3] root: Recieved message with raw bytes [B@3a41c68c
2023-03-18 22:45:42,842 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:45:42,842 INFO  [Thread-3] root: Message: GETece

2023-03-18 22:45:42,843 INFO  [Thread-3] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:45:42,843 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:45:42,843 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:45:42,843 INFO  [Thread-3] root: false
2023-03-18 22:45:42,843 INFO  [Thread-3] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:45:42,843 INFO  [Thread-3] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:45:42,843 INFO  [Thread-3] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:45:42,843 INFO  [Thread-3] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:45:42,843 INFO  [Thread-3] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:45:42,844 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:45:42,845 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:45:42,846 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:45:44,865 INFO  [Thread-3] root: Recieved message with raw bytes [B@3e7e551c
2023-03-18 22:45:44,865 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:45:44,865 INFO  [Thread-3] root: Message: GETece

2023-03-18 22:45:44,865 INFO  [Thread-3] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:45:44,865 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:45:44,865 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:45:44,865 INFO  [Thread-3] root: false
2023-03-18 22:45:44,866 INFO  [Thread-3] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:45:44,866 INFO  [Thread-3] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:45:44,867 INFO  [Thread-3] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:45:44,868 INFO  [Thread-3] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:45:44,868 INFO  [Thread-3] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:45:44,869 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:45:44,869 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:45:44,870 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:45:54,878 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 22:45:54,878 INFO  [Thread-3] root: Closing connection
2023-03-18 22:46:35,233 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:46:35,235 INFO  [Thread-0] root: Connected to localhost on port 33494
2023-03-18 22:46:36,516 INFO  [Thread-4] root: Recieved message with raw bytes [B@eb763ec
2023-03-18 22:46:36,516 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:36,516 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:36,517 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:36,517 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:36,517 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:36,517 INFO  [Thread-4] root: false
2023-03-18 22:46:36,517 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:36,517 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:36,517 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:36,517 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:36,518 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:36,519 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:36,519 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:36,520 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:38,498 INFO  [Thread-4] root: Recieved message with raw bytes [B@708c4a
2023-03-18 22:46:38,498 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:38,498 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:38,498 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:38,498 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:38,498 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:38,498 INFO  [Thread-4] root: false
2023-03-18 22:46:38,498 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:38,498 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:38,499 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:38,499 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:38,500 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:38,501 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:38,501 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:38,502 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:39,672 INFO  [Thread-4] root: Recieved message with raw bytes [B@44f089c
2023-03-18 22:46:39,673 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:39,673 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:39,673 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:39,674 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:39,674 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:39,674 INFO  [Thread-4] root: false
2023-03-18 22:46:39,674 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:39,674 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:39,674 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:39,674 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:39,674 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:39,674 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:39,675 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:39,675 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:40,876 INFO  [Thread-4] root: Recieved message with raw bytes [B@414d8671
2023-03-18 22:46:40,876 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:40,876 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:40,876 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:40,876 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:40,876 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:40,876 INFO  [Thread-4] root: false
2023-03-18 22:46:40,876 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:40,876 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:40,877 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:40,877 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:40,878 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:40,878 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:40,879 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:40,879 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:42,094 INFO  [Thread-4] root: Recieved message with raw bytes [B@74d025b7
2023-03-18 22:46:42,094 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:42,094 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:42,094 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:42,094 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:42,094 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:42,094 INFO  [Thread-4] root: false
2023-03-18 22:46:42,094 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:42,094 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:42,094 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:42,095 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:42,096 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:42,096 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:42,097 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:42,098 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:44,523 INFO  [Thread-4] root: Recieved message with raw bytes [B@7046e5bb
2023-03-18 22:46:44,523 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 22:46:44,523 INFO  [Thread-4] root: Message: GETthis

2023-03-18 22:46:44,524 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 22:46:44,524 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:44,524 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:44,524 INFO  [Thread-4] root: false
2023-03-18 22:46:44,524 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:44,524 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:44,524 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 22:46:44,525 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:44,525 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:44,526 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:44,527 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:44,528 ERROR [Thread-4] root: Key 'this' is not in the database
2023-03-18 22:46:44,528 INFO  [Thread-4] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 22:46:45,810 INFO  [Thread-4] root: Recieved message with raw bytes [B@c3118c7
2023-03-18 22:46:45,811 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:45,811 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:45,811 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:45,811 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:45,811 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:45,811 INFO  [Thread-4] root: false
2023-03-18 22:46:45,811 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:45,811 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:45,811 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:45,812 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:45,812 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:45,813 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:45,813 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:45,814 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:52,827 INFO  [Thread-4] root: Recieved message with raw bytes [B@2162793e
2023-03-18 22:46:52,827 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:52,827 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:52,827 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:52,827 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:52,827 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:52,827 INFO  [Thread-4] root: false
2023-03-18 22:46:52,827 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:52,827 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:52,827 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:52,827 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:52,827 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:52,827 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:52,827 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:52,827 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:46:54,685 INFO  [Thread-4] root: Recieved message with raw bytes [B@546a0d38
2023-03-18 22:46:54,685 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:46:54,685 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:46:54,685 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:46:54,685 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:54,685 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:46:54,686 INFO  [Thread-4] root: false
2023-03-18 22:46:54,686 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:54,686 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:46:54,687 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:46:54,687 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:46:54,687 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:46:54,687 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:46:54,687 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:46:54,687 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:00,923 INFO  [Thread-4] root: Recieved message with raw bytes [B@3299ef5b
2023-03-18 22:47:00,923 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:00,923 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:47:00,923 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:00,923 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:00,923 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:00,923 INFO  [Thread-4] root: false
2023-03-18 22:47:00,923 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:00,923 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:00,924 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:00,924 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:00,924 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:00,924 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:00,924 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:00,924 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:05,885 INFO  [Thread-4] root: Recieved message with raw bytes [B@7f06a3ba
2023-03-18 22:47:05,885 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-18 22:47:05,885 INFO  [Thread-4] root: Message: GETthis

2023-03-18 22:47:05,886 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-18 22:47:05,886 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:05,886 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:05,886 INFO  [Thread-4] root: false
2023-03-18 22:47:05,886 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:05,886 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:05,886 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-18 22:47:05,886 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:05,886 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:05,886 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:05,886 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:05,886 ERROR [Thread-4] root: Key 'this' is not in the database
2023-03-18 22:47:05,886 INFO  [Thread-4] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-18 22:47:07,142 INFO  [Thread-4] root: Recieved message with raw bytes [B@b9b69e8
2023-03-18 22:47:07,142 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:07,142 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:47:07,142 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:07,142 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:07,142 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:07,142 INFO  [Thread-4] root: false
2023-03-18 22:47:07,142 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:07,142 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:07,142 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:07,142 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:07,142 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:07,142 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:07,142 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:07,142 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:13,163 INFO  [Thread-4] root: Recieved message with raw bytes [B@156dd4ea
2023-03-18 22:47:13,163 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:13,163 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:47:13,164 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:13,164 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:13,164 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:13,164 INFO  [Thread-4] root: false
2023-03-18 22:47:13,164 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:13,164 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:13,165 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:13,165 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:13,165 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:13,165 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:13,165 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:13,165 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:18,392 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:47:18,394 INFO  [Thread-0] root: Connected to localhost on port 42540
2023-03-18 22:47:21,285 INFO  [Thread-4] root: Recieved message with raw bytes [B@68f3122b
2023-03-18 22:47:21,285 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:21,285 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:47:21,285 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:21,285 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:21,285 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:21,285 INFO  [Thread-4] root: false
2023-03-18 22:47:21,285 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:21,285 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:21,285 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:21,285 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:21,285 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:21,285 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:21,285 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:21,285 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:26,071 INFO  [Thread-5] root: Recieved message with raw bytes [B@13c3e0d0
2023-03-18 22:47:26,071 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:26,071 INFO  [Thread-5] root: Message: GETece

2023-03-18 22:47:26,071 INFO  [Thread-5] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:26,071 INFO  [Thread-5] root: SERVER_IDLE
2023-03-18 22:47:26,071 INFO  [Thread-5] root: SERVER_IDLE
2023-03-18 22:47:26,071 INFO  [Thread-5] root: false
2023-03-18 22:47:26,071 INFO  [Thread-5] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:26,071 INFO  [Thread-5] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:26,072 INFO  [Thread-5] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:26,072 INFO  [Thread-5] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:26,072 INFO  [Thread-5] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:26,072 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:26,072 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:26,072 INFO  [Thread-5] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:29,467 INFO  [Thread-4] root: Recieved message with raw bytes [B@22a267fc
2023-03-18 22:47:29,467 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:29,468 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:47:29,468 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:29,468 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:29,469 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:47:29,469 INFO  [Thread-4] root: false
2023-03-18 22:47:29,469 INFO  [Thread-4] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:29,469 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:29,469 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:29,469 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:29,469 INFO  [Thread-4] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:29,469 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:29,469 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:29,469 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:34,384 INFO  [Thread-5] root: Recieved message with raw bytes [B@1d041cd8
2023-03-18 22:47:34,384 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:34,384 INFO  [Thread-5] root: Message: GETece

2023-03-18 22:47:34,384 INFO  [Thread-5] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:34,384 INFO  [Thread-5] root: SERVER_IDLE
2023-03-18 22:47:34,384 INFO  [Thread-5] root: SERVER_IDLE
2023-03-18 22:47:34,384 INFO  [Thread-5] root: false
2023-03-18 22:47:34,384 INFO  [Thread-5] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:34,384 INFO  [Thread-5] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:47:34,384 INFO  [Thread-5] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:34,384 INFO  [Thread-5] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:47:34,384 INFO  [Thread-5] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:34,384 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:47:34,384 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:34,384 INFO  [Thread-5] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:37,933 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:47:37,933 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:47:37,934 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:47:37,935 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:47:37,935 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:47:37,936 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:47:37,936 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:47:37,937 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:47:37,938 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:47:37,939 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:47:37,940 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:47:37,940 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:47:37,941 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:47:37,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:47:37,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:47:37,944 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:47:37,956 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:47:37,961 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:47:37,966 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c7, negotiated timeout = 40000
2023-03-18 22:47:37,968 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:47:37,969 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:47:37,969 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:47:37,971 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c8, negotiated timeout = 40000
2023-03-18 22:47:37,978 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:47:37,980 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:47:37,986 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:47:37,987 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:47:37,988 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:47:37,989 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:47:37,990 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:47:37,990 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:37,990 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:47:37,990 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:47:37,992 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:47:37,994 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:37,994 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:47:37,994 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:47:37,995 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:47:37,995 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:47:37,996 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:47:37,999 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:47:37,999 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:47:37,999 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:47:38,000 INFO  [Thread-2] root: Recieved message with raw bytes [B@68906335
2023-03-18 22:47:38,000 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:47:38,000 INFO  [Thread-0] root: Connected to localhost on port 52010
2023-03-18 22:47:38,000 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:47:38,003 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:47:38,004 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:47:38,010 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:47:38,010 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:38,010 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3607e23f
2023-03-18 22:47:38,010 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:47:38,010 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:47:38,010 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:47:38,010 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:47:38,010 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:47:38,011 INFO  [Thread-2] root: Closing connection
2023-03-18 22:47:38,012 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:47:39,478 ERROR [Thread-4] root: Error! Connection lost!
2023-03-18 22:47:39,478 INFO  [Thread-4] root: Closing connection
2023-03-18 22:47:44,395 ERROR [Thread-5] root: Error! Connection lost!
2023-03-18 22:47:44,395 INFO  [Thread-5] root: Closing connection
2023-03-18 22:47:55,494 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:47:55,495 INFO  [Thread-0] root: Connected to localhost on port 47116
2023-03-18 22:47:56,715 INFO  [Thread-6] root: Recieved message with raw bytes [B@2c8387ef
2023-03-18 22:47:56,715 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:56,715 INFO  [Thread-6] root: Message: GETece

2023-03-18 22:47:56,716 INFO  [Thread-6] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:56,716 INFO  [Thread-6] root: SERVER_IDLE
2023-03-18 22:47:56,717 INFO  [Thread-6] root: SERVER_IDLE
2023-03-18 22:47:56,717 INFO  [Thread-6] root: false
2023-03-18 22:47:56,717 INFO  [Thread-6] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:56,717 INFO  [Thread-6] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:47:56,717 INFO  [Thread-6] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:56,717 INFO  [Thread-6] root: THE RANGE LOWER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:47:56,717 INFO  [Thread-6] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:56,717 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: true
2023-03-18 22:47:56,717 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:47:56,718 INFO  [Thread-6] root: Server cannot service for key 'ece'. Sending back metadata
2023-03-18 22:47:56,718 INFO  [Thread-6] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'ece' and value '127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15'
2023-03-18 22:47:56,720 ERROR [Thread-6] root: Error! Connection lost!
2023-03-18 22:47:56,720 INFO  [Thread-6] root: Closing connection
2023-03-18 22:47:56,720 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:47:56,721 INFO  [Thread-0] root: Connected to localhost on port 37388
2023-03-18 22:47:56,721 INFO  [Thread-3] root: Recieved message with raw bytes [B@5ba3234c
2023-03-18 22:47:56,722 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:47:56,722 INFO  [Thread-3] root: Message: GETece

2023-03-18 22:47:56,722 INFO  [Thread-3] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:47:56,722 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:47:56,722 INFO  [Thread-3] root: SERVER_IDLE
2023-03-18 22:47:56,722 INFO  [Thread-3] root: false
2023-03-18 22:47:56,722 INFO  [Thread-3] root: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:47:56,723 INFO  [Thread-3] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:47:56,723 INFO  [Thread-3] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:47:56,724 INFO  [Thread-3] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:47:56,724 INFO  [Thread-3] root: THE RANGE UPPER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:47:56,725 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-18 22:47:56,725 INFO  [Thread-3] root: key.compareTo(hashRange[1] true
2023-03-18 22:47:56,726 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:06,734 ERROR [Thread-3] root: Error! Connection lost!
2023-03-18 22:48:06,734 INFO  [Thread-3] root: Closing connection
2023-03-18 22:48:13,065 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:13,066 INFO  [Thread-0] root: Connected to localhost on port 43516
2023-03-18 22:48:14,351 INFO  [Thread-7] root: Recieved message with raw bytes [B@7e547fbc
2023-03-18 22:48:14,352 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:14,352 INFO  [Thread-7] root: Message: GETece

2023-03-18 22:48:14,352 INFO  [Thread-7] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:14,352 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 22:48:14,352 INFO  [Thread-7] root: SERVER_IDLE
2023-03-18 22:48:14,352 INFO  [Thread-7] root: false
2023-03-18 22:48:14,352 INFO  [Thread-7] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:14,352 INFO  [Thread-7] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:48:14,352 INFO  [Thread-7] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:14,352 INFO  [Thread-7] root: THE RANGE LOWER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:14,352 INFO  [Thread-7] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:14,352 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: true
2023-03-18 22:48:14,352 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:48:14,352 INFO  [Thread-7] root: Server cannot service for key 'ece'. Sending back metadata
2023-03-18 22:48:14,352 INFO  [Thread-7] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'ece' and value '127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15'
2023-03-18 22:48:14,354 ERROR [Thread-7] root: Error! Connection lost!
2023-03-18 22:48:14,354 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:14,354 INFO  [Thread-7] root: Closing connection
2023-03-18 22:48:14,355 INFO  [Thread-4] root: Recieved message with raw bytes [B@67e20d4b
2023-03-18 22:48:14,355 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:14,355 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:48:14,355 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:14,356 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:48:14,357 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:48:14,358 INFO  [Thread-4] root: false
2023-03-18 22:48:14,359 INFO  [Thread-4] root: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:14,359 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:48:14,356 INFO  [Thread-0] root: Connected to localhost on port 41838
2023-03-18 22:48:14,361 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:14,363 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:14,363 INFO  [Thread-4] root: THE RANGE UPPER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:14,364 INFO  [Thread-4] root: key.compareTo(hashRange[0]) > 0: true
2023-03-18 22:48:14,364 INFO  [Thread-4] root: key.compareTo(hashRange[1] true
2023-03-18 22:48:14,365 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:18,038 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:18,042 INFO  [Thread-0] root: Connected to localhost on port 43522
2023-03-18 22:48:18,044 INFO  [Thread-8] root: Recieved message with raw bytes [B@19e4ddb5
2023-03-18 22:48:18,047 INFO  [Thread-8] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:18,049 INFO  [Thread-8] root: Message: GETece

2023-03-18 22:48:18,049 INFO  [Thread-8] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:18,049 INFO  [Thread-8] root: SERVER_IDLE
2023-03-18 22:48:18,049 INFO  [Thread-8] root: SERVER_IDLE
2023-03-18 22:48:18,049 INFO  [Thread-8] root: false
2023-03-18 22:48:18,050 INFO  [Thread-8] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:18,050 INFO  [Thread-8] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:48:18,050 INFO  [Thread-8] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:18,050 INFO  [Thread-8] root: THE RANGE LOWER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:18,050 INFO  [Thread-8] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:18,050 INFO  [Thread-8] root: key.compareTo(hashRange[0]) < 0: true
2023-03-18 22:48:18,050 INFO  [Thread-8] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:48:18,050 INFO  [Thread-8] root: Server cannot service for key 'ece'. Sending back metadata
2023-03-18 22:48:18,050 INFO  [Thread-8] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'ece' and value '127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15'
2023-03-18 22:48:18,052 ERROR [Thread-8] root: Error! Connection lost!
2023-03-18 22:48:18,052 INFO  [Thread-8] root: Closing connection
2023-03-18 22:48:18,052 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:18,053 INFO  [Thread-0] root: Connected to localhost on port 41848
2023-03-18 22:48:18,054 INFO  [Thread-5] root: Recieved message with raw bytes [B@34773e41
2023-03-18 22:48:18,054 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:18,054 INFO  [Thread-5] root: Message: GETece

2023-03-18 22:48:18,054 INFO  [Thread-5] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:18,054 INFO  [Thread-5] root: SERVER_IDLE
2023-03-18 22:48:18,054 INFO  [Thread-5] root: SERVER_IDLE
2023-03-18 22:48:18,054 INFO  [Thread-5] root: false
2023-03-18 22:48:18,054 INFO  [Thread-5] root: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:18,054 INFO  [Thread-5] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:48:18,055 INFO  [Thread-5] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:18,055 INFO  [Thread-5] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:18,056 INFO  [Thread-5] root: THE RANGE UPPER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:18,056 INFO  [Thread-5] root: key.compareTo(hashRange[0]) > 0: true
2023-03-18 22:48:18,057 INFO  [Thread-5] root: key.compareTo(hashRange[1] true
2023-03-18 22:48:18,057 INFO  [Thread-5] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:21,650 INFO  [Thread-4] root: Recieved message with raw bytes [B@6925efc7
2023-03-18 22:48:21,650 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:21,650 INFO  [Thread-4] root: Message: GETece

2023-03-18 22:48:21,650 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:21,650 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:48:21,650 INFO  [Thread-4] root: SERVER_IDLE
2023-03-18 22:48:21,650 INFO  [Thread-4] root: false
2023-03-18 22:48:21,650 INFO  [Thread-4] root: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:21,650 INFO  [Thread-4] root: [0725393394f806b42f6213da4dabc3db, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-18 22:48:21,651 INFO  [Thread-4] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:21,651 INFO  [Thread-4] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:21,652 INFO  [Thread-4] root: THE RANGE UPPER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-18 22:48:21,653 INFO  [Thread-4] root: key.compareTo(hashRange[0]) > 0: true
2023-03-18 22:48:21,653 INFO  [Thread-4] root: key.compareTo(hashRange[1] true
2023-03-18 22:48:21,654 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:23,711 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:48:23,712 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:48:23,713 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:48:23,713 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:48:23,713 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:23,713 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:48:23,714 INFO  [Thread-0] root: Connected to localhost on port 54852
2023-03-18 22:48:23,714 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:48:23,714 INFO  [Thread-9] root: Recieved message with raw bytes [B@16f803b5
2023-03-18 22:48:23,715 INFO  [Thread-9] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:48:23,716 INFO  [Thread-9] root: Message: DATATRANSFERecethis

2023-03-18 22:48:23,716 INFO  [Thread-9] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:48:23,722 INFO  [Thread-9] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:48:23,722 INFO  [Thread-9] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:23,722 INFO  [Thread-1] root: Recieved message with raw bytes [B@7fd9edb
2023-03-18 22:48:23,722 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:48:23,722 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:48:23,722 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:23,722 INFO  [Thread-1] root: Closing connection
2023-03-18 22:48:23,723 ERROR [Thread-9] root: Error! Connection lost!
2023-03-18 22:48:23,724 INFO  [Thread-9] root: Closing connection
2023-03-18 22:48:23,731 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:48:23,733 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:48:23,734 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:48:23,735 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:23,735 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:48:26,436 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:26,437 INFO  [Thread-10] root: Recieved message with raw bytes [B@556182f9
2023-03-18 22:48:26,437 INFO  [Thread-10] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:26,437 INFO  [Thread-10] root: Message: GETece

2023-03-18 22:48:26,437 INFO  [Thread-10] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:26,437 INFO  [Thread-10] root: SERVER_IDLE
2023-03-18 22:48:26,437 INFO  [Thread-10] root: SERVER_IDLE
2023-03-18 22:48:26,437 INFO  [Thread-10] root: false
2023-03-18 22:48:26,437 INFO  [Thread-10] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:26,437 INFO  [Thread-10] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:48:26,437 INFO  [Thread-10] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:26,437 INFO  [Thread-10] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:48:26,437 INFO  [Thread-10] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:26,437 INFO  [Thread-10] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:48:26,437 INFO  [Thread-10] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:48:26,437 INFO  [Thread-10] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:26,438 INFO  [Thread-0] root: Connected to localhost on port 54866
2023-03-18 22:48:30,127 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:30,128 INFO  [Thread-0] root: Connected to localhost on port 54868
2023-03-18 22:48:30,128 INFO  [Thread-11] root: Recieved message with raw bytes [B@51a6cc21
2023-03-18 22:48:30,128 INFO  [Thread-11] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:30,128 INFO  [Thread-11] root: Message: GETece

2023-03-18 22:48:30,129 INFO  [Thread-11] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:30,129 INFO  [Thread-11] root: SERVER_IDLE
2023-03-18 22:48:30,129 INFO  [Thread-11] root: SERVER_IDLE
2023-03-18 22:48:30,129 INFO  [Thread-11] root: false
2023-03-18 22:48:30,129 INFO  [Thread-11] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:30,129 INFO  [Thread-11] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:48:30,129 INFO  [Thread-11] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:30,129 INFO  [Thread-11] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:48:30,129 INFO  [Thread-11] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:30,129 INFO  [Thread-11] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:48:30,129 INFO  [Thread-11] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:48:30,129 INFO  [Thread-11] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:32,418 INFO  [Thread-11] root: Recieved message with raw bytes [B@5f612865
2023-03-18 22:48:32,418 INFO  [Thread-11] root: Raw bytes: [71, 69, 84, 31, 101, 99, 101, 31, 31, 10]
2023-03-18 22:48:32,418 INFO  [Thread-11] root: Message: GETece

2023-03-18 22:48:32,418 INFO  [Thread-11] root: Received a message of type 'GET' with key 'ece' and value ''
2023-03-18 22:48:32,418 INFO  [Thread-11] root: SERVER_IDLE
2023-03-18 22:48:32,418 INFO  [Thread-11] root: SERVER_IDLE
2023-03-18 22:48:32,418 INFO  [Thread-11] root: false
2023-03-18 22:48:32,418 INFO  [Thread-11] root: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:32,418 INFO  [Thread-11] root: [0725393394f806b42f6213da4dabc3db]
2023-03-18 22:48:32,419 INFO  [Thread-11] root: THE KEY IS: 6f8a28be5f158752eba976d9a69f6abb
2023-03-18 22:48:32,419 INFO  [Thread-11] root: THE RANGE LOWER IS: 0725393394f806b42f6213da4dabc3dc
2023-03-18 22:48:32,419 INFO  [Thread-11] root: THE RANGE UPPER IS: 0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:32,419 INFO  [Thread-11] root: key.compareTo(hashRange[0]) < 0: false
2023-03-18 22:48:32,419 INFO  [Thread-11] root: key.compareTo(hashRange[1]) > 0 true
2023-03-18 22:48:32,419 INFO  [Thread-11] root: Sent a message of type 'GET_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:34,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-18 22:48:34,943 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-18 22:48:34,943 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-18 22:48:34,944 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-18 22:48:34,944 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-18 22:48:34,945 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-18 22:48:34,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-18 22:48:34,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-18 22:48:34,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-18 22:48:34,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-18 22:48:34,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-18 22:48:34,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-18 22:48:34,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-18 22:48:34,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-18 22:48:34,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-18 22:48:34,951 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-18 22:48:34,963 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:48:34,969 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:48:34,976 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800c9, negotiated timeout = 40000
2023-03-18 22:48:34,977 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-18 22:48:34,978 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-18 22:48:34,978 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-18 22:48:34,980 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10029906c9800ca, negotiated timeout = 40000
2023-03-18 22:48:34,987 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:48:34,990 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-18 22:48:34,995 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:48:34,997 INFO  [Thread-0] root: Initialize server ...
2023-03-18 22:48:34,999 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-18 22:48:34,999 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:48:35,000 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:48:35,001 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:35,001 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-18 22:48:35,001 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:48:35,002 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,85d27949e81cbe4c3d605c59cd7d7dc3,0725393394f806b42f6213da4dabc3db,15;127.0.0.1:8084,127.0.0.1,8084,0725393394f806b42f6213da4dabc3db,85d27949e81cbe4c3d605c59cd7d7dc3,15;
2023-03-18 22:48:35,004 INFO  [main-EventThread] root: 85d27949e81cbe4c3d605c59cd7d7dc3:0725393394f806b42f6213da4dabc3db
2023-03-18 22:48:35,005 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-18 22:48:35,005 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8085to node 127.0.0.1:8084
2023-03-18 22:48:35,006 INFO  [main-EventThread] root: Checking key key: ece
2023-03-18 22:48:35,007 INFO  [main-EventThread] root: Transferring key: ece
2023-03-18 22:48:35,007 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-18 22:48:35,011 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:48:35,011 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-18 22:48:35,012 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-18 22:48:35,013 INFO  [Thread-0] root: Connected to localhost on port 52076
2023-03-18 22:48:35,013 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:48:35,013 INFO  [Thread-2] root: Recieved message with raw bytes [B@2290626
2023-03-18 22:48:35,015 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:48:35,015 INFO  [Thread-2] root: Message: DATATRANSFERecethis

2023-03-18 22:48:35,016 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:48:35,022 INFO  [Thread-2] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:48:35,022 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:35,022 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5dcb71b3
2023-03-18 22:48:35,022 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:48:35,022 INFO  [main-EventThread] root: Message: PUT_SUCCESSecethis

2023-03-18 22:48:35,023 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:48:35,023 INFO  [main-EventThread] root: Closing connection
2023-03-18 22:48:35,024 ERROR [Thread-2] root: Error! Connection lost!
2023-03-18 22:48:35,024 INFO  [Thread-2] root: Closing connection
2023-03-18 22:48:35,025 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-18 22:48:36,446 ERROR [Thread-10] root: Error! Connection lost!
2023-03-18 22:48:36,446 INFO  [Thread-10] root: Closing connection
2023-03-18 22:48:42,426 ERROR [Thread-11] root: Error! Connection lost!
2023-03-18 22:48:42,426 INFO  [Thread-11] root: Closing connection
2023-03-18 22:52:16,053 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8085
2023-03-18 22:52:16,054 INFO  [Thread-1] root: Checking key key: ece
2023-03-18 22:52:16,055 INFO  [Thread-1] root: Transferring key: ece
2023-03-18 22:52:16,055 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-18 22:52:16,055 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-18 22:52:16,056 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8085
2023-03-18 22:52:16,057 INFO  [Thread-12] root: Recieved message with raw bytes [B@563cd9ae
2023-03-18 22:52:16,057 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:52:16,058 INFO  [Thread-12] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:52:16,058 INFO  [Thread-0] root: Connected to localhost on port 35738
2023-03-18 22:52:16,058 INFO  [Thread-12] root: Message: DATATRANSFERecethis

2023-03-18 22:52:16,059 INFO  [Thread-12] root: Received a message of type 'DATATRANSFER' with key 'ece' and value 'this'
2023-03-18 22:52:16,061 INFO  [Thread-12] root: Added key 'ece' and value 'this' to the database
2023-03-18 22:52:16,061 INFO  [Thread-12] root: Sent a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:52:16,061 INFO  [Thread-1] root: Recieved message with raw bytes [B@6af3df95
2023-03-18 22:52:16,061 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 101, 99, 101, 31, 116, 104, 105, 115, 31, 10]
2023-03-18 22:52:16,061 INFO  [Thread-1] root: Message: PUT_SUCCESSecethis

2023-03-18 22:52:16,061 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ece' and value 'this'
2023-03-18 22:52:16,062 INFO  [Thread-1] root: Closing connection
2023-03-18 22:52:16,063 ERROR [Thread-12] root: Error! Connection lost!
2023-03-18 22:52:16,063 INFO  [Thread-12] root: Closing connection
2023-03-18 22:52:16,069 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-18 22:52:16,072 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8085
2023-03-18 22:52:16,073 INFO  [main-EventThread] root: 127.0.0.1:8085,127.0.0.1,8085,0725393394f806b42f6213da4dabc3dc,0725393394f806b42f6213da4dabc3db,15;
2023-03-18 22:52:16,073 INFO  [main-EventThread] root: 0725393394f806b42f6213da4dabc3dc:0725393394f806b42f6213da4dabc3db
2023-03-18 22:52:16,074 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8085
2023-03-19 16:39:02,918 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 16:39:02,918 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 16:39:02,919 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 16:39:02,920 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 16:39:02,920 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 16:39:02,921 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 16:39:02,921 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 16:39:02,922 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 16:39:02,922 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 16:39:02,923 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 16:39:02,923 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 16:39:02,924 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 16:39:02,925 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 16:39:02,925 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 16:39:02,926 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 16:39:02,927 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 16:39:02,939 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:39:02,944 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:39:02,948 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b001c, negotiated timeout = 40000
2023-03-19 16:39:02,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 16:39:02,951 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:39:02,951 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:39:02,953 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b001d, negotiated timeout = 40000
2023-03-19 16:39:02,959 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:39:02,962 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:39:02,969 INFO  [Thread-0] root: Initialize server ...
2023-03-19 16:39:02,970 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 16:39:02,977 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:39:02,978 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:39:02,979 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:02,980 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 16:39:02,980 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:39:10,378 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 16:39:10,378 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 16:39:10,378 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 16:39:10,379 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 16:39:10,379 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 16:39:10,380 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 16:39:10,380 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 16:39:10,381 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 16:39:10,382 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 16:39:10,382 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 16:39:10,383 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 16:39:10,383 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 16:39:10,384 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 16:39:10,385 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 16:39:10,385 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 16:39:10,386 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 16:39:10,396 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:39:10,401 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:39:10,406 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b001e, negotiated timeout = 40000
2023-03-19 16:39:10,408 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 16:39:10,408 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:39:10,408 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:39:10,410 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b001f, negotiated timeout = 40000
2023-03-19 16:39:10,418 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:39:10,421 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:39:10,427 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:39:10,429 INFO  [Thread-0] root: Initialize server ...
2023-03-19 16:39:10,430 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-19 16:39:10,431 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 16:39:10,432 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:39:10,432 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:39:10,433 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:39:10,433 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:10,434 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-19 16:39:10,434 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:10,434 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 16:39:10,434 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:39:10,437 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-19 16:39:10,437 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:39:10,437 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 16:39:10,438 INFO  [main-EventThread] root: Closing connection
2023-03-19 16:39:10,438 ERROR [Thread-2] root: Error! Connection lost!
2023-03-19 16:39:10,438 INFO  [Thread-0] root: Connected to localhost on port 58738
2023-03-19 16:39:10,439 INFO  [Thread-2] root: Closing connection
2023-03-19 16:39:10,444 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 16:39:25,563 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:39:25,565 INFO  [Thread-0] root: Connected to localhost on port 37986
2023-03-19 16:39:27,390 INFO  [Thread-2] root: Recieved message with raw bytes [B@64221e0
2023-03-19 16:39:27,390 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 16:39:27,391 INFO  [Thread-2] root: Message: PUTthisthat

2023-03-19 16:39:27,391 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-19 16:39:27,391 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:27,392 INFO  [Thread-2] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:27,393 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:39:27,393 INFO  [Thread-2] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:27,394 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:27,394 INFO  [Thread-2] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 16:39:27,395 INFO  [Thread-2] root: key.compareTo(hashRange[1] false
2023-03-19 16:39:27,396 INFO  [Thread-2] root: Server cannot service for key 'this'. Sending back metadata
2023-03-19 16:39:27,396 INFO  [Thread-2] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-19 16:39:27,397 INFO  [Thread-2] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-19 16:39:27,405 ERROR [Thread-2] root: Error! Connection lost!
2023-03-19 16:39:27,405 INFO  [Thread-2] root: Closing connection
2023-03-19 16:39:27,405 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:39:27,406 INFO  [Thread-0] root: Connected to localhost on port 34248
2023-03-19 16:39:27,406 INFO  [Thread-3] root: Recieved message with raw bytes [B@2b8daf45
2023-03-19 16:39:27,407 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 16:39:27,407 INFO  [Thread-3] root: Message: PUTthisthat

2023-03-19 16:39:27,407 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-19 16:39:27,408 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:27,409 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:27,410 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:39:27,410 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:27,410 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:27,411 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:39:27,411 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:39:27,412 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:27,412 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:27,413 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:39:27,413 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:27,414 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:27,414 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:39:27,415 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:39:27,416 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-19 16:39:27,416 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 16:39:27,417 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:39:30,793 INFO  [Thread-3] root: Recieved message with raw bytes [B@4186a1e0
2023-03-19 16:39:30,793 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 16:39:30,793 INFO  [Thread-3] root: Message: PUThellothere

2023-03-19 16:39:30,794 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'hello' and value 'there'
2023-03-19 16:39:30,794 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:30,794 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:30,794 INFO  [Thread-3] root: THE KEY IS: 5d41402abc4b2a76b9719d911017c592
2023-03-19 16:39:30,795 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:30,795 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:30,795 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:39:30,796 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:39:30,797 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:30,797 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:30,798 INFO  [Thread-3] root: THE KEY IS: 5d41402abc4b2a76b9719d911017c592
2023-03-19 16:39:30,798 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:30,799 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:30,800 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:39:30,800 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:39:30,802 INFO  [Thread-3] root: Added key 'hello' and value 'there' to the database
2023-03-19 16:39:30,802 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:39:30,802 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 16:39:34,393 INFO  [Thread-3] root: Recieved message with raw bytes [B@1649d1
2023-03-19 16:39:34,393 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 97, 115, 100, 102, 31, 97, 115, 100, 102, 31, 10]
2023-03-19 16:39:34,393 INFO  [Thread-3] root: Message: PUTasdfasdf

2023-03-19 16:39:34,393 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'asdf' and value 'asdf'
2023-03-19 16:39:34,393 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:34,393 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:34,394 INFO  [Thread-3] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-19 16:39:34,394 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:34,394 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:34,394 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:39:34,394 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:39:34,394 INFO  [Thread-3] root: Server cannot service for key 'asdf'. Sending back metadata
2023-03-19 16:39:34,395 INFO  [Thread-3] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-19 16:39:34,395 INFO  [Thread-3] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'asdf' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-19 16:39:34,397 ERROR [Thread-3] root: Error! Connection lost!
2023-03-19 16:39:34,397 INFO  [Thread-3] root: Closing connection
2023-03-19 16:39:34,397 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:39:34,398 INFO  [Thread-3] root: Recieved message with raw bytes [B@75ee772f
2023-03-19 16:39:34,399 INFO  [Thread-0] root: Connected to localhost on port 51550
2023-03-19 16:39:34,399 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 97, 115, 100, 102, 31, 97, 115, 100, 102, 31, 10]
2023-03-19 16:39:34,399 INFO  [Thread-3] root: Message: PUTasdfasdf

2023-03-19 16:39:34,399 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'asdf' and value 'asdf'
2023-03-19 16:39:34,399 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:34,400 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:34,400 INFO  [Thread-3] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-19 16:39:34,400 INFO  [Thread-3] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:34,401 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:34,402 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 16:39:34,402 INFO  [Thread-3] root: key.compareTo(hashRange[1] true
2023-03-19 16:39:34,403 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:34,403 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:34,404 INFO  [Thread-3] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-19 16:39:34,404 INFO  [Thread-3] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:34,405 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:34,406 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 16:39:34,406 INFO  [Thread-3] root: key.compareTo(hashRange[1] true
2023-03-19 16:39:34,411 INFO  [Thread-3] root: Added key 'asdf' and value 'asdf' to the database
2023-03-19 16:39:34,411 INFO  [Thread-3] root: MESSAGE TO SEND: asdf
2023-03-19 16:39:34,412 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'asdf' and value 'asdf'
2023-03-19 16:39:36,771 INFO  [Thread-3] root: Recieved message with raw bytes [B@17371b3e
2023-03-19 16:39:36,771 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 97, 115, 100, 102, 31, 31, 10]
2023-03-19 16:39:36,771 INFO  [Thread-3] root: Message: GETasdf

2023-03-19 16:39:36,772 INFO  [Thread-3] root: Received a message of type 'GET' with key 'asdf' and value ''
2023-03-19 16:39:36,772 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:39:36,772 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:39:36,772 INFO  [Thread-3] root: false
2023-03-19 16:39:36,772 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:36,773 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:39:36,774 INFO  [Thread-3] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-19 16:39:36,774 INFO  [Thread-3] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:39:36,774 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:39:36,775 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 16:39:36,775 INFO  [Thread-3] root: key.compareTo(hashRange[1] true
2023-03-19 16:39:36,775 INFO  [Thread-3] root: MESSAGE TO SEND: asdf
2023-03-19 16:39:36,776 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'asdf' and value 'asdf'
2023-03-19 16:39:39,532 INFO  [Thread-3] root: Recieved message with raw bytes [B@fd9d4f
2023-03-19 16:39:39,532 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 16:39:39,532 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-19 16:39:39,532 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 16:39:39,533 INFO  [Thread-3] root: Sending keyrange according to metadata
2023-03-19 16:39:39,533 INFO  [Thread-3] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,<127.0.0.1:8083>;6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 16:39:39,533 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,<127.0.0.1:8083>;6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 16:39:49,542 ERROR [Thread-3] root: Error! Connection lost!
2023-03-19 16:39:49,543 INFO  [Thread-3] root: Closing connection
2023-03-19 16:39:50,599 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:39:50,600 INFO  [Thread-0] root: Connected to localhost on port 43316
2023-03-19 16:39:52,148 INFO  [Thread-4] root: Recieved message with raw bytes [B@70901606
2023-03-19 16:39:52,148 INFO  [Thread-4] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 16:39:52,148 INFO  [Thread-4] root: Message: KEYRANGE

2023-03-19 16:39:52,148 INFO  [Thread-4] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 16:39:52,148 INFO  [Thread-4] root: Sending keyrange according to metadata
2023-03-19 16:39:52,148 INFO  [Thread-4] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,<127.0.0.1:8083>;6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 16:39:52,149 INFO  [Thread-4] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,<127.0.0.1:8083>;6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 16:40:02,159 ERROR [Thread-4] root: Error! Connection lost!
2023-03-19 16:40:02,159 INFO  [Thread-4] root: Closing connection
2023-03-19 16:42:57,745 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 16:42:57,746 INFO  [Thread-1] root: Checking key key: asdf
2023-03-19 16:42:57,746 INFO  [Thread-1] root: Transferring key: asdf
2023-03-19 16:42:57,749 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-19 16:42:57,749 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:42:57,749 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-19 16:42:57,750 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'asdf' and value 'asdf'
2023-03-19 16:42:57,750 INFO  [Thread-4] root: Recieved message with raw bytes [B@478fc243
2023-03-19 16:42:57,750 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 97, 115, 100, 102, 31, 97, 115, 100, 102, 31, 10]
2023-03-19 16:42:57,751 INFO  [Thread-4] root: Message: DATATRANSFERasdfasdf

2023-03-19 16:42:57,751 INFO  [Thread-0] root: Connected to localhost on port 49168
2023-03-19 16:42:57,752 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'asdf' and value 'asdf'
2023-03-19 16:42:57,754 INFO  [Thread-4] root: Added key 'asdf' and value 'asdf' to the database
2023-03-19 16:42:57,754 INFO  [Thread-4] root: MESSAGE TO SEND: asdf
2023-03-19 16:42:57,754 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'asdf' and value 'asdf'
2023-03-19 16:42:57,754 INFO  [Thread-1] root: Recieved message with raw bytes [B@3a59c733
2023-03-19 16:42:57,754 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 97, 115, 100, 102, 31, 97, 115, 100, 102, 31, 10]
2023-03-19 16:42:57,754 INFO  [Thread-1] root: Message: PUT_SUCCESSasdfasdf

2023-03-19 16:42:57,755 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'asdf' and value 'asdf'
2023-03-19 16:42:57,756 INFO  [Thread-1] root: Closing connection
2023-03-19 16:42:57,756 ERROR [Thread-4] root: Error! Connection lost!
2023-03-19 16:42:57,757 INFO  [Thread-4] root: Closing connection
2023-03-19 16:42:57,763 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 16:42:57,765 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 16:42:57,766 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-19 16:42:57,767 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:42:57,767 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 16:43:13,984 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 16:43:13,985 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-19 16:43:13,986 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:43:13,986 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 16:43:41,143 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 16:43:41,143 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 16:43:41,144 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 16:43:41,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 16:43:41,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 16:43:41,146 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 16:43:41,146 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 16:43:41,147 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 16:43:41,148 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 16:43:41,148 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 16:43:41,149 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 16:43:41,149 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 16:43:41,150 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 16:43:41,151 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 16:43:41,151 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 16:43:41,152 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 16:43:41,163 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:43:41,168 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:43:41,173 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0022, negotiated timeout = 40000
2023-03-19 16:43:41,175 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 16:43:41,176 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:43:41,176 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:43:41,178 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0023, negotiated timeout = 40000
2023-03-19 16:43:41,185 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:43:41,188 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:43:41,194 INFO  [Thread-0] root: Initialize server ...
2023-03-19 16:43:41,195 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 16:43:41,197 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:43:41,197 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:43:41,198 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:43:41,199 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 16:43:41,199 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:43:44,542 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 16:43:44,542 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 16:43:44,543 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 16:43:44,543 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 16:43:44,544 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 16:43:44,544 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 16:43:44,545 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 16:43:44,545 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 16:43:44,546 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 16:43:44,546 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 16:43:44,547 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 16:43:44,547 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 16:43:44,548 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 16:43:44,548 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 16:43:44,549 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 16:43:44,550 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 16:43:44,563 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:43:44,568 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:43:44,573 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0024, negotiated timeout = 40000
2023-03-19 16:43:44,575 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 16:43:44,576 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:43:44,576 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:43:44,578 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0025, negotiated timeout = 40000
2023-03-19 16:43:44,586 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:43:44,588 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:43:44,594 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:43:44,595 INFO  [Thread-0] root: Initialize server ...
2023-03-19 16:43:44,596 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-19 16:43:44,597 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 16:43:44,598 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:43:44,599 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:43:44,600 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:43:44,600 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:43:44,600 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-19 16:43:44,601 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 16:43:44,601 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 16:43:44,602 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:43:44,604 INFO  [main-EventThread] root: Socket timeout: 10000
2023-03-19 16:43:44,604 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:43:44,604 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 16:43:44,605 INFO  [main-EventThread] root: Closing connection
2023-03-19 16:43:44,606 INFO  [Thread-0] root: Connected to localhost on port 59300
2023-03-19 16:43:44,606 ERROR [Thread-2] root: Error! Connection lost!
2023-03-19 16:43:44,607 INFO  [Thread-2] root: Closing connection
2023-03-19 16:43:44,610 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 16:43:53,592 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:43:53,594 INFO  [Thread-0] root: Connected to localhost on port 39942
2023-03-19 16:43:54,913 INFO  [Thread-2] root: Recieved message with raw bytes [B@1400acd5
2023-03-19 16:43:54,914 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 16:43:54,914 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-19 16:43:54,914 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 16:43:54,915 INFO  [Thread-2] root: Sending keyrange according to metadata
2023-03-19 16:43:54,915 INFO  [Thread-2] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,<127.0.0.1:8083>;6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 16:43:54,916 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,<127.0.0.1:8083>;6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 16:43:57,355 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-19 16:43:57,355 INFO  [Thread-1] root: Checking key key: this
2023-03-19 16:43:57,356 INFO  [Thread-1] root: Checking key key: asdf
2023-03-19 16:43:57,357 INFO  [Thread-1] root: Checking key key: hello
2023-03-19 16:43:57,357 INFO  [Thread-1] root: Transferring key: hello
2023-03-19 16:43:57,358 INFO  [Thread-1] root: Socket timeout: 10000
2023-03-19 16:43:57,358 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:43:57,358 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-19 16:43:57,360 INFO  [Thread-0] root: Connected to localhost on port 39946
2023-03-19 16:43:57,361 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'hello' and value 'there'
2023-03-19 16:43:57,361 INFO  [Thread-3] root: Recieved message with raw bytes [B@aeb892b
2023-03-19 16:43:57,361 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 16:43:57,362 INFO  [Thread-3] root: Message: DATATRANSFERhellothere

2023-03-19 16:43:57,362 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hello' and value 'there'
2023-03-19 16:43:57,369 INFO  [Thread-3] root: Added key 'hello' and value 'there' to the database
2023-03-19 16:43:57,369 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:43:57,369 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 16:43:57,369 INFO  [Thread-1] root: Recieved message with raw bytes [B@be01609
2023-03-19 16:43:57,369 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 16:43:57,369 INFO  [Thread-1] root: Message: PUT_SUCCESShellothere

2023-03-19 16:43:57,369 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 16:43:57,369 INFO  [Thread-1] root: Closing connection
2023-03-19 16:43:57,369 ERROR [Thread-3] root: Error! Connection lost!
2023-03-19 16:43:57,369 INFO  [Thread-3] root: Closing connection
2023-03-19 16:43:57,378 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:43:57,380 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:43:57,381 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:43:57,381 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:43:57,381 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:44:00,147 INFO  [Thread-2] root: Recieved message with raw bytes [B@1358d3b7
2023-03-19 16:44:00,147 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 16:44:00,147 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-19 16:44:00,147 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 16:44:00,147 INFO  [Thread-2] root: Sending keyrange according to metadata
2023-03-19 16:44:00,147 INFO  [Thread-2] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 16:44:00,147 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 16:44:10,157 ERROR [Thread-2] root: Error! Connection lost!
2023-03-19 16:44:10,157 INFO  [Thread-2] root: Closing connection
2023-03-19 16:44:12,547 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:44:12,548 INFO  [Thread-0] root: Connected to localhost on port 52310
2023-03-19 16:44:14,327 INFO  [Thread-4] root: Recieved message with raw bytes [B@23479057
2023-03-19 16:44:14,327 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:44:14,328 INFO  [Thread-4] root: Message: GETthis

2023-03-19 16:44:14,328 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:44:14,328 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 16:44:14,328 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 16:44:14,328 INFO  [Thread-4] root: false
2023-03-19 16:44:14,328 INFO  [Thread-4] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:44:14,328 INFO  [Thread-4] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:44:14,328 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:44:14,329 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:44:14,329 INFO  [Thread-4] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:44:14,330 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:44:14,330 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:44:14,331 ERROR [Thread-4] root: Key 'this' is not in the database
2023-03-19 16:44:14,331 INFO  [Thread-4] root: MESSAGE TO SEND: 
2023-03-19 16:44:14,332 INFO  [Thread-4] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-19 16:44:24,343 ERROR [Thread-4] root: Error! Connection lost!
2023-03-19 16:44:24,343 INFO  [Thread-4] root: Closing connection
2023-03-19 16:46:45,682 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:46:45,684 INFO  [Thread-0] root: Connected to localhost on port 38866
2023-03-19 16:46:46,669 INFO  [Thread-5] root: Recieved message with raw bytes [B@7fb835e1
2023-03-19 16:46:46,669 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:46:46,669 INFO  [Thread-5] root: Message: GETthis

2023-03-19 16:46:46,669 INFO  [Thread-5] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:46:46,669 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:46,669 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:46,669 INFO  [Thread-5] root: false
2023-03-19 16:46:46,669 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:46,669 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:46:46,670 INFO  [Thread-5] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:46:46,670 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:46:46,671 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:46,671 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:46:46,672 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:46:46,673 ERROR [Thread-5] root: Key 'this' is not in the database
2023-03-19 16:46:46,673 INFO  [Thread-5] root: MESSAGE TO SEND: 
2023-03-19 16:46:46,674 INFO  [Thread-5] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-19 16:46:48,579 INFO  [Thread-5] root: Recieved message with raw bytes [B@717fc466
2023-03-19 16:46:48,579 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:46:48,579 INFO  [Thread-5] root: Message: GETthat

2023-03-19 16:46:48,580 INFO  [Thread-5] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:46:48,580 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:48,580 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:48,580 INFO  [Thread-5] root: false
2023-03-19 16:46:48,580 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:48,580 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:46:48,580 INFO  [Thread-5] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:46:48,581 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:46:48,582 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:48,582 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:46:48,583 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:46:48,584 ERROR [Thread-5] root: Key 'that' is not in the database
2023-03-19 16:46:48,584 INFO  [Thread-5] root: MESSAGE TO SEND: 
2023-03-19 16:46:48,585 INFO  [Thread-5] root: Sent a message of type 'GET_ERROR' with key 'that' and value ''
2023-03-19 16:46:50,193 INFO  [Thread-5] root: Recieved message with raw bytes [B@75405e91
2023-03-19 16:46:50,193 INFO  [Thread-5] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 16:46:50,193 INFO  [Thread-5] root: Message: PUTthisthat

2023-03-19 16:46:50,193 INFO  [Thread-5] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-19 16:46:50,193 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:50,193 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:46:50,193 INFO  [Thread-5] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:46:50,193 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:46:50,193 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:50,193 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:46:50,193 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:46:50,193 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:50,193 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:46:50,195 INFO  [Thread-5] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:46:50,195 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:46:50,195 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:50,196 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:46:50,197 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:46:50,198 INFO  [Thread-5] root: Added key 'this' and value 'that' to the database
2023-03-19 16:46:50,198 INFO  [Thread-5] root: MESSAGE TO SEND: that
2023-03-19 16:46:50,199 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:46:51,443 INFO  [Thread-5] root: Recieved message with raw bytes [B@3042ce5d
2023-03-19 16:46:51,444 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:46:51,444 INFO  [Thread-5] root: Message: GETthis

2023-03-19 16:46:51,444 INFO  [Thread-5] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:46:51,444 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:51,445 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:51,445 INFO  [Thread-5] root: false
2023-03-19 16:46:51,445 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:51,445 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:46:51,446 INFO  [Thread-5] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:46:51,446 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:46:51,446 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:51,446 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:46:51,446 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:46:51,446 INFO  [Thread-5] root: MESSAGE TO SEND: that
2023-03-19 16:46:51,446 INFO  [Thread-5] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:46:53,393 INFO  [Thread-5] root: Recieved message with raw bytes [B@eebf289
2023-03-19 16:46:53,393 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 97, 115, 100, 102, 31, 31, 10]
2023-03-19 16:46:53,393 INFO  [Thread-5] root: Message: GETasdf

2023-03-19 16:46:53,393 INFO  [Thread-5] root: Received a message of type 'GET' with key 'asdf' and value ''
2023-03-19 16:46:53,393 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:53,393 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:46:53,393 INFO  [Thread-5] root: false
2023-03-19 16:46:53,393 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:53,393 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:46:53,394 INFO  [Thread-5] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-19 16:46:53,394 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:46:53,394 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:46:53,394 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:46:53,394 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:46:53,395 ERROR [Thread-5] root: Key 'asdf' is not in the database
2023-03-19 16:46:53,395 INFO  [Thread-5] root: MESSAGE TO SEND: 
2023-03-19 16:46:53,395 INFO  [Thread-5] root: Sent a message of type 'GET_ERROR' with key 'asdf' and value ''
2023-03-19 16:47:02,459 INFO  [Thread-5] root: Recieved message with raw bytes [B@1b85bc6
2023-03-19 16:47:02,459 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 104, 101, 108, 108, 111, 31, 31, 10]
2023-03-19 16:47:02,460 INFO  [Thread-5] root: Message: GEThello

2023-03-19 16:47:02,460 INFO  [Thread-5] root: Received a message of type 'GET' with key 'hello' and value ''
2023-03-19 16:47:02,460 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:47:02,460 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 16:47:02,460 INFO  [Thread-5] root: false
2023-03-19 16:47:02,460 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:02,460 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:47:02,460 INFO  [Thread-5] root: THE KEY IS: 5d41402abc4b2a76b9719d911017c592
2023-03-19 16:47:02,460 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:47:02,460 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:02,460 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:47:02,460 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:47:02,460 INFO  [Thread-5] root: MESSAGE TO SEND: there
2023-03-19 16:47:02,460 INFO  [Thread-5] root: Sent a message of type 'GET_SUCCESS' with key 'hello' and value 'there'
2023-03-19 16:47:09,661 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:47:09,662 INFO  [Thread-0] root: Connected to localhost on port 54320
2023-03-19 16:47:11,342 INFO  [Thread-6] root: Recieved message with raw bytes [B@3d87c78e
2023-03-19 16:47:11,342 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:47:11,342 INFO  [Thread-6] root: Message: GETthis

2023-03-19 16:47:11,342 INFO  [Thread-6] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:47:11,342 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 16:47:11,342 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 16:47:11,342 INFO  [Thread-6] root: false
2023-03-19 16:47:11,342 INFO  [Thread-6] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:11,342 INFO  [Thread-6] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:47:11,343 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:47:11,343 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:47:11,343 INFO  [Thread-6] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:11,343 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:47:11,343 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:47:11,343 INFO  [Thread-6] root: MESSAGE TO SEND: that
2023-03-19 16:47:11,343 INFO  [Thread-6] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:47:12,470 ERROR [Thread-5] root: Error! Connection lost!
2023-03-19 16:47:12,470 INFO  [Thread-5] root: Closing connection
2023-03-19 16:47:13,535 INFO  [Thread-6] root: Recieved message with raw bytes [B@33403e4e
2023-03-19 16:47:13,535 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:47:13,535 INFO  [Thread-6] root: Message: GETthat

2023-03-19 16:47:13,536 INFO  [Thread-6] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:47:13,536 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 16:47:13,537 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 16:47:13,538 INFO  [Thread-6] root: false
2023-03-19 16:47:13,538 INFO  [Thread-6] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:13,538 INFO  [Thread-6] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:47:13,539 INFO  [Thread-6] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:47:13,539 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:47:13,540 INFO  [Thread-6] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:13,541 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:47:13,541 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:47:13,542 ERROR [Thread-6] root: Key 'that' is not in the database
2023-03-19 16:47:13,543 INFO  [Thread-6] root: MESSAGE TO SEND: 
2023-03-19 16:47:13,543 INFO  [Thread-6] root: Sent a message of type 'GET_ERROR' with key 'that' and value ''
2023-03-19 16:47:16,115 INFO  [Thread-6] root: Recieved message with raw bytes [B@707ddaf0
2023-03-19 16:47:16,115 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 104, 101, 108, 108, 111, 31, 31, 10]
2023-03-19 16:47:16,115 INFO  [Thread-6] root: Message: GEThello

2023-03-19 16:47:16,116 INFO  [Thread-6] root: Received a message of type 'GET' with key 'hello' and value ''
2023-03-19 16:47:16,117 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 16:47:16,117 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 16:47:16,117 INFO  [Thread-6] root: false
2023-03-19 16:47:16,117 INFO  [Thread-6] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:16,117 INFO  [Thread-6] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:47:16,117 INFO  [Thread-6] root: THE KEY IS: 5d41402abc4b2a76b9719d911017c592
2023-03-19 16:47:16,117 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:47:16,117 INFO  [Thread-6] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:47:16,117 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:47:16,117 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:47:16,118 INFO  [Thread-6] root: MESSAGE TO SEND: there
2023-03-19 16:47:16,118 INFO  [Thread-6] root: Sent a message of type 'GET_SUCCESS' with key 'hello' and value 'there'
2023-03-19 16:47:26,129 ERROR [Thread-6] root: Error! Connection lost!
2023-03-19 16:47:26,129 INFO  [Thread-6] root: Closing connection
2023-03-19 16:48:48,931 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:48:48,933 INFO  [Thread-0] root: Connected to localhost on port 35502
2023-03-19 16:48:50,130 INFO  [Thread-7] root: Recieved message with raw bytes [B@5b9a7704
2023-03-19 16:48:50,131 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:48:50,131 INFO  [Thread-7] root: Message: GETthis

2023-03-19 16:48:50,131 INFO  [Thread-7] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:48:50,132 INFO  [Thread-7] root: SERVER_IDLE
2023-03-19 16:48:50,132 INFO  [Thread-7] root: SERVER_IDLE
2023-03-19 16:48:50,132 INFO  [Thread-7] root: false
2023-03-19 16:48:50,132 INFO  [Thread-7] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:50,132 INFO  [Thread-7] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:48:50,132 INFO  [Thread-7] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:48:50,132 INFO  [Thread-7] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:48:50,132 INFO  [Thread-7] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:50,132 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:48:50,132 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:48:50,132 INFO  [Thread-7] root: MESSAGE TO SEND: that
2023-03-19 16:48:50,132 INFO  [Thread-7] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:48:51,471 INFO  [Thread-7] root: Recieved message with raw bytes [B@555d8207
2023-03-19 16:48:51,471 INFO  [Thread-7] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:48:51,471 INFO  [Thread-7] root: Message: GETthat

2023-03-19 16:48:51,472 INFO  [Thread-7] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:48:51,472 INFO  [Thread-7] root: SERVER_IDLE
2023-03-19 16:48:51,472 INFO  [Thread-7] root: SERVER_IDLE
2023-03-19 16:48:51,472 INFO  [Thread-7] root: false
2023-03-19 16:48:51,472 INFO  [Thread-7] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:51,472 INFO  [Thread-7] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:48:51,472 INFO  [Thread-7] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:48:51,472 INFO  [Thread-7] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:48:51,472 INFO  [Thread-7] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:51,472 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:48:51,472 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:48:51,472 ERROR [Thread-7] root: Key 'that' is not in the database
2023-03-19 16:48:51,472 INFO  [Thread-7] root: MESSAGE TO SEND: 
2023-03-19 16:48:51,472 INFO  [Thread-7] root: Sent a message of type 'GET_ERROR' with key 'that' and value ''
2023-03-19 16:48:53,882 INFO  [Thread-7] root: Recieved message with raw bytes [B@51621c74
2023-03-19 16:48:53,883 INFO  [Thread-7] root: Raw bytes: [80, 85, 84, 31, 116, 104, 97, 116, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 16:48:53,883 INFO  [Thread-7] root: Message: PUTthatthere

2023-03-19 16:48:53,883 INFO  [Thread-7] root: Received a message of type 'PUT' with key 'that' and value 'there'
2023-03-19 16:48:53,884 INFO  [Thread-7] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:53,884 INFO  [Thread-7] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:48:53,884 INFO  [Thread-7] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:48:53,884 INFO  [Thread-7] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:48:53,884 INFO  [Thread-7] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:53,884 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:48:53,884 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:48:53,884 INFO  [Thread-7] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:53,884 INFO  [Thread-7] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:48:53,885 INFO  [Thread-7] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:48:53,885 INFO  [Thread-7] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:48:53,885 INFO  [Thread-7] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:48:53,885 INFO  [Thread-7] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:48:53,885 INFO  [Thread-7] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:48:53,886 INFO  [Thread-7] root: Added key 'that' and value 'there' to the database
2023-03-19 16:48:53,886 INFO  [Thread-7] root: MESSAGE TO SEND: there
2023-03-19 16:48:53,886 INFO  [Thread-7] root: Sent a message of type 'PUT_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:49:00,241 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:49:00,242 INFO  [Thread-0] root: Connected to localhost on port 47546
2023-03-19 16:49:02,791 INFO  [Thread-8] root: Recieved message with raw bytes [B@ac51575
2023-03-19 16:49:02,791 INFO  [Thread-8] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:49:02,791 INFO  [Thread-8] root: Message: GETthis

2023-03-19 16:49:02,791 INFO  [Thread-8] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:49:02,791 INFO  [Thread-8] root: SERVER_IDLE
2023-03-19 16:49:02,791 INFO  [Thread-8] root: SERVER_IDLE
2023-03-19 16:49:02,791 INFO  [Thread-8] root: false
2023-03-19 16:49:02,791 INFO  [Thread-8] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:49:02,791 INFO  [Thread-8] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:49:02,792 INFO  [Thread-8] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:49:02,792 INFO  [Thread-8] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:49:02,792 INFO  [Thread-8] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:49:02,792 INFO  [Thread-8] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:49:02,792 INFO  [Thread-8] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:49:02,792 INFO  [Thread-8] root: MESSAGE TO SEND: that
2023-03-19 16:49:02,792 INFO  [Thread-8] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:49:03,894 ERROR [Thread-7] root: Error! Connection lost!
2023-03-19 16:49:03,894 INFO  [Thread-7] root: Closing connection
2023-03-19 16:49:05,634 INFO  [Thread-8] root: Recieved message with raw bytes [B@402ea5d
2023-03-19 16:49:05,634 INFO  [Thread-8] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:49:05,634 INFO  [Thread-8] root: Message: GETthat

2023-03-19 16:49:05,634 INFO  [Thread-8] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:49:05,634 INFO  [Thread-8] root: SERVER_IDLE
2023-03-19 16:49:05,634 INFO  [Thread-8] root: SERVER_IDLE
2023-03-19 16:49:05,634 INFO  [Thread-8] root: false
2023-03-19 16:49:05,634 INFO  [Thread-8] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:49:05,634 INFO  [Thread-8] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:49:05,635 INFO  [Thread-8] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:49:05,635 INFO  [Thread-8] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:49:05,635 INFO  [Thread-8] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:49:05,635 INFO  [Thread-8] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:49:05,635 INFO  [Thread-8] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:49:05,635 INFO  [Thread-8] root: MESSAGE TO SEND: there
2023-03-19 16:49:05,635 INFO  [Thread-8] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:49:07,175 INFO  [Thread-8] root: Recieved message with raw bytes [B@3d7e05
2023-03-19 16:49:07,175 INFO  [Thread-8] root: Raw bytes: [71, 69, 84, 31, 112, 117, 116, 31, 31, 10]
2023-03-19 16:49:07,175 INFO  [Thread-8] root: Message: GETput

2023-03-19 16:49:07,175 INFO  [Thread-8] root: Received a message of type 'GET' with key 'put' and value ''
2023-03-19 16:49:07,175 INFO  [Thread-8] root: SERVER_IDLE
2023-03-19 16:49:07,175 INFO  [Thread-8] root: SERVER_IDLE
2023-03-19 16:49:07,175 INFO  [Thread-8] root: false
2023-03-19 16:49:07,175 INFO  [Thread-8] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:49:07,175 INFO  [Thread-8] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:49:07,175 INFO  [Thread-8] root: THE KEY IS: 8e13ffc9fd9d6a6761231a764bdf106b
2023-03-19 16:49:07,175 INFO  [Thread-8] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:49:07,175 INFO  [Thread-8] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:49:07,175 INFO  [Thread-8] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:49:07,175 INFO  [Thread-8] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:49:07,175 ERROR [Thread-8] root: Key 'put' is not in the database
2023-03-19 16:49:07,175 INFO  [Thread-8] root: MESSAGE TO SEND: 
2023-03-19 16:49:07,175 INFO  [Thread-8] root: Sent a message of type 'GET_ERROR' with key 'put' and value ''
2023-03-19 16:49:17,185 ERROR [Thread-8] root: Error! Connection lost!
2023-03-19 16:49:17,185 INFO  [Thread-8] root: Closing connection
2023-03-19 16:50:48,606 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 16:50:48,606 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 16:50:48,607 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 16:50:48,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 16:50:48,609 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 16:50:48,619 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:50:48,623 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:50:48,628 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0028, negotiated timeout = 40000
2023-03-19 16:50:48,630 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 16:50:48,630 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:50:48,630 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:50:48,632 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0029, negotiated timeout = 40000
2023-03-19 16:50:48,638 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:50:48,641 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:50:48,647 INFO  [Thread-0] root: Initialize server ...
2023-03-19 16:50:48,649 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 16:50:48,656 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:50:48,657 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:50:48,658 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:50:48,659 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 16:50:48,659 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:50:59,639 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:50:59,640 INFO  [Thread-0] root: Connected to localhost on port 57676
2023-03-19 16:51:05,920 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:51:05,921 INFO  [Thread-0] root: Connected to localhost on port 41836
2023-03-19 16:51:07,136 INFO  [Thread-3] root: Recieved message with raw bytes [B@328e5ee2
2023-03-19 16:51:07,137 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:51:07,137 INFO  [Thread-3] root: Message: GETthis

2023-03-19 16:51:07,137 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:51:07,138 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:07,138 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:07,139 INFO  [Thread-3] root: false
2023-03-19 16:51:07,140 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:07,140 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:07,141 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:51:07,141 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:07,142 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:07,143 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:51:07,144 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:51:07,144 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 16:51:07,145 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:51:08,627 INFO  [Thread-3] root: Recieved message with raw bytes [B@524bd2a3
2023-03-19 16:51:08,627 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:51:08,627 INFO  [Thread-3] root: Message: GETthat

2023-03-19 16:51:08,628 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:51:08,629 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:08,629 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:08,629 INFO  [Thread-3] root: false
2023-03-19 16:51:08,629 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:08,629 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:08,630 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:51:08,630 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:08,631 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:08,632 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:51:08,632 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:51:08,633 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:51:08,634 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:51:09,642 INFO  [Thread-3] root: Recieved message with raw bytes [B@4c08125f
2023-03-19 16:51:09,642 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:51:09,642 INFO  [Thread-3] root: Message: GETthis

2023-03-19 16:51:09,642 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:51:09,643 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:09,644 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:09,644 INFO  [Thread-3] root: false
2023-03-19 16:51:09,644 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:09,644 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:09,644 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:51:09,644 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:09,644 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:09,644 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:51:09,644 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:51:09,644 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 16:51:09,644 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:51:09,646 ERROR [Thread-2] root: Error! Connection lost!
2023-03-19 16:51:09,646 INFO  [Thread-2] root: Closing connection
2023-03-19 16:51:10,490 INFO  [Thread-3] root: Recieved message with raw bytes [B@32846d09
2023-03-19 16:51:10,490 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:51:10,490 INFO  [Thread-3] root: Message: GETthat

2023-03-19 16:51:10,490 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:51:10,490 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:10,490 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:10,490 INFO  [Thread-3] root: false
2023-03-19 16:51:10,490 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:10,490 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:10,491 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:51:10,492 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:10,492 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:10,493 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:51:10,494 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:51:10,494 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:51:10,495 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:51:12,897 INFO  [Thread-3] root: Recieved message with raw bytes [B@6f77ec6
2023-03-19 16:51:12,897 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 104, 101, 114, 101, 31, 31, 10]
2023-03-19 16:51:12,897 INFO  [Thread-3] root: Message: GEThere

2023-03-19 16:51:12,898 INFO  [Thread-3] root: Received a message of type 'GET' with key 'here' and value ''
2023-03-19 16:51:12,900 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:12,900 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:12,900 INFO  [Thread-3] root: false
2023-03-19 16:51:12,900 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:12,900 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:12,900 INFO  [Thread-3] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-19 16:51:12,900 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:12,900 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:12,900 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:51:12,901 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:51:12,902 ERROR [Thread-3] root: Key 'here' is not in the database
2023-03-19 16:51:12,902 INFO  [Thread-3] root: MESSAGE TO SEND: 
2023-03-19 16:51:12,903 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'here' and value ''
2023-03-19 16:51:15,948 INFO  [Thread-3] root: Recieved message with raw bytes [B@a257a71
2023-03-19 16:51:15,948 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 16:51:15,948 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-19 16:51:15,948 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 16:51:15,948 INFO  [Thread-3] root: Sending keyrange according to metadata
2023-03-19 16:51:15,948 INFO  [Thread-3] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 16:51:15,949 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 16:51:17,029 INFO  [Thread-3] root: Recieved message with raw bytes [B@6331b80
2023-03-19 16:51:17,029 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 115, 105, 31, 31, 10]
2023-03-19 16:51:17,029 INFO  [Thread-3] root: Message: GETthsi

2023-03-19 16:51:17,029 INFO  [Thread-3] root: Received a message of type 'GET' with key 'thsi' and value ''
2023-03-19 16:51:17,029 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:17,029 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:17,029 INFO  [Thread-3] root: false
2023-03-19 16:51:17,029 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:17,029 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:17,030 INFO  [Thread-3] root: THE KEY IS: c274c16c926266162ccb0865585b8750
2023-03-19 16:51:17,030 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:17,030 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:17,030 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:51:17,030 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:51:17,030 ERROR [Thread-3] root: Key 'thsi' is not in the database
2023-03-19 16:51:17,030 INFO  [Thread-3] root: MESSAGE TO SEND: 
2023-03-19 16:51:17,031 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'thsi' and value ''
2023-03-19 16:51:17,981 INFO  [Thread-3] root: Recieved message with raw bytes [B@17ced26a
2023-03-19 16:51:17,981 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:51:17,981 INFO  [Thread-3] root: Message: GETthat

2023-03-19 16:51:17,982 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:51:17,982 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:17,982 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:51:17,982 INFO  [Thread-3] root: false
2023-03-19 16:51:17,982 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:17,982 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:51:17,982 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:51:17,983 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:51:17,983 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:51:17,984 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:51:17,984 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:51:17,985 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:51:17,986 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:51:27,996 ERROR [Thread-3] root: Error! Connection lost!
2023-03-19 16:51:27,996 INFO  [Thread-3] root: Closing connection
2023-03-19 16:56:49,734 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 16:56:49,734 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 16:56:49,735 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 16:56:49,736 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 16:56:49,736 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 16:56:49,737 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 16:56:49,737 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 16:56:49,738 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 16:56:49,739 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 16:56:49,739 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 16:56:49,740 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 16:56:49,740 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 16:56:49,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 16:56:49,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 16:56:49,742 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 16:56:49,743 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 16:56:49,753 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:56:49,758 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:56:49,764 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b002a, negotiated timeout = 40000
2023-03-19 16:56:49,765 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 16:56:49,766 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 16:56:49,767 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 16:56:49,769 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b002b, negotiated timeout = 40000
2023-03-19 16:56:49,775 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:56:49,777 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 16:56:49,784 INFO  [Thread-0] root: Initialize server ...
2023-03-19 16:56:49,785 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 16:56:49,785 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 16:56:49,786 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 16:56:49,787 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:56:49,787 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 16:56:49,788 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 16:56:56,391 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:56:56,393 INFO  [Thread-0] root: Connected to localhost on port 56212
2023-03-19 16:56:58,546 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b784fe8
2023-03-19 16:56:58,547 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:56:58,547 INFO  [Thread-2] root: Message: GETthis

2023-03-19 16:56:58,547 INFO  [Thread-2] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:56:58,547 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 16:56:58,547 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 16:56:58,548 INFO  [Thread-2] root: false
2023-03-19 16:56:58,548 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:56:58,548 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:56:58,549 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:56:58,550 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:56:58,550 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:56:58,550 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:56:58,551 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:56:58,553 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-19 16:56:58,554 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:57:00,855 INFO  [Thread-2] root: Recieved message with raw bytes [B@bc29156
2023-03-19 16:57:00,856 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:57:00,856 INFO  [Thread-2] root: Message: GETthat

2023-03-19 16:57:00,856 INFO  [Thread-2] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:57:00,857 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 16:57:00,857 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 16:57:00,857 INFO  [Thread-2] root: false
2023-03-19 16:57:00,857 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:00,857 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:57:00,858 INFO  [Thread-2] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:57:00,858 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:57:00,858 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:00,858 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:57:00,859 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:57:00,859 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-19 16:57:00,860 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:57:10,870 ERROR [Thread-2] root: Error! Connection lost!
2023-03-19 16:57:10,870 INFO  [Thread-2] root: Closing connection
2023-03-19 16:57:47,682 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:57:47,684 INFO  [Thread-0] root: Connected to localhost on port 48580
2023-03-19 16:57:48,610 INFO  [Thread-3] root: Recieved message with raw bytes [B@3ca01cfc
2023-03-19 16:57:48,610 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:57:48,610 INFO  [Thread-3] root: Message: GETthis

2023-03-19 16:57:48,610 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:57:48,610 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:48,610 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:48,610 INFO  [Thread-3] root: false
2023-03-19 16:57:48,610 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:48,610 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:57:48,611 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:57:48,611 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:57:48,612 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:48,613 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:57:48,613 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:57:48,614 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 16:57:48,615 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:57:49,434 INFO  [Thread-3] root: Recieved message with raw bytes [B@3267e518
2023-03-19 16:57:49,434 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:57:49,434 INFO  [Thread-3] root: Message: GETthat

2023-03-19 16:57:49,434 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:57:49,434 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:49,434 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:49,434 INFO  [Thread-3] root: false
2023-03-19 16:57:49,434 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:49,434 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:57:49,435 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:57:49,435 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:57:49,436 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:49,437 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:57:49,437 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:57:49,437 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:57:49,438 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:57:51,687 INFO  [Thread-3] root: Recieved message with raw bytes [B@3658778c
2023-03-19 16:57:51,687 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 16:57:51,687 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-19 16:57:51,688 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 16:57:51,688 INFO  [Thread-3] root: Sending keyrange according to metadata
2023-03-19 16:57:51,688 INFO  [Thread-3] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 16:57:51,688 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 16:57:53,031 INFO  [Thread-3] root: Recieved message with raw bytes [B@735aef23
2023-03-19 16:57:53,031 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 16:57:53,031 INFO  [Thread-3] root: Message: GETthis

2023-03-19 16:57:53,031 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 16:57:53,032 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:53,032 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:53,032 INFO  [Thread-3] root: false
2023-03-19 16:57:53,032 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:53,032 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:57:53,032 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 16:57:53,033 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:57:53,033 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:53,034 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:57:53,034 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:57:53,035 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 16:57:53,035 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 16:57:53,784 INFO  [Thread-3] root: Recieved message with raw bytes [B@4f214a48
2023-03-19 16:57:53,784 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:57:53,785 INFO  [Thread-3] root: Message: GETthat

2023-03-19 16:57:53,785 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:57:53,785 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:53,785 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:57:53,785 INFO  [Thread-3] root: false
2023-03-19 16:57:53,785 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:53,785 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:57:53,785 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:57:53,786 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:57:53,786 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:57:53,787 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:57:53,788 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:57:53,788 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:57:53,789 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:58:02,752 INFO  [Thread-3] root: Recieved message with raw bytes [B@42e33991
2023-03-19 16:58:02,752 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 115, 105, 31, 31, 10]
2023-03-19 16:58:02,752 INFO  [Thread-3] root: Message: GETthsi

2023-03-19 16:58:02,752 INFO  [Thread-3] root: Received a message of type 'GET' with key 'thsi' and value ''
2023-03-19 16:58:02,752 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:58:02,752 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:58:02,752 INFO  [Thread-3] root: false
2023-03-19 16:58:02,752 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:58:02,752 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:58:02,753 INFO  [Thread-3] root: THE KEY IS: c274c16c926266162ccb0865585b8750
2023-03-19 16:58:02,754 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:58:02,754 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:58:02,755 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:58:02,756 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:58:02,756 ERROR [Thread-3] root: Key 'thsi' is not in the database
2023-03-19 16:58:02,756 INFO  [Thread-3] root: MESSAGE TO SEND: 
2023-03-19 16:58:02,756 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'thsi' and value ''
2023-03-19 16:58:03,807 INFO  [Thread-3] root: Recieved message with raw bytes [B@3772c256
2023-03-19 16:58:03,807 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 16:58:03,807 INFO  [Thread-3] root: Message: GETthat

2023-03-19 16:58:03,808 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 16:58:03,808 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:58:03,808 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:58:03,808 INFO  [Thread-3] root: false
2023-03-19 16:58:03,808 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:58:03,808 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:58:03,809 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 16:58:03,809 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:58:03,809 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:58:03,809 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 16:58:03,809 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 16:58:03,809 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 16:58:03,810 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 16:58:06,317 INFO  [Thread-3] root: Recieved message with raw bytes [B@1375106c
2023-03-19 16:58:06,317 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 107, 101, 121, 114, 97, 110, 103, 101, 31, 31, 10]
2023-03-19 16:58:06,317 INFO  [Thread-3] root: Message: GETkeyrange

2023-03-19 16:58:06,317 INFO  [Thread-3] root: Received a message of type 'GET' with key 'keyrange' and value ''
2023-03-19 16:58:06,317 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:58:06,317 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 16:58:06,317 INFO  [Thread-3] root: false
2023-03-19 16:58:06,317 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:58:06,317 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 16:58:06,317 INFO  [Thread-3] root: THE KEY IS: e2a836462887645ec3c6f4c0dd01ae66
2023-03-19 16:58:06,318 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 16:58:06,318 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 16:58:06,319 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 16:58:06,320 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 16:58:06,320 ERROR [Thread-3] root: Key 'keyrange' is not in the database
2023-03-19 16:58:06,321 INFO  [Thread-3] root: MESSAGE TO SEND: 
2023-03-19 16:58:06,321 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'keyrange' and value ''
2023-03-19 16:58:16,332 ERROR [Thread-3] root: Error! Connection lost!
2023-03-19 16:58:16,332 INFO  [Thread-3] root: Closing connection
2023-03-19 16:58:20,888 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 16:58:20,889 INFO  [Thread-0] root: Connected to localhost on port 47578
2023-03-19 16:58:30,890 ERROR [Thread-4] root: Error! Connection lost!
2023-03-19 16:58:30,891 INFO  [Thread-4] root: Closing connection
2023-03-19 17:01:47,080 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 17:01:47,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 17:01:47,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 17:01:47,082 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 17:01:47,083 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 17:01:47,083 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 17:01:47,084 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 17:01:47,084 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 17:01:47,085 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 17:01:47,085 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 17:01:47,086 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 17:01:47,086 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 17:01:47,087 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 17:01:47,087 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 17:01:47,088 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 17:01:47,089 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 17:01:47,099 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 17:01:47,104 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 17:01:47,109 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b002e, negotiated timeout = 40000
2023-03-19 17:01:47,110 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 17:01:47,111 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 17:01:47,111 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 17:01:47,113 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b002f, negotiated timeout = 40000
2023-03-19 17:01:47,120 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 17:01:47,122 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 17:01:47,129 INFO  [Thread-0] root: Initialize server ...
2023-03-19 17:01:47,130 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 17:01:47,138 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 17:01:47,139 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 17:01:47,140 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:01:47,141 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 17:01:47,141 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 17:01:57,226 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 17:01:57,227 INFO  [Thread-0] root: Connected to localhost on port 40654
2023-03-19 17:02:07,234 ERROR [Thread-2] root: Error! Connection lost!
java.net.SocketTimeoutException: Read timed out
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:200)
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:60)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:02:07,234 INFO  [Thread-2] root: Closing connection
2023-03-19 17:02:11,408 INFO  [Thread-0] root: Socket timeout: 10000
2023-03-19 17:02:11,409 INFO  [Thread-0] root: Connected to localhost on port 55572
2023-03-19 17:02:12,655 INFO  [Thread-3] root: Recieved message with raw bytes [B@4359caf4
2023-03-19 17:02:12,656 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:02:12,656 INFO  [Thread-3] root: Message: GETthis

2023-03-19 17:02:12,656 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:02:12,657 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:02:12,657 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:02:12,658 INFO  [Thread-3] root: false
2023-03-19 17:02:12,659 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:02:12,660 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:02:12,661 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:02:12,661 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:02:12,661 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:02:12,662 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:02:12,663 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:02:12,663 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 17:02:12,664 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:02:22,674 ERROR [Thread-3] root: Error! Connection lost!
java.net.SocketTimeoutException: Read timed out
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:200)
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:60)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:02:22,675 INFO  [Thread-3] root: Closing connection
2023-03-19 17:03:14,246 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 17:03:14,247 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 17:03:14,247 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 17:03:14,247 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 17:03:14,248 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 17:03:14,248 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 17:03:14,249 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 17:03:14,249 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 17:03:14,250 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 17:03:14,250 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 17:03:14,251 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 17:03:14,251 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 17:03:14,252 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 17:03:14,253 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 17:03:14,253 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 17:03:14,254 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 17:03:14,265 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 17:03:14,270 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 17:03:14,275 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0032, negotiated timeout = 40000
2023-03-19 17:03:14,277 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 17:03:14,277 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 17:03:14,278 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 17:03:14,279 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0033, negotiated timeout = 40000
2023-03-19 17:03:14,286 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 17:03:14,288 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 17:03:14,295 INFO  [Thread-0] root: Initialize server ...
2023-03-19 17:03:14,296 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 17:03:14,303 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 17:03:14,304 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 17:03:14,305 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:14,305 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 17:03:14,306 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 17:03:23,868 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:03:23,870 INFO  [Thread-0] root: Connected to localhost on port 57088
2023-03-19 17:03:31,168 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:03:31,169 INFO  [Thread-0] root: Connected to localhost on port 57098
2023-03-19 17:03:32,046 INFO  [Thread-3] root: Recieved message with raw bytes [B@7e6e446c
2023-03-19 17:03:32,047 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:03:32,047 INFO  [Thread-3] root: Message: GETthis

2023-03-19 17:03:32,047 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:03:32,048 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:32,048 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:32,049 INFO  [Thread-3] root: false
2023-03-19 17:03:32,050 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:32,051 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:32,052 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:03:32,052 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:32,052 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:32,052 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:32,053 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:32,054 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 17:03:32,054 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:03:33,569 INFO  [Thread-3] root: Recieved message with raw bytes [B@59da0f80
2023-03-19 17:03:33,569 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 17:03:33,570 INFO  [Thread-3] root: Message: GETthat

2023-03-19 17:03:33,570 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 17:03:33,571 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:33,571 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:33,571 INFO  [Thread-3] root: false
2023-03-19 17:03:33,571 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:33,571 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:33,572 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 17:03:33,572 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:33,573 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:33,573 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 17:03:33,574 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 17:03:33,574 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 17:03:33,574 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:03:36,399 INFO  [Thread-2] root: Recieved message with raw bytes [B@6a67838e
2023-03-19 17:03:36,399 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:03:36,399 INFO  [Thread-2] root: Message: GETthis

2023-03-19 17:03:36,399 INFO  [Thread-2] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:03:36,399 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:36,399 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:36,399 INFO  [Thread-2] root: false
2023-03-19 17:03:36,399 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:36,399 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:36,400 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:03:36,400 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:36,400 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:36,400 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:36,401 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:36,401 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-19 17:03:36,402 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:03:37,710 INFO  [Thread-2] root: Recieved message with raw bytes [B@64a070b2
2023-03-19 17:03:37,710 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 17:03:37,710 INFO  [Thread-2] root: Message: GETthat

2023-03-19 17:03:37,710 INFO  [Thread-2] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 17:03:37,710 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:37,710 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:37,710 INFO  [Thread-2] root: false
2023-03-19 17:03:37,710 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:37,710 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:37,711 INFO  [Thread-2] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 17:03:37,711 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:37,711 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:37,711 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 17:03:37,711 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 17:03:37,711 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-19 17:03:37,711 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:03:39,463 INFO  [Thread-2] root: Recieved message with raw bytes [B@609fe8fe
2023-03-19 17:03:39,463 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:03:39,463 INFO  [Thread-2] root: Message: GETfuck

2023-03-19 17:03:39,463 INFO  [Thread-2] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:03:39,463 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:39,463 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:39,463 INFO  [Thread-2] root: false
2023-03-19 17:03:39,463 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:39,463 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:39,463 INFO  [Thread-2] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:03:39,464 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:39,464 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:39,465 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:39,466 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:39,466 ERROR [Thread-2] root: Key 'fuck' is not in the database
2023-03-19 17:03:39,467 INFO  [Thread-2] root: MESSAGE TO SEND: 
2023-03-19 17:03:39,468 INFO  [Thread-2] root: Sent a message of type 'GET_ERROR' with key 'fuck' and value ''
2023-03-19 17:03:41,387 INFO  [Thread-2] root: Recieved message with raw bytes [B@259d7a89
2023-03-19 17:03:41,388 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-19 17:03:41,388 INFO  [Thread-2] root: Message: PUTfuckthis

2023-03-19 17:03:41,388 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'fuck' and value 'this'
2023-03-19 17:03:41,388 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:41,388 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:41,388 INFO  [Thread-2] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:03:41,389 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:41,389 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:41,390 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:41,391 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:41,391 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:41,392 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:41,393 INFO  [Thread-2] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:03:41,393 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:41,394 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:41,395 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:41,395 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:41,401 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-19 17:03:41,401 INFO  [Thread-2] root: MESSAGE TO SEND: this
2023-03-19 17:03:41,402 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:03:42,897 INFO  [Thread-2] root: Recieved message with raw bytes [B@24aac53b
2023-03-19 17:03:42,897 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:03:42,897 INFO  [Thread-2] root: Message: GETfuck

2023-03-19 17:03:42,897 INFO  [Thread-2] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:03:42,897 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:42,897 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:42,898 INFO  [Thread-2] root: false
2023-03-19 17:03:42,898 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:42,898 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:42,898 INFO  [Thread-2] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:03:42,899 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:03:42,899 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:42,900 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:42,900 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:42,901 INFO  [Thread-2] root: MESSAGE TO SEND: this
2023-03-19 17:03:42,902 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:03:45,857 INFO  [Thread-2] root: Recieved message with raw bytes [B@287d7eb7
2023-03-19 17:03:45,857 INFO  [Thread-2] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 17:03:45,858 INFO  [Thread-2] root: Message: KEYRANGE

2023-03-19 17:03:45,859 INFO  [Thread-2] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 17:03:45,859 INFO  [Thread-2] root: Sending keyrange according to metadata
2023-03-19 17:03:45,859 INFO  [Thread-2] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 17:03:45,859 INFO  [Thread-2] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 17:03:48,872 INFO  [Thread-3] root: Recieved message with raw bytes [B@5ca0c412
2023-03-19 17:03:48,872 INFO  [Thread-3] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-19 17:03:48,872 INFO  [Thread-3] root: Message: KEYRANGE

2023-03-19 17:03:48,872 INFO  [Thread-3] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-19 17:03:48,872 INFO  [Thread-3] root: Sending keyrange according to metadata
2023-03-19 17:03:48,872 INFO  [Thread-3] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-19 17:03:48,872 INFO  [Thread-3] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-19 17:03:52,391 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 17:03:52,391 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 17:03:52,392 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 17:03:52,392 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 17:03:52,393 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 17:03:52,394 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 17:03:52,394 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 17:03:52,395 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 17:03:52,395 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 17:03:52,396 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 17:03:52,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 17:03:52,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 17:03:52,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 17:03:52,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 17:03:52,399 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m2
2023-03-19 17:03:52,400 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 17:03:52,412 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 17:03:52,417 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 17:03:52,422 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0034, negotiated timeout = 40000
2023-03-19 17:03:52,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 17:03:52,424 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 17:03:52,424 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 17:03:52,426 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0035, negotiated timeout = 40000
2023-03-19 17:03:52,434 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 17:03:52,437 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:571)
2023-03-19 17:03:52,442 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 17:03:52,444 INFO  [Thread-0] root: Initialize server ...
2023-03-19 17:03:52,445 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-19 17:03:52,446 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 17:03:52,447 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 17:03:52,447 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 17:03:52,448 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 17:03:52,449 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:52,449 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-19 17:03:52,449 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:52,449 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 17:03:52,449 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 17:03:52,450 INFO  [main-EventThread] root: Checking key key: that
2023-03-19 17:03:52,451 INFO  [main-EventThread] root: Transferring key: that
2023-03-19 17:03:52,451 INFO  [main-EventThread] root: Checking key key: fuck
2023-03-19 17:03:52,452 INFO  [main-EventThread] root: Transferring key: fuck
2023-03-19 17:03:52,452 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 17:03:52,453 INFO  [main-EventThread] root: Transferring key: this
2023-03-19 17:03:52,453 INFO  [main-EventThread] root: Checking key key: hello
2023-03-19 17:03:52,454 INFO  [main-EventThread] root: Transferring key: hello
2023-03-19 17:03:52,456 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 17:03:52,456 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:03:52,456 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 17:03:52,457 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'that' and value 'there'
2023-03-19 17:03:52,457 INFO  [Thread-2] root: Recieved message with raw bytes [B@21e4b70f
2023-03-19 17:03:52,458 INFO  [Thread-0] root: Connected to localhost on port 54408
2023-03-19 17:03:52,458 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 97, 116, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:03:52,459 INFO  [Thread-2] root: Message: DATATRANSFERthatthere

2023-03-19 17:03:52,460 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'that' and value 'there'
2023-03-19 17:03:52,465 INFO  [Thread-2] root: Added key 'that' and value 'there' to the database
2023-03-19 17:03:52,466 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-19 17:03:52,466 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3607e23f
2023-03-19 17:03:52,466 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 97, 116, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:03:52,466 INFO  [main-EventThread] root: Message: PUT_SUCCESSthatthere

2023-03-19 17:03:52,466 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:03:52,466 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:03:52,467 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-19 17:03:52,467 INFO  [Thread-2] root: Recieved message with raw bytes [B@2722e6c9
2023-03-19 17:03:52,468 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-19 17:03:52,469 INFO  [Thread-2] root: Message: DATATRANSFERfuckthis

2023-03-19 17:03:52,469 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'fuck' and value 'this'
2023-03-19 17:03:52,471 INFO  [Thread-2] root: Added key 'fuck' and value 'this' to the database
2023-03-19 17:03:52,471 INFO  [Thread-2] root: MESSAGE TO SEND: this
2023-03-19 17:03:52,471 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:03:52,471 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5c2f5111
2023-03-19 17:03:52,471 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 117, 99, 107, 31, 116, 104, 105, 115, 31, 10]
2023-03-19 17:03:52,471 INFO  [main-EventThread] root: Message: PUT_SUCCESSfuckthis

2023-03-19 17:03:52,471 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:03:52,471 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 17:03:52,471 INFO  [Thread-2] root: Recieved message with raw bytes [B@7df6fbc5
2023-03-19 17:03:52,473 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 17:03:52,473 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-19 17:03:52,474 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 17:03:52,475 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-19 17:03:52,475 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-19 17:03:52,475 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:03:52,475 INFO  [main-EventThread] root: Recieved message with raw bytes [B@59a839c
2023-03-19 17:03:52,477 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 17:03:52,477 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-19 17:03:52,478 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:03:52,478 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hello' and value 'there'
2023-03-19 17:03:52,478 INFO  [Thread-2] root: Recieved message with raw bytes [B@7448cd37
2023-03-19 17:03:52,479 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:03:52,480 INFO  [Thread-2] root: Message: DATATRANSFERhellothere

2023-03-19 17:03:52,480 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'hello' and value 'there'
2023-03-19 17:03:52,482 INFO  [Thread-2] root: Added key 'hello' and value 'there' to the database
2023-03-19 17:03:52,482 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-19 17:03:52,482 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 17:03:52,482 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3a1eb0c3
2023-03-19 17:03:52,482 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:03:52,482 INFO  [main-EventThread] root: Message: PUT_SUCCESShellothere

2023-03-19 17:03:52,482 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 17:03:52,482 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 17:03:52,482 INFO  [main-EventThread] root: Closing connection
2023-03-19 17:03:52,483 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:03:52,483 INFO  [Thread-2] root: Closing connection
2023-03-19 17:03:52,484 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 17:03:56,838 INFO  [Thread-2] root: Recieved message with raw bytes [B@755558a
2023-03-19 17:03:56,838 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:03:56,838 INFO  [Thread-2] root: Message: GETthis

2023-03-19 17:03:56,838 INFO  [Thread-2] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:03:56,838 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:56,838 INFO  [Thread-2] root: SERVER_IDLE
2023-03-19 17:03:56,838 INFO  [Thread-2] root: false
2023-03-19 17:03:56,838 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:56,838 INFO  [Thread-2] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:56,839 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:03:56,839 INFO  [Thread-2] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:56,839 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:56,839 INFO  [Thread-2] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 17:03:56,839 INFO  [Thread-2] root: key.compareTo(hashRange[1] false
2023-03-19 17:03:56,839 INFO  [Thread-2] root: Server cannot service for key 'this'. Sending back metadata
2023-03-19 17:03:56,839 INFO  [Thread-2] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-19 17:03:56,839 INFO  [Thread-2] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-19 17:03:56,848 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:03:56,848 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:03:56,848 INFO  [Thread-2] root: Closing connection
2023-03-19 17:03:56,849 INFO  [Thread-0] root: Connected to localhost on port 54410
2023-03-19 17:03:56,849 INFO  [Thread-3] root: Recieved message with raw bytes [B@2b8daf45
2023-03-19 17:03:56,849 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:03:56,849 INFO  [Thread-3] root: Message: GETthis

2023-03-19 17:03:56,849 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:03:56,849 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:56,849 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:56,849 INFO  [Thread-3] root: false
2023-03-19 17:03:56,850 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:56,850 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:56,851 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:03:56,851 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:56,852 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:56,853 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:56,853 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:56,854 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 17:03:56,854 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:03:57,823 INFO  [Thread-3] root: Recieved message with raw bytes [B@64774e7f
2023-03-19 17:03:57,823 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 97, 116, 31, 31, 10]
2023-03-19 17:03:57,823 INFO  [Thread-3] root: Message: GETthat

2023-03-19 17:03:57,823 INFO  [Thread-3] root: Received a message of type 'GET' with key 'that' and value ''
2023-03-19 17:03:57,823 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:57,823 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:57,823 INFO  [Thread-3] root: false
2023-03-19 17:03:57,823 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:57,823 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:57,823 INFO  [Thread-3] root: THE KEY IS: 21582c6c30be1217322cdb9aebaf4a59
2023-03-19 17:03:57,824 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:57,825 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:57,825 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-19 17:03:57,826 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-19 17:03:57,827 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-19 17:03:57,828 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:03:59,799 INFO  [Thread-3] root: Recieved message with raw bytes [B@22463233
2023-03-19 17:03:59,799 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:03:59,799 INFO  [Thread-3] root: Message: GETfuck

2023-03-19 17:03:59,799 INFO  [Thread-3] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:03:59,799 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:59,799 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:03:59,799 INFO  [Thread-3] root: false
2023-03-19 17:03:59,799 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:59,800 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:03:59,800 INFO  [Thread-3] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:03:59,800 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:03:59,800 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:03:59,800 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:03:59,800 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:03:59,800 INFO  [Thread-3] root: MESSAGE TO SEND: this
2023-03-19 17:03:59,800 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:04:02,523 INFO  [Thread-3] root: Recieved message with raw bytes [B@73eba94
2023-03-19 17:04:02,523 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:04:02,524 INFO  [Thread-3] root: Message: GETfuck

2023-03-19 17:04:02,524 INFO  [Thread-3] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:04:02,524 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:04:02,524 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:04:02,524 INFO  [Thread-3] root: false
2023-03-19 17:04:02,524 INFO  [Thread-3] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:02,524 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:02,524 INFO  [Thread-3] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:04:02,525 INFO  [Thread-3] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:02,525 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:02,526 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 17:04:02,527 INFO  [Thread-3] root: key.compareTo(hashRange[1] false
2023-03-19 17:04:02,528 INFO  [Thread-3] root: Server cannot service for key 'fuck'. Sending back metadata
2023-03-19 17:04:02,528 INFO  [Thread-3] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-19 17:04:02,529 INFO  [Thread-3] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'fuck' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-19 17:04:02,538 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:04:02,538 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:04:02,538 INFO  [Thread-3] root: Closing connection
2023-03-19 17:04:02,539 INFO  [Thread-4] root: Recieved message with raw bytes [B@7fedd162
2023-03-19 17:04:02,539 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:04:02,539 INFO  [Thread-4] root: Message: GETfuck

2023-03-19 17:04:02,539 INFO  [Thread-4] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:04:02,539 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:02,539 INFO  [Thread-0] root: Connected to localhost on port 43304
2023-03-19 17:04:02,539 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:02,540 INFO  [Thread-4] root: false
2023-03-19 17:04:02,540 INFO  [Thread-4] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:02,540 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:02,541 INFO  [Thread-4] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:04:02,541 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:02,541 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:02,541 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:02,541 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:02,541 INFO  [Thread-4] root: MESSAGE TO SEND: this
2023-03-19 17:04:02,541 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:04:03,989 INFO  [Thread-4] root: Recieved message with raw bytes [B@712a30ef
2023-03-19 17:04:03,990 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:04:03,990 INFO  [Thread-4] root: Message: GETthis

2023-03-19 17:04:03,990 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:04:03,990 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:03,990 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:03,990 INFO  [Thread-4] root: false
2023-03-19 17:04:03,990 INFO  [Thread-4] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:03,990 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:03,990 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:04:03,990 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:03,990 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:03,990 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:03,990 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:03,990 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-19 17:04:03,990 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:04:26,854 INFO  [Thread-3] root: Recieved message with raw bytes [B@55592a5b
2023-03-19 17:04:26,855 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:04:26,855 INFO  [Thread-3] root: Message: GETfuck

2023-03-19 17:04:26,855 INFO  [Thread-3] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:04:26,855 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:04:26,855 INFO  [Thread-3] root: SERVER_IDLE
2023-03-19 17:04:26,855 INFO  [Thread-3] root: false
2023-03-19 17:04:26,855 INFO  [Thread-3] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:26,855 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:26,855 INFO  [Thread-3] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:04:26,855 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:26,855 INFO  [Thread-3] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:26,855 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:26,855 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:26,855 INFO  [Thread-3] root: MESSAGE TO SEND: this
2023-03-19 17:04:26,855 INFO  [Thread-3] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:04:30,480 INFO  [Thread-4] root: Recieved message with raw bytes [B@7515ba12
2023-03-19 17:04:30,480 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:04:30,480 INFO  [Thread-4] root: Message: GETfuck

2023-03-19 17:04:30,480 INFO  [Thread-4] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:04:30,480 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:30,480 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:30,480 INFO  [Thread-4] root: false
2023-03-19 17:04:30,480 INFO  [Thread-4] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:30,480 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:30,481 INFO  [Thread-4] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:04:30,482 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:30,482 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:30,483 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:30,483 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:30,483 INFO  [Thread-4] root: MESSAGE TO SEND: this
2023-03-19 17:04:30,483 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:04:43,197 INFO  [Thread-4] root: Recieved message with raw bytes [B@30173ad4
2023-03-19 17:04:43,198 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:04:43,198 INFO  [Thread-4] root: Message: GETthis

2023-03-19 17:04:43,198 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:04:43,198 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:43,198 INFO  [Thread-4] root: SERVER_IDLE
2023-03-19 17:04:43,198 INFO  [Thread-4] root: false
2023-03-19 17:04:43,198 INFO  [Thread-4] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:43,198 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:43,200 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:04:43,200 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:43,200 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 17:04:43,200 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:43,200 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:43,200 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-19 17:04:43,200 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:04:46,545 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-19 17:04:46,546 INFO  [Thread-1] root: Checking key key: that
2023-03-19 17:04:46,546 INFO  [Thread-1] root: Transferring key: that
2023-03-19 17:04:46,547 INFO  [Thread-1] root: Checking key key: fuck
2023-03-19 17:04:46,547 INFO  [Thread-1] root: Checking key key: this
2023-03-19 17:04:46,548 INFO  [Thread-1] root: Checking key key: asdf
2023-03-19 17:04:46,548 INFO  [Thread-1] root: Checking key key: hello
2023-03-19 17:04:46,549 INFO  [Thread-1] root: Transferring key: hello
2023-03-19 17:04:46,550 INFO  [Thread-1] root: Socket timeout: 0
2023-03-19 17:04:46,550 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:04:46,550 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-19 17:04:46,551 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'that' and value 'there'
2023-03-19 17:04:46,551 INFO  [Thread-4] root: Recieved message with raw bytes [B@19bd39f9
2023-03-19 17:04:46,551 INFO  [Thread-0] root: Connected to localhost on port 46254
2023-03-19 17:04:46,552 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 97, 116, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:04:46,553 INFO  [Thread-4] root: Message: DATATRANSFERthatthere

2023-03-19 17:04:46,554 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'that' and value 'there'
2023-03-19 17:04:46,555 INFO  [Thread-4] root: Added key 'that' and value 'there' to the database
2023-03-19 17:04:46,555 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-19 17:04:46,555 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:04:46,555 INFO  [Thread-1] root: Recieved message with raw bytes [B@249d3b41
2023-03-19 17:04:46,555 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 97, 116, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:04:46,555 INFO  [Thread-1] root: Message: PUT_SUCCESSthatthere

2023-03-19 17:04:46,556 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'that' and value 'there'
2023-03-19 17:04:46,556 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'hello' and value 'there'
2023-03-19 17:04:46,556 INFO  [Thread-4] root: Recieved message with raw bytes [B@177ad4be
2023-03-19 17:04:46,556 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:04:46,557 INFO  [Thread-4] root: Message: DATATRANSFERhellothere

2023-03-19 17:04:46,557 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'hello' and value 'there'
2023-03-19 17:04:46,559 INFO  [Thread-4] root: Added key 'hello' and value 'there' to the database
2023-03-19 17:04:46,559 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-19 17:04:46,559 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 17:04:46,559 INFO  [Thread-1] root: Recieved message with raw bytes [B@2a5ad1a2
2023-03-19 17:04:46,559 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 108, 108, 111, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 17:04:46,559 INFO  [Thread-1] root: Message: PUT_SUCCESShellothere

2023-03-19 17:04:46,559 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'hello' and value 'there'
2023-03-19 17:04:46,559 INFO  [Thread-1] root: Client is closing communication!
2023-03-19 17:04:46,559 INFO  [Thread-1] root: Closing connection
2023-03-19 17:04:46,559 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:04:46,560 INFO  [Thread-4] root: Closing connection
2023-03-19 17:04:46,566 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 17:04:46,568 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 17:04:46,569 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 17:04:46,571 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:46,571 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 17:04:49,842 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:04:49,843 INFO  [Thread-0] root: Connected to localhost on port 46264
2023-03-19 17:04:49,843 INFO  [Thread-5] root: Recieved message with raw bytes [B@35d7665b
2023-03-19 17:04:49,844 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:04:49,844 INFO  [Thread-5] root: Message: GETfuck

2023-03-19 17:04:49,844 INFO  [Thread-5] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:04:49,844 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 17:04:49,844 INFO  [Thread-5] root: SERVER_IDLE
2023-03-19 17:04:49,844 INFO  [Thread-5] root: false
2023-03-19 17:04:49,844 INFO  [Thread-5] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:49,844 INFO  [Thread-5] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:49,845 INFO  [Thread-5] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:04:49,845 INFO  [Thread-5] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:04:49,845 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:49,845 INFO  [Thread-5] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:49,845 INFO  [Thread-5] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:49,845 INFO  [Thread-5] root: MESSAGE TO SEND: this
2023-03-19 17:04:49,845 INFO  [Thread-5] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:04:54,867 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 17:04:54,868 INFO  [Thread-0] root: Connected to localhost on port 47258
2023-03-19 17:04:54,868 INFO  [Thread-6] root: Recieved message with raw bytes [B@a636873
2023-03-19 17:04:54,868 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 102, 117, 99, 107, 31, 31, 10]
2023-03-19 17:04:54,868 INFO  [Thread-6] root: Message: GETfuck

2023-03-19 17:04:54,868 INFO  [Thread-6] root: Received a message of type 'GET' with key 'fuck' and value ''
2023-03-19 17:04:54,868 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 17:04:54,868 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 17:04:54,868 INFO  [Thread-6] root: false
2023-03-19 17:04:54,868 INFO  [Thread-6] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:54,868 INFO  [Thread-6] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:54,869 INFO  [Thread-6] root: THE KEY IS: 99754106633f94d350db34d548d6091a
2023-03-19 17:04:54,869 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:04:54,869 INFO  [Thread-6] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:54,869 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:54,869 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:54,869 INFO  [Thread-6] root: MESSAGE TO SEND: this
2023-03-19 17:04:54,869 INFO  [Thread-6] root: Sent a message of type 'GET_SUCCESS' with key 'fuck' and value 'this'
2023-03-19 17:04:56,110 INFO  [Thread-6] root: Recieved message with raw bytes [B@4a4874f
2023-03-19 17:04:56,110 INFO  [Thread-6] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-19 17:04:56,110 INFO  [Thread-6] root: Message: GETthis

2023-03-19 17:04:56,110 INFO  [Thread-6] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-19 17:04:56,110 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 17:04:56,110 INFO  [Thread-6] root: SERVER_IDLE
2023-03-19 17:04:56,110 INFO  [Thread-6] root: false
2023-03-19 17:04:56,110 INFO  [Thread-6] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:56,110 INFO  [Thread-6] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 17:04:56,110 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 17:04:56,110 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 17:04:56,110 INFO  [Thread-6] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 17:04:56,110 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 17:04:56,110 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 17:04:56,110 INFO  [Thread-6] root: MESSAGE TO SEND: that
2023-03-19 17:04:56,110 INFO  [Thread-6] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-19 17:04:57,382 ERROR [Thread-6] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:04:57,383 INFO  [Thread-6] root: Closing connection
2023-03-19 17:04:59,266 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 17:04:59,267 INFO  [Thread-5] root: Closing connection
2023-03-19 23:06:46,538 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 23:06:46,539 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 23:06:46,539 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 23:06:46,540 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 23:06:46,540 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 23:06:46,541 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 23:06:46,541 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 23:06:46,542 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 23:06:46,542 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 23:06:46,543 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 23:06:46,544 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 23:06:46,544 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 23:06:46,545 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 23:06:46,545 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 23:06:46,546 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-19 23:06:46,547 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 23:06:46,560 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:06:46,565 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:06:46,571 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0038, negotiated timeout = 40000
2023-03-19 23:06:46,572 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 23:06:46,573 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:06:46,573 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:06:46,575 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0039, negotiated timeout = 40000
2023-03-19 23:06:46,583 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:06:46,586 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:06:46,594 INFO  [Thread-0] root: Initialize server ...
2023-03-19 23:06:46,595 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 23:06:46,601 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 23:06:46,602 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:06:46,603 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:06:46,603 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 23:06:46,603 ERROR [main-EventThread] org.apache.zookeeper.ClientCnxn: Error while calling watcher 
java.lang.NullPointerException
	at app_kvServer.KVServer.updateMetadataZK(KVServer.java:249)
	at ecs.ECS$4.process(ECS.java:215)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:531)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2023-03-19 23:06:46,604 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:12:19,815 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:12:19,817 INFO  [Thread-0] root: Connected to localhost on port 40062
2023-03-19 23:12:26,040 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 23:12:26,041 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 23:12:26,041 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 23:12:26,042 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 23:12:26,042 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 23:12:26,043 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 23:12:26,044 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 23:12:26,044 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 23:12:26,045 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 23:12:26,045 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 23:12:26,046 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 23:12:26,047 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 23:12:26,047 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 23:12:26,048 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 23:12:26,048 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-19 23:12:26,050 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 23:12:26,061 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:12:26,066 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:12:26,071 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b003a, negotiated timeout = 40000
2023-03-19 23:12:26,073 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 23:12:26,073 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:12:26,074 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:12:26,075 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b003b, negotiated timeout = 40000
2023-03-19 23:12:26,082 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:12:26,084 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:12:26,090 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:12:26,091 INFO  [Thread-0] root: Initialize server ...
2023-03-19 23:12:26,092 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-19 23:12:26,093 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 23:12:26,094 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:12:26,094 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 23:12:26,095 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:12:26,096 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:26,096 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:26,096 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-19 23:12:26,096 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:12:26,096 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:12:26,100 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:12:26,100 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:12:26,100 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:12:26,101 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:12:26,101 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:12:26,102 INFO  [Thread-0] root: Connected to localhost on port 41516
2023-03-19 23:12:26,102 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:12:26,102 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:12:26,104 INFO  [Thread-2] root: Closing connection
2023-03-19 23:12:26,104 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:12:26,104 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:12:26,105 INFO  [Thread-0] root: Connected to localhost on port 41530
2023-03-19 23:12:26,105 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:12:26,106 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:12:26,107 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:12:26,108 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:12:26,108 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8083
2023-03-19 23:12:26,108 INFO  [Thread-3] root: Closing connection
2023-03-19 23:12:26,110 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:12:26,110 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:12:26,110 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:12:26,111 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:12:26,111 INFO  [Thread-0] root: Connected to localhost on port 41542
2023-03-19 23:12:26,112 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:12:26,113 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:12:26,113 INFO  [Thread-4] root: Closing connection
2023-03-19 23:12:26,118 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:12:26,119 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:12:26,119 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:12:26,120 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:12:26,121 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:12:26,121 INFO  [Thread-0] root: Connected to localhost on port 41554
2023-03-19 23:12:26,121 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:12:26,122 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:12:26,123 INFO  [Thread-5] root: Closing connection
2023-03-19 23:12:26,124 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 23:12:32,845 INFO  [Thread-2] root: Recieved message with raw bytes [B@2ff9649d
2023-03-19 23:12:32,846 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 23:12:32,846 INFO  [Thread-2] root: Message: PUTthisthere

2023-03-19 23:12:32,846 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'there'
2023-03-19 23:12:32,847 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:32,848 INFO  [Thread-2] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:32,849 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:12:32,849 INFO  [Thread-2] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:32,850 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:32,851 INFO  [Thread-2] root: key.compareTo(hashRange[0]) > 0: true
2023-03-19 23:12:32,852 INFO  [Thread-2] root: key.compareTo(hashRange[1] false
2023-03-19 23:12:32,852 INFO  [Thread-2] root: Server cannot service for key 'this'. Sending back metadata
2023-03-19 23:12:32,853 INFO  [Thread-2] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-19 23:12:32,854 INFO  [Thread-2] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-19 23:12:32,863 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:12:32,863 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:12:32,864 INFO  [Thread-2] root: Closing connection
2023-03-19 23:12:32,864 INFO  [Thread-6] root: Recieved message with raw bytes [B@7cf8f7f
2023-03-19 23:12:32,864 INFO  [Thread-0] root: Connected to localhost on port 51098
2023-03-19 23:12:32,865 INFO  [Thread-6] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-19 23:12:32,865 INFO  [Thread-6] root: Message: PUTthisthere

2023-03-19 23:12:32,865 INFO  [Thread-6] root: Received a message of type 'PUT' with key 'this' and value 'there'
2023-03-19 23:12:32,866 INFO  [Thread-6] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:32,866 INFO  [Thread-6] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:32,868 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:12:32,868 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:32,868 INFO  [Thread-6] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:32,868 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:12:32,868 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:12:32,869 INFO  [Thread-6] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:32,869 INFO  [Thread-6] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:32,871 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:12:32,871 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:32,872 INFO  [Thread-6] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:32,872 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:12:32,873 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:12:32,875 INFO  [Thread-6] root: Added key 'this' and value 'there' to the database
2023-03-19 23:12:32,875 INFO  [Thread-6] root: MESSAGE TO SEND: there
2023-03-19 23:12:32,875 INFO  [Thread-6] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-19 23:12:37,732 INFO  [Thread-6] root: Recieved message with raw bytes [B@5096782d
2023-03-19 23:12:37,732 INFO  [Thread-6] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:12:37,732 INFO  [Thread-6] root: Message: PUTthisthat

2023-03-19 23:12:37,732 INFO  [Thread-6] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-19 23:12:37,732 INFO  [Thread-6] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:37,732 INFO  [Thread-6] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:37,733 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:12:37,734 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:37,734 INFO  [Thread-6] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:37,735 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:12:37,735 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:12:37,736 INFO  [Thread-6] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:37,736 INFO  [Thread-6] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:37,737 INFO  [Thread-6] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:12:37,738 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:37,738 INFO  [Thread-6] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:37,739 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:12:37,739 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:12:37,741 INFO  [Thread-6] root: Updated value associated with key 'this' to 'that'
2023-03-19 23:12:37,741 INFO  [Thread-6] root: MESSAGE TO SEND: that
2023-03-19 23:12:37,741 INFO  [Thread-6] root: Sent a message of type 'PUT_UPDATE' with key 'this' and value 'that'
2023-03-19 23:12:46,781 INFO  [Thread-6] root: Recieved message with raw bytes [B@2c54d829
2023-03-19 23:12:46,781 INFO  [Thread-6] root: Raw bytes: [80, 85, 84, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-19 23:12:46,782 INFO  [Thread-6] root: Message: PUTfoobar

2023-03-19 23:12:46,782 INFO  [Thread-6] root: Received a message of type 'PUT' with key 'foo' and value 'bar'
2023-03-19 23:12:46,782 INFO  [Thread-6] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:46,782 INFO  [Thread-6] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:46,782 INFO  [Thread-6] root: THE KEY IS: acbd18db4cc2f85cedef654fccc4a4d8
2023-03-19 23:12:46,782 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:46,782 INFO  [Thread-6] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:46,782 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:12:46,782 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:12:46,782 INFO  [Thread-6] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:46,782 INFO  [Thread-6] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:12:46,783 INFO  [Thread-6] root: THE KEY IS: acbd18db4cc2f85cedef654fccc4a4d8
2023-03-19 23:12:46,783 INFO  [Thread-6] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:12:46,784 INFO  [Thread-6] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:12:46,784 INFO  [Thread-6] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:12:46,785 INFO  [Thread-6] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:12:46,786 INFO  [Thread-6] root: Added key 'foo' and value 'bar' to the database
2023-03-19 23:12:46,786 INFO  [Thread-6] root: MESSAGE TO SEND: bar
2023-03-19 23:12:46,786 INFO  [Thread-6] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-19 23:13:05,591 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 23:13:05,591 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 23:13:05,592 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 23:13:05,592 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 23:13:05,593 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 23:13:05,593 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 23:13:05,594 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 23:13:05,594 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 23:13:05,595 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 23:13:05,596 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 23:13:05,596 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 23:13:05,597 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 23:13:05,597 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 23:13:05,598 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 23:13:05,598 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-19 23:13:05,599 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 23:13:05,609 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:13:05,615 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:13:05,621 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b003c, negotiated timeout = 40000
2023-03-19 23:13:05,622 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 23:13:05,623 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:13:05,623 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:13:05,625 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b003d, negotiated timeout = 40000
2023-03-19 23:13:05,631 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:13:05,633 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:13:05,639 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 23:13:05,640 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:13:05,642 INFO  [Thread-0] root: Initialize server ...
2023-03-19 23:13:05,643 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-19 23:13:05,644 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 23:13:05,645 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:13:05,646 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-19 23:13:05,646 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 23:13:05,646 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:13:05,647 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:13:05,647 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:13:05,648 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 23:13:05,649 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:13:05,650 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:13:05,650 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:13:05,651 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-19 23:13:05,651 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-19 23:13:05,655 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:13:05,655 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:13:05,655 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-19 23:13:05,656 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:13:05,656 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:13:05,657 INFO  [Thread-0] root: Connected to localhost on port 41264
2023-03-19 23:13:05,657 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-19 23:13:05,657 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:13:05,658 INFO  [main-EventThread] root: Checking key key: foo
2023-03-19 23:13:05,658 INFO  [Thread-2] root: Closing connection
2023-03-19 23:13:05,660 INFO  [main-EventThread] root: Transferring key: foo
2023-03-19 23:13:05,660 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 23:13:05,661 INFO  [main-EventThread] root: Transferring key: this
2023-03-19 23:13:05,661 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:13:05,661 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:13:05,662 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-19 23:13:05,663 INFO  [Thread-0] root: Connected to localhost on port 41270
2023-03-19 23:13:05,663 INFO  [Thread-3] root: Recieved message with raw bytes [B@4da60907
2023-03-19 23:13:05,664 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-19 23:13:05,664 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-19 23:13:05,665 INFO  [Thread-3] root: Message: DATATRANSFERfoobar

2023-03-19 23:13:05,666 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-19 23:13:05,672 INFO  [Thread-3] root: Added key 'foo' and value 'bar' to the database
2023-03-19 23:13:05,672 INFO  [Thread-3] root: MESSAGE TO SEND: bar
2023-03-19 23:13:05,672 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-19 23:13:05,672 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2190c707
2023-03-19 23:13:05,672 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-19 23:13:05,672 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-19 23:13:05,673 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-19 23:13:05,673 INFO  [Thread-3] root: Recieved message with raw bytes [B@27d61b30
2023-03-19 23:13:05,673 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:13:05,674 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:13:05,675 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-19 23:13:05,676 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:13:05,677 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-19 23:13:05,677 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-19 23:13:05,677 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:13:05,677 INFO  [main-EventThread] root: Recieved message with raw bytes [B@58b05a08
2023-03-19 23:13:05,678 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:13:05,678 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-19 23:13:05,678 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:13:05,679 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:13:05,679 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:13:05,680 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:13:05,680 INFO  [Thread-3] root: Closing connection
2023-03-19 23:13:05,680 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-19 23:13:05,682 INFO  [main-EventThread] root: Checking key key: foo
2023-03-19 23:13:05,683 INFO  [main-EventThread] root: Transferring key: foo
2023-03-19 23:13:05,683 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 23:13:05,685 INFO  [main-EventThread] root: Transferring key: this
2023-03-19 23:13:05,686 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:13:05,686 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:13:05,687 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-19 23:13:05,688 INFO  [Thread-0] root: Connected to localhost on port 41282
2023-03-19 23:13:05,688 INFO  [Thread-4] root: Recieved message with raw bytes [B@5ba3234c
2023-03-19 23:13:05,688 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-19 23:13:05,689 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-19 23:13:05,690 INFO  [Thread-4] root: Message: DATATRANSFERfoobar

2023-03-19 23:13:05,691 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-19 23:13:05,693 INFO  [Thread-4] root: Added key 'foo' and value 'bar' to the database
2023-03-19 23:13:05,693 INFO  [Thread-4] root: MESSAGE TO SEND: bar
2023-03-19 23:13:05,693 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-19 23:13:05,693 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6aa703a0
2023-03-19 23:13:05,693 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-19 23:13:05,693 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-19 23:13:05,693 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-19 23:13:05,693 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:13:05,693 INFO  [Thread-4] root: Recieved message with raw bytes [B@5564c648
2023-03-19 23:13:05,695 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:13:05,695 INFO  [Thread-4] root: Message: DATATRANSFERthisthat

2023-03-19 23:13:05,696 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:13:05,698 INFO  [Thread-4] root: Added key 'this' and value 'that' to the database
2023-03-19 23:13:05,698 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-19 23:13:05,698 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:13:05,698 INFO  [main-EventThread] root: Recieved message with raw bytes [B@779248ca
2023-03-19 23:13:05,698 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:13:05,698 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-19 23:13:05,698 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:13:05,698 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:13:05,698 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:13:05,698 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:13:05,699 INFO  [Thread-4] root: Closing connection
2023-03-19 23:13:05,700 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-19 23:13:05,700 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:13:05,700 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:13:05,701 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-19 23:13:05,702 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:13:05,702 INFO  [Thread-0] root: Connected to localhost on port 41288
2023-03-19 23:13:05,703 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:13:05,704 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:13:05,704 INFO  [Thread-5] root: Closing connection
2023-03-19 23:13:05,705 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-19 23:14:22,998 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-19 23:14:23,000 INFO  [Thread-1] root: Socket timeout: 0
2023-03-19 23:14:23,000 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:14:23,000 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8084
2023-03-19 23:14:23,001 INFO  [Thread-1] root: Client is closing communication!
2023-03-19 23:14:23,001 INFO  [Thread-1] root: Closing connection
2023-03-19 23:14:23,002 ERROR [Thread-6] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:14:23,002 INFO  [Thread-0] root: Connected to localhost on port 57278
2023-03-19 23:14:23,002 INFO  [Thread-6] root: Closing connection
2023-03-19 23:14:23,009 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:14:23,010 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-19 23:14:23,015 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 23:14:23,016 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,d41d8cd98f00b204e9800998ecf8427e,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:14:23,017 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-19 23:14:23,017 INFO  [main-EventThread] root: d41d8cd98f00b204e9800998ecf8427e:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:14:23,018 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:14:24,912 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:14:24,915 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:14:24,926 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-19 23:14:24,929 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-19 23:14:25,558 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-19 23:14:25,559 INFO  [Thread-1] root: Checking key key: foo
2023-03-19 23:14:25,559 INFO  [Thread-1] root: Checking key key: this
2023-03-19 23:14:25,560 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:14:50,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 23:14:50,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 23:14:50,433 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 23:14:50,434 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 23:14:50,434 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 23:14:50,435 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 23:14:50,436 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 23:14:50,436 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 23:14:50,437 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 23:14:50,437 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 23:14:50,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 23:14:50,439 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 23:14:50,439 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 23:14:50,440 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 23:14:50,440 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-19 23:14:50,441 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 23:14:50,456 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:14:50,461 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:14:50,467 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0040, negotiated timeout = 40000
2023-03-19 23:14:50,469 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 23:14:50,469 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:14:50,470 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:14:50,472 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0041, negotiated timeout = 40000
2023-03-19 23:14:50,480 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:14:50,483 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:14:50,490 INFO  [Thread-0] root: Initialize server ...
2023-03-19 23:14:50,491 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-19 23:14:50,499 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 23:14:50,499 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:14:50,500 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:14:50,501 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-19 23:14:50,501 ERROR [main-EventThread] org.apache.zookeeper.ClientCnxn: Error while calling watcher 
java.lang.NullPointerException
	at app_kvServer.KVServer.updateMetadataZK(KVServer.java:249)
	at ecs.ECS$4.process(ECS.java:215)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:531)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2023-03-19 23:14:50,502 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:15:03,282 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:15:03,284 INFO  [Thread-0] root: Connected to localhost on port 46426
2023-03-19 23:15:27,537 INFO  [Thread-2] root: Recieved message with raw bytes [B@7e6e446c
2023-03-19 23:15:27,538 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:15:27,539 INFO  [Thread-2] root: Message: PUTthisthat

2023-03-19 23:15:27,539 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-19 23:15:27,540 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:15:27,540 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:15:27,541 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:15:27,541 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 23:15:27,542 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:15:27,543 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:15:27,543 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:15:27,544 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:15:27,544 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-19 23:15:27,545 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-19 23:15:27,545 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-19 23:15:27,546 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-19 23:15:27,546 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-19 23:15:27,547 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-19 23:15:27,551 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-19 23:15:27,551 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-19 23:15:27,551 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:15:39,297 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-19 23:15:39,297 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-19 23:15:39,297 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-19 23:15:39,298 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-19 23:15:39,299 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-19 23:15:39,299 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-19 23:15:39,300 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-19 23:15:39,301 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-19 23:15:39,301 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-19 23:15:39,302 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-19 23:15:39,302 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-19 23:15:39,303 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-19 23:15:39,304 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-19 23:15:39,304 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-19 23:15:39,305 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-19 23:15:39,306 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-19 23:15:39,316 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:15:39,321 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:15:39,326 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0042, negotiated timeout = 40000
2023-03-19 23:15:39,328 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-19 23:15:39,328 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-19 23:15:39,329 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-19 23:15:39,330 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0043, negotiated timeout = 40000
2023-03-19 23:15:39,337 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:15:39,339 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-19 23:15:39,343 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:15:39,345 INFO  [Thread-0] root: Initialize server ...
2023-03-19 23:15:39,347 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-19 23:15:39,348 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-19 23:15:39,348 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:15:39,348 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-19 23:15:39,349 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-19 23:15:39,350 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:15:39,350 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-19 23:15:39,351 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-19 23:15:39,351 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:15:39,351 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-19 23:15:39,352 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 23:15:39,352 INFO  [main-EventThread] root: Transferring key: this
2023-03-19 23:15:39,355 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:15:39,355 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:15:39,355 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:15:39,356 INFO  [Thread-2] root: Recieved message with raw bytes [B@37090b04
2023-03-19 23:15:39,356 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:15:39,357 INFO  [Thread-0] root: Connected to localhost on port 35054
2023-03-19 23:15:39,356 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:15:39,358 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-19 23:15:39,359 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:15:39,364 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-19 23:15:39,364 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-19 23:15:39,364 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:15:39,364 INFO  [main-EventThread] root: Recieved message with raw bytes [B@492c18f
2023-03-19 23:15:39,365 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:15:39,365 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-19 23:15:39,365 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:15:39,365 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:15:39,366 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:15:39,367 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:15:39,367 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:15:39,367 INFO  [Thread-2] root: Closing connection
2023-03-19 23:15:39,368 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 23:15:39,370 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:15:39,370 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:15:39,370 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:15:39,371 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:15:39,371 INFO  [Thread-0] root: Connected to localhost on port 35062
2023-03-19 23:15:39,372 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:15:39,373 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:15:39,373 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8083
2023-03-19 23:15:39,373 INFO  [Thread-3] root: Closing connection
2023-03-19 23:15:39,374 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 23:15:39,375 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:15:39,375 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:15:39,375 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:15:39,376 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:15:39,376 INFO  [Thread-0] root: Connected to localhost on port 35064
2023-03-19 23:15:39,377 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:15:39,378 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:15:39,379 INFO  [Thread-4] root: Closing connection
2023-03-19 23:15:39,379 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:15:39,380 INFO  [main-EventThread] root: Checking key key: this
2023-03-19 23:15:39,380 INFO  [main-EventThread] root: Transferring key: this
2023-03-19 23:15:39,381 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-19 23:15:39,381 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:15:39,381 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-19 23:15:39,383 INFO  [Thread-0] root: Connected to localhost on port 35078
2023-03-19 23:15:39,383 INFO  [Thread-5] root: Recieved message with raw bytes [B@3e8984a4
2023-03-19 23:15:39,383 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:15:39,384 INFO  [Thread-5] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:15:39,385 INFO  [Thread-5] root: Message: DATATRANSFERthisthat

2023-03-19 23:15:39,386 INFO  [Thread-5] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-19 23:15:39,387 INFO  [Thread-5] root: Added key 'this' and value 'that' to the database
2023-03-19 23:15:39,387 INFO  [Thread-5] root: MESSAGE TO SEND: that
2023-03-19 23:15:39,387 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:15:39,387 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3d6af44a
2023-03-19 23:15:39,387 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-19 23:15:39,387 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-19 23:15:39,388 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-19 23:15:39,388 INFO  [main-EventThread] root: Client is closing communication!
2023-03-19 23:15:39,389 INFO  [main-EventThread] root: Closing connection
2023-03-19 23:15:39,390 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:15:39,390 INFO  [Thread-5] root: Closing connection
2023-03-19 23:15:39,391 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-19 23:19:46,949 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-19 23:19:46,951 INFO  [Thread-1] root: Checking key key: this
2023-03-19 23:19:46,952 INFO  [Thread-1] root: Socket timeout: 0
2023-03-19 23:19:46,952 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-19 23:19:46,952 INFO  [Thread-0] root: Socket timeout: 0
2023-03-19 23:19:46,953 INFO  [Thread-1] root: Client is closing communication!
2023-03-19 23:19:46,953 INFO  [Thread-1] root: Closing connection
2023-03-19 23:19:46,954 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-19 23:19:46,955 INFO  [Thread-3] root: Closing connection
2023-03-19 23:19:46,970 INFO  [Thread-0] root: Connected to localhost on port 60100
2023-03-19 23:19:47,619 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-19 23:19:47,622 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:24:50,177 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:24:50,177 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:24:50,178 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:24:50,179 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:24:50,179 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:24:50,180 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:24:50,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:24:50,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:24:50,182 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:24:50,182 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:24:50,183 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:24:50,184 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:24:50,184 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:24:50,185 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:24:50,186 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:24:50,187 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:24:50,200 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:24:50,205 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:24:50,211 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0048, negotiated timeout = 40000
2023-03-20 01:24:50,213 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:24:50,213 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:24:50,214 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:24:50,216 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0049, negotiated timeout = 40000
2023-03-20 01:24:50,224 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:24:50,227 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:24:50,234 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:24:50,235 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 01:24:50,243 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:24:50,243 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:24:50,245 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:24:50,245 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 01:24:50,246 ERROR [main-EventThread] org.apache.zookeeper.ClientCnxn: Error while calling watcher 
java.lang.NullPointerException
	at app_kvServer.KVServer.updateMetadataZK(KVServer.java:249)
	at ecs.ECS$4.process(ECS.java:215)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:531)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2023-03-20 01:24:50,246 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:25:06,281 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:25:06,283 INFO  [Thread-0] root: Connected to localhost on port 35056
2023-03-20 01:25:08,142 INFO  [Thread-2] root: Recieved message with raw bytes [B@3fc3d726
2023-03-20 01:25:08,142 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:25:08,142 INFO  [Thread-2] root: Message: PUTthisthat

2023-03-20 01:25:08,143 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-20 01:25:08,144 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:08,144 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:25:08,145 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 01:25:08,145 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:25:08,146 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:08,146 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 01:25:08,147 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 01:25:08,147 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:08,148 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:25:08,149 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 01:25:08,149 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:25:08,150 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:08,151 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 01:25:08,151 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 01:25:08,158 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 01:25:08,158 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 01:25:08,158 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:25:17,533 INFO  [Thread-2] root: Recieved message with raw bytes [B@35e043e0
2023-03-20 01:25:17,533 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:25:17,533 INFO  [Thread-2] root: Message: PUTslowaf

2023-03-20 01:25:17,533 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'slow' and value 'af'
2023-03-20 01:25:17,533 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:17,533 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:25:17,534 INFO  [Thread-2] root: THE KEY IS: 4fe9dfe784a2be25dd8aec3b403c3654
2023-03-20 01:25:17,534 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:25:17,535 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:17,536 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 01:25:17,536 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 01:25:17,537 INFO  [Thread-2] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:17,537 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:25:17,539 INFO  [Thread-2] root: THE KEY IS: 4fe9dfe784a2be25dd8aec3b403c3654
2023-03-20 01:25:17,539 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:25:17,539 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:25:17,540 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 01:25:17,540 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 01:25:17,542 INFO  [Thread-2] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:25:17,542 INFO  [Thread-2] root: MESSAGE TO SEND: af
2023-03-20 01:25:17,542 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:25:21,259 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:25:21,259 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:25:21,260 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:25:21,260 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:25:21,261 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:25:21,261 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:25:21,262 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:25:21,263 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:25:21,263 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:25:21,264 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:25:21,265 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:25:21,265 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:25:21,266 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:25:21,266 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:25:21,267 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:25:21,268 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:25:21,278 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:25:21,283 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:25:21,288 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b004a, negotiated timeout = 40000
2023-03-20 01:25:21,290 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:25:21,290 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:25:21,291 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:25:21,293 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b004b, negotiated timeout = 40000
2023-03-20 01:25:21,299 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:25:21,302 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:25:21,307 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:25:21,308 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:25:21,310 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 01:25:21,311 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:25:21,311 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:25:21,311 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:25:21,312 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:25:21,313 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:25:21,313 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:25:21,314 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 01:25:21,314 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 01:25:21,314 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:25:21,315 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:25:21,316 INFO  [main-EventThread] root: Transferring key: slow
2023-03-20 01:25:21,316 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:25:21,317 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 01:25:21,319 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:25:21,319 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:25:21,320 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 01:25:21,321 INFO  [Thread-2] root: Recieved message with raw bytes [B@349ccedc
2023-03-20 01:25:21,321 INFO  [Thread-0] root: Connected to localhost on port 36290
2023-03-20 01:25:21,321 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:25:21,321 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:25:21,323 INFO  [Thread-2] root: Message: DATATRANSFERslowaf

2023-03-20 01:25:21,324 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:25:21,330 INFO  [Thread-2] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:25:21,330 INFO  [Thread-2] root: MESSAGE TO SEND: af
2023-03-20 01:25:21,330 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:25:21,330 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2190c707
2023-03-20 01:25:21,330 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:25:21,330 INFO  [main-EventThread] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:25:21,330 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:25:21,330 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:25:21,330 INFO  [Thread-2] root: Recieved message with raw bytes [B@1dde8dd9
2023-03-20 01:25:21,332 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:25:21,332 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 01:25:21,333 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:25:21,334 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 01:25:21,334 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 01:25:21,334 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:25:21,334 INFO  [main-EventThread] root: Recieved message with raw bytes [B@58b05a08
2023-03-20 01:25:21,334 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:25:21,334 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 01:25:21,335 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:25:21,335 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:25:21,335 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:25:21,336 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 01:25:21,336 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:25:21,337 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:25:21,337 INFO  [Thread-2] root: Closing connection
2023-03-20 01:25:21,338 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:25:21,340 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:25:21,340 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:25:21,340 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 01:25:21,341 INFO  [Thread-0] root: Connected to localhost on port 36302
2023-03-20 01:25:21,342 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:25:21,343 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:25:21,344 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:25:21,344 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:25:21,344 INFO  [Thread-3] root: Closing connection
2023-03-20 01:31:21,346 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:31:21,346 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:31:21,346 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:31:21,347 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:31:21,348 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:31:21,348 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:31:21,349 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:31:21,349 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:31:21,350 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:31:21,350 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:31:21,351 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:31:21,352 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:31:21,352 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:31:21,353 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:31:21,353 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:31:21,354 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:31:21,364 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:31:21,369 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:31:21,374 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b004c, negotiated timeout = 40000
2023-03-20 01:31:21,376 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:31:21,377 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:31:21,377 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:31:21,379 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b004d, negotiated timeout = 40000
2023-03-20 01:31:21,386 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:31:21,389 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:31:21,394 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:21,395 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:21,398 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:31:21,399 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 01:31:21,399 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:31:21,400 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:31:21,401 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 01:31:21,401 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:31:21,402 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:21,402 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:31:21,403 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:31:21,403 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:21,404 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:21,405 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:21,405 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:21,405 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 01:31:21,406 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 01:31:21,407 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:31:21,407 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:31:21,410 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:21,410 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:21,410 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:21,411 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:21,412 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:21,412 INFO  [Thread-0] root: Connected to localhost on port 38940
2023-03-20 01:31:21,412 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:31:21,412 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:21,414 INFO  [Thread-2] root: Closing connection
2023-03-20 01:31:21,414 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:31:21,416 INFO  [main-EventThread] root: Transferring key: slow
2023-03-20 01:31:21,416 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:31:21,417 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 01:31:21,417 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:21,417 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:21,417 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:21,418 INFO  [Thread-0] root: Connected to localhost on port 38944
2023-03-20 01:31:21,419 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:21,419 INFO  [Thread-3] root: Recieved message with raw bytes [B@76b56bd6
2023-03-20 01:31:21,420 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:21,421 INFO  [Thread-3] root: Message: DATATRANSFERslowaf

2023-03-20 01:31:21,421 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:21,427 INFO  [Thread-3] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:31:21,427 INFO  [Thread-3] root: MESSAGE TO SEND: af
2023-03-20 01:31:21,427 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:21,427 INFO  [main-EventThread] root: Recieved message with raw bytes [B@71de63a0
2023-03-20 01:31:21,428 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:21,428 INFO  [main-EventThread] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:31:21,428 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:21,429 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:31:21,429 INFO  [Thread-3] root: Recieved message with raw bytes [B@1246b334
2023-03-20 01:31:21,431 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:31:21,432 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 01:31:21,433 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:31:21,434 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 01:31:21,434 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 01:31:21,434 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:31:21,435 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2f7711f8
2023-03-20 01:31:21,435 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:31:21,435 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 01:31:21,435 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:31:21,435 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:21,436 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:21,437 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:21,437 INFO  [Thread-3] root: Closing connection
2023-03-20 01:31:21,437 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:31:21,439 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:31:21,439 INFO  [main-EventThread] root: Transferring key: slow
2023-03-20 01:31:21,439 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:31:21,440 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 01:31:21,441 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:21,441 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:21,441 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:21,442 INFO  [Thread-0] root: Connected to localhost on port 38954
2023-03-20 01:31:21,442 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:21,442 INFO  [Thread-4] root: Recieved message with raw bytes [B@7fedd162
2023-03-20 01:31:21,444 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:21,444 INFO  [Thread-4] root: Message: DATATRANSFERslowaf

2023-03-20 01:31:21,445 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:21,446 INFO  [Thread-4] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:31:21,446 INFO  [Thread-4] root: MESSAGE TO SEND: af
2023-03-20 01:31:21,447 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:21,447 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2634d5c5
2023-03-20 01:31:21,447 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:21,447 INFO  [main-EventThread] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:31:21,447 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:21,448 INFO  [Thread-4] root: Recieved message with raw bytes [B@712a30ef
2023-03-20 01:31:21,448 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:31:21,448 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:31:21,449 INFO  [Thread-4] root: Message: DATATRANSFERthisthat

2023-03-20 01:31:21,450 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:31:21,451 INFO  [Thread-4] root: Added key 'this' and value 'that' to the database
2023-03-20 01:31:21,451 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-20 01:31:21,451 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:31:21,451 INFO  [main-EventThread] root: Recieved message with raw bytes [B@34a1a79a
2023-03-20 01:31:21,451 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:31:21,452 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 01:31:21,452 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:31:21,452 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:21,452 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:21,453 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:21,453 INFO  [Thread-4] root: Closing connection
2023-03-20 01:31:21,454 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 01:31:21,456 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:31:21,457 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:31:21,458 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:21,458 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:21,458 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:21,459 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:21,459 INFO  [Thread-0] root: Connected to localhost on port 38966
2023-03-20 01:31:21,459 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:21,460 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:21,461 INFO  [Thread-5] root: Closing connection
2023-03-20 01:31:21,461 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 01:31:39,029 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 01:31:39,030 INFO  [Thread-1] root: Checking key key: slow
2023-03-20 01:31:39,031 INFO  [Thread-1] root: Transferring key: slow
2023-03-20 01:31:39,031 INFO  [Thread-1] root: Checking key key: this
2023-03-20 01:31:39,032 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 01:31:39,032 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:39,033 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 01:31:39,033 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:39,033 INFO  [Thread-3] root: Recieved message with raw bytes [B@24ea61b3
2023-03-20 01:31:39,034 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:39,034 INFO  [Thread-3] root: Message: DATATRANSFERslowaf

2023-03-20 01:31:39,034 INFO  [Thread-0] root: Connected to localhost on port 48336
2023-03-20 01:31:39,035 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:39,037 INFO  [Thread-3] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:31:39,037 INFO  [Thread-3] root: MESSAGE TO SEND: af
2023-03-20 01:31:39,037 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:39,037 INFO  [Thread-1] root: Recieved message with raw bytes [B@34d99747
2023-03-20 01:31:39,037 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:39,037 INFO  [Thread-1] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:31:39,037 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:39,037 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 01:31:39,037 INFO  [Thread-1] root: Closing connection
2023-03-20 01:31:39,038 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:39,038 INFO  [Thread-3] root: Closing connection
2023-03-20 01:31:39,044 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:39,045 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:39,048 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:31:39,049 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 01:31:39,050 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:39,050 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:39,052 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:46,941 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:31:46,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:31:46,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:31:46,943 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:31:46,943 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:31:46,944 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:31:46,945 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:31:46,945 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:31:46,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:31:46,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:31:46,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:31:46,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:31:46,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:31:46,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:31:46,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:31:46,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:31:46,960 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:31:46,964 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:31:46,969 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b004e, negotiated timeout = 40000
2023-03-20 01:31:46,971 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:31:46,972 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:31:46,972 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:31:46,974 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b004f, negotiated timeout = 40000
2023-03-20 01:31:46,980 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:31:46,982 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:31:46,988 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:46,989 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 01:31:46,991 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:31:46,991 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:31:46,992 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:31:46,992 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 01:31:46,992 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:31:46,993 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 01:31:46,993 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:31:46,993 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:31:46,995 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:46,995 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:46,995 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:46,995 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:46,996 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:46,997 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 01:31:46,997 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 01:31:46,998 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:31:46,999 INFO  [main-EventThread] root: Transferring key: slow
2023-03-20 01:31:46,999 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:31:47,002 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:47,002 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:47,002 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:47,004 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:47,004 INFO  [Thread-2] root: Recieved message with raw bytes [B@37090b04
2023-03-20 01:31:47,004 INFO  [Thread-0] root: Connected to localhost on port 60666
2023-03-20 01:31:47,005 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:47,006 INFO  [Thread-2] root: Message: DATATRANSFERslowaf

2023-03-20 01:31:47,007 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:47,013 INFO  [Thread-2] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:31:47,013 INFO  [Thread-2] root: MESSAGE TO SEND: af
2023-03-20 01:31:47,013 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:47,013 INFO  [main-EventThread] root: Recieved message with raw bytes [B@156f4681
2023-03-20 01:31:47,014 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:47,014 INFO  [main-EventThread] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:31:47,014 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:47,014 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:47,015 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:47,015 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:47,015 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:31:47,016 INFO  [Thread-2] root: Closing connection
2023-03-20 01:31:47,017 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:47,017 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:47,018 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:47,018 INFO  [Thread-0] root: Connected to localhost on port 60682
2023-03-20 01:31:47,019 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:47,020 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:47,021 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:31:47,021 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:47,022 INFO  [Thread-3] root: Closing connection
2023-03-20 01:31:47,022 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:47,022 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:47,024 INFO  [Thread-0] root: Connected to localhost on port 60694
2023-03-20 01:31:47,024 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:47,025 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:47,025 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:47,026 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:47,027 INFO  [Thread-4] root: Closing connection
2023-03-20 01:31:47,028 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 01:31:47,029 INFO  [main-EventThread] root: Checking key key: slow
2023-03-20 01:31:47,030 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:31:47,030 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:31:47,030 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:47,030 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:31:47,031 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:31:47,031 INFO  [Thread-0] root: Connected to localhost on port 60696
2023-03-20 01:31:47,032 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:31:47,033 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:47,033 INFO  [Thread-5] root: Closing connection
2023-03-20 01:31:47,034 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 01:31:51,129 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 01:31:51,130 INFO  [Thread-1] root: Checking key key: slow
2023-03-20 01:31:51,130 INFO  [Thread-1] root: Transferring key: slow
2023-03-20 01:31:51,130 INFO  [Thread-1] root: Checking key key: this
2023-03-20 01:31:51,131 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 01:31:51,132 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:51,132 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 01:31:51,133 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:51,133 INFO  [Thread-0] root: Connected to localhost on port 33506
2023-03-20 01:31:51,133 INFO  [Thread-4] root: Recieved message with raw bytes [B@7344543
2023-03-20 01:31:51,134 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:51,134 INFO  [Thread-4] root: Message: DATATRANSFERslowaf

2023-03-20 01:31:51,135 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:51,137 INFO  [Thread-4] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:31:51,137 INFO  [Thread-4] root: MESSAGE TO SEND: af
2023-03-20 01:31:51,137 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:51,138 INFO  [Thread-1] root: Recieved message with raw bytes [B@367a29fb
2023-03-20 01:31:51,138 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:51,138 INFO  [Thread-1] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:31:51,138 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:51,138 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 01:31:51,138 INFO  [Thread-1] root: Closing connection
2023-03-20 01:31:51,138 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:51,139 INFO  [Thread-4] root: Closing connection
2023-03-20 01:31:51,144 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:51,145 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:51,148 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:31:51,149 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 01:31:51,150 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:51,150 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:31:51,151 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:53,175 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 01:31:53,176 INFO  [Thread-1] root: Checking key key: slow
2023-03-20 01:31:53,177 INFO  [Thread-1] root: Transferring key: slow
2023-03-20 01:31:53,177 INFO  [Thread-1] root: Checking key key: this
2023-03-20 01:31:53,179 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 01:31:53,180 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-20 01:31:53,180 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:31:53,181 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:53,181 INFO  [Thread-4] root: Recieved message with raw bytes [B@602af244
2023-03-20 01:31:53,181 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:53,182 INFO  [Thread-4] root: Message: DATATRANSFERslowaf

2023-03-20 01:31:53,182 INFO  [Thread-0] root: Connected to localhost on port 58448
2023-03-20 01:31:53,182 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'slow' and value 'af'
2023-03-20 01:31:53,185 INFO  [Thread-4] root: Added key 'slow' and value 'af' to the database
2023-03-20 01:31:53,185 INFO  [Thread-4] root: MESSAGE TO SEND: af
2023-03-20 01:31:53,185 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:53,185 INFO  [Thread-1] root: Recieved message with raw bytes [B@62893a42
2023-03-20 01:31:53,185 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 115, 108, 111, 119, 31, 97, 102, 31, 10]
2023-03-20 01:31:53,185 INFO  [Thread-1] root: Message: PUT_SUCCESSslowaf

2023-03-20 01:31:53,186 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'slow' and value 'af'
2023-03-20 01:31:53,186 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 01:31:53,186 INFO  [Thread-1] root: Closing connection
2023-03-20 01:31:53,186 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:31:53,186 INFO  [Thread-4] root: Closing connection
2023-03-20 01:31:53,192 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:31:53,195 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:31:53,196 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 01:31:53,196 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:31:53,197 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:32:18,344 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:32:18,344 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:32:18,345 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:32:18,346 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:32:18,347 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:32:18,347 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:32:18,348 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:32:18,348 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:32:18,348 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:32:18,349 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:32:18,350 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:32:18,350 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:32:18,351 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:32:18,351 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:32:18,352 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:32:18,353 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:32:18,362 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:32:18,367 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:32:18,372 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0050, negotiated timeout = 40000
2023-03-20 01:32:18,373 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:32:18,374 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:32:18,374 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:32:18,376 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0051, negotiated timeout = 40000
2023-03-20 01:32:18,384 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:32:18,386 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:32:18,393 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:32:18,394 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:32:18,395 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 01:32:19,910 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:32:19,910 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:32:19,910 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:32:19,911 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:32:19,911 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:32:19,912 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:32:19,912 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:32:19,913 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:32:19,914 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:32:19,914 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:32:19,915 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:32:19,915 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:32:19,916 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:32:19,916 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:32:19,917 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:32:19,918 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:32:19,928 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:32:19,934 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:32:19,940 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0052, negotiated timeout = 40000
2023-03-20 01:32:19,942 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:32:19,943 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:32:19,943 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:32:19,945 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0053, negotiated timeout = 40000
2023-03-20 01:32:19,952 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:32:19,954 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:593)
2023-03-20 01:32:19,959 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:32:19,961 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:32:19,962 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:32:19,962 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:32:19,962 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 01:32:19,964 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:32:19,964 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:32:19,965 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 01:32:19,965 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 01:32:19,968 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:32:19,968 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:32:19,969 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 01:32:19,969 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:32:19,970 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:32:19,970 INFO  [Thread-0] root: Connected to localhost on port 54676
2023-03-20 01:32:19,971 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 01:32:19,971 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:32:19,972 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:32:19,972 INFO  [Thread-2] root: Closing connection
2023-03-20 01:32:19,972 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:32:19,973 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 01:32:19,975 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:32:19,975 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:32:19,975 INFO  [Thread-0] root: Connected to localhost on port 54686
2023-03-20 01:32:19,976 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:32:19,976 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:32:19,977 INFO  [Thread-3] root: Closing connection
2023-03-20 01:32:27,521 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:32:27,522 INFO  [Thread-0] root: Connected to localhost on port 35294
2023-03-20 01:32:29,309 INFO  [Thread-4] root: Recieved message with raw bytes [B@27c63f0e
2023-03-20 01:32:29,310 INFO  [Thread-4] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:32:29,310 INFO  [Thread-4] root: Message: PUTthisthat

2023-03-20 01:32:29,310 INFO  [Thread-4] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-20 01:32:29,310 INFO  [Thread-4] root: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:32:29,311 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:32:29,312 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 01:32:29,312 INFO  [Thread-4] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:32:29,312 INFO  [Thread-4] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:32:29,313 INFO  [Thread-4] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 01:32:29,314 INFO  [Thread-4] root: key.compareTo(hashRange[1] false
2023-03-20 01:32:29,314 INFO  [Thread-4] root: Server cannot service for key 'this'. Sending back metadata
2023-03-20 01:32:29,315 INFO  [Thread-4] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-20 01:32:29,316 INFO  [Thread-4] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-20 01:32:29,325 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:32:29,325 INFO  [Thread-4] root: Closing connection
2023-03-20 01:32:29,326 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:32:29,326 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b784fe8
2023-03-20 01:32:29,327 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:32:29,327 INFO  [Thread-0] root: Connected to localhost on port 60372
2023-03-20 01:32:29,327 INFO  [Thread-2] root: Message: PUTthisthat

2023-03-20 01:32:29,329 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-20 01:32:29,329 INFO  [Thread-2] root: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:32:29,330 INFO  [Thread-2] root: []
2023-03-20 01:35:16,546 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:35:16,548 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:35:16,548 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:35:16,549 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:35:16,549 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:35:51,737 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:35:51,737 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:35:51,738 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:35:51,738 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:35:51,739 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:35:51,740 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:35:51,740 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:35:51,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:35:51,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:35:51,742 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:35:51,743 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:35:51,743 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:35:51,744 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:35:51,744 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:35:51,745 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:35:51,746 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:35:51,756 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:35:51,761 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:35:51,766 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0056, negotiated timeout = 40000
2023-03-20 01:35:51,768 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:35:51,768 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:35:51,769 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:35:51,771 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0057, negotiated timeout = 40000
2023-03-20 01:35:51,778 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 01:35:51,780 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 01:35:51,787 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:35:51,788 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 01:35:51,795 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:35:51,797 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:35:51,798 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:35:51,798 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 01:35:51,799 ERROR [main-EventThread] org.apache.zookeeper.ClientCnxn: Error while calling watcher 
java.lang.NullPointerException
	at app_kvServer.KVServer.updateMetadataZK(KVServer.java:249)
	at ecs.ECS$4.process(ECS.java:215)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:531)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2023-03-20 01:35:51,799 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:35:59,551 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:35:59,552 INFO  [Thread-0] root: Connected to localhost on port 52528
2023-03-20 01:36:01,923 INFO  [Thread-2] root: Recieved message with raw bytes [B@42195c66
2023-03-20 01:36:01,924 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:01,925 INFO  [Thread-2] root: Message: PUTthisthat

2023-03-20 01:36:01,926 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-20 01:36:01,926 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:01,927 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:36:01,928 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 01:36:01,928 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:36:01,929 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:01,929 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 01:36:01,930 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 01:36:01,931 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:01,931 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:36:01,932 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 01:36:01,932 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:36:01,933 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:01,934 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 01:36:01,935 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 01:36:01,941 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 01:36:01,941 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 01:36:01,941 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:14,405 INFO  [Thread-2] root: Recieved message with raw bytes [B@3cc716bf
2023-03-20 01:36:14,405 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:14,405 INFO  [Thread-2] root: Message: PUThateleague

2023-03-20 01:36:14,406 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'hate' and value 'league'
2023-03-20 01:36:14,406 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:14,406 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:36:14,406 INFO  [Thread-2] root: THE KEY IS: 0e609404e53b251f786b41b7be93cc19
2023-03-20 01:36:14,407 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:36:14,408 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:14,408 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 01:36:14,409 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 01:36:14,409 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:14,410 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 01:36:14,411 INFO  [Thread-2] root: THE KEY IS: 0e609404e53b251f786b41b7be93cc19
2023-03-20 01:36:14,411 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 01:36:14,412 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 01:36:14,412 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 01:36:14,413 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 01:36:14,414 INFO  [Thread-2] root: Added key 'hate' and value 'league' to the database
2023-03-20 01:36:14,414 INFO  [Thread-2] root: MESSAGE TO SEND: league
2023-03-20 01:36:14,415 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:18,845 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:36:18,845 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:36:18,846 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:36:18,846 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:36:18,847 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:36:18,848 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:36:18,848 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:36:18,849 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:36:18,849 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:36:18,850 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:36:18,851 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:36:18,852 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:36:18,852 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:36:18,853 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:36:18,853 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:36:18,854 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:36:18,864 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:36:18,870 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:36:18,875 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0058, negotiated timeout = 40000
2023-03-20 01:36:18,876 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:36:18,877 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:36:18,877 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:36:18,879 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b0059, negotiated timeout = 40000
2023-03-20 01:36:18,885 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 01:36:18,888 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 01:36:18,893 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:36:18,895 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:36:18,896 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 01:36:18,897 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:36:18,897 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:36:18,897 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:36:18,898 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:36:18,899 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:36:18,899 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:36:18,900 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 01:36:18,900 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 01:36:18,900 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:36:18,901 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:36:18,902 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 01:36:18,902 INFO  [main-EventThread] root: Checking key key: hate
2023-03-20 01:36:18,903 INFO  [main-EventThread] root: Transferring key: hate
2023-03-20 01:36:18,905 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:36:18,905 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:36:18,906 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 01:36:18,907 INFO  [Thread-2] root: Recieved message with raw bytes [B@42e26f63
2023-03-20 01:36:18,907 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:36:18,907 INFO  [Thread-0] root: Connected to localhost on port 51620
2023-03-20 01:36:18,907 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:18,909 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 01:36:18,910 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:36:18,915 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 01:36:18,915 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 01:36:18,915 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:18,916 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c1d9636
2023-03-20 01:36:18,916 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:18,916 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 01:36:18,916 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:18,916 INFO  [Thread-2] root: Recieved message with raw bytes [B@4248c4c0
2023-03-20 01:36:18,916 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:36:18,917 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:18,918 INFO  [Thread-2] root: Message: DATATRANSFERhateleague

2023-03-20 01:36:18,919 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:36:18,921 INFO  [Thread-2] root: Added key 'hate' and value 'league' to the database
2023-03-20 01:36:18,921 INFO  [Thread-2] root: MESSAGE TO SEND: league
2023-03-20 01:36:18,921 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:18,921 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2ac6177c
2023-03-20 01:36:18,921 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:18,921 INFO  [main-EventThread] root: Message: PUT_SUCCESShateleague

2023-03-20 01:36:18,921 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:18,922 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:36:18,922 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:36:18,923 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:36:18,923 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 01:36:18,923 INFO  [Thread-2] root: Closing connection
2023-03-20 01:36:18,925 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:36:18,926 INFO  [main-EventThread] root: Checking key key: hate
2023-03-20 01:36:18,927 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:36:18,927 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:36:18,927 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 01:36:18,928 INFO  [Thread-0] root: Connected to localhost on port 51624
2023-03-20 01:36:18,928 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:36:18,929 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:36:18,930 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:36:18,930 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:36:18,930 INFO  [Thread-3] root: Closing connection
2023-03-20 01:36:23,136 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 01:36:23,136 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug226.eecg.toronto.edu
2023-03-20 01:36:23,137 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 01:36:23,137 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 01:36:23,138 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 01:36:23,140 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 01:36:23,140 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 01:36:23,141 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 01:36:23,141 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 01:36:23,142 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 01:36:23,143 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 01:36:23,144 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 01:36:23,144 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 01:36:23,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 01:36:23,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 01:36:23,147 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 01:36:23,157 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:36:23,163 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:36:23,169 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b005a, negotiated timeout = 40000
2023-03-20 01:36:23,170 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 01:36:23,171 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 01:36:23,171 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 01:36:23,173 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x1002d51506b005b, negotiated timeout = 40000
2023-03-20 01:36:23,179 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 01:36:23,182 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 01:36:23,187 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:36:23,188 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:36:23,190 INFO  [Thread-0] root: Initialize server ...
2023-03-20 01:36:23,191 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 01:36:23,192 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:36:23,193 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:36:23,193 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 01:36:23,194 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:36:23,195 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:36:23,195 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 01:36:23,196 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 01:36:23,197 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:36:23,198 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:36:23,198 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 01:36:23,198 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:36:23,198 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 01:36:23,198 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:36:23,199 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:36:23,200 INFO  [main-EventThread] root: Checking key key: hate
2023-03-20 01:36:23,202 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:36:23,203 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:36:23,203 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:36:23,204 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:36:23,205 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:36:23,205 INFO  [Thread-0] root: Connected to localhost on port 60736
2023-03-20 01:36:23,206 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:36:23,206 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:36:23,208 INFO  [Thread-2] root: Closing connection
2023-03-20 01:36:23,208 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:36:23,210 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 01:36:23,210 INFO  [main-EventThread] root: Checking key key: hate
2023-03-20 01:36:23,211 INFO  [main-EventThread] root: Transferring key: hate
2023-03-20 01:36:23,211 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:36:23,211 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:36:23,212 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:36:23,213 INFO  [Thread-0] root: Connected to localhost on port 60740
2023-03-20 01:36:23,213 INFO  [Thread-3] root: Recieved message with raw bytes [B@4233496e
2023-03-20 01:36:23,213 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:36:23,214 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:23,215 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 01:36:23,216 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:36:23,223 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 01:36:23,223 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 01:36:23,223 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:23,223 INFO  [main-EventThread] root: Recieved message with raw bytes [B@71de63a0
2023-03-20 01:36:23,223 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:23,223 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 01:36:23,223 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:23,224 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:36:23,224 INFO  [Thread-3] root: Recieved message with raw bytes [B@20ba5950
2023-03-20 01:36:23,225 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:23,225 INFO  [Thread-3] root: Message: DATATRANSFERhateleague

2023-03-20 01:36:23,226 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:36:23,228 INFO  [Thread-3] root: Added key 'hate' and value 'league' to the database
2023-03-20 01:36:23,228 INFO  [Thread-3] root: MESSAGE TO SEND: league
2023-03-20 01:36:23,228 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2f7711f8
2023-03-20 01:36:23,228 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:23,228 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:23,228 INFO  [main-EventThread] root: Message: PUT_SUCCESShateleague

2023-03-20 01:36:23,228 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:23,229 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:36:23,229 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:36:23,230 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:36:23,230 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:36:23,230 INFO  [Thread-3] root: Closing connection
2023-03-20 01:36:23,232 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:36:23,233 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 01:36:23,233 INFO  [main-EventThread] root: Checking key key: hate
2023-03-20 01:36:23,234 INFO  [main-EventThread] root: Transferring key: hate
2023-03-20 01:36:23,234 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:36:23,234 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:36:23,235 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:36:23,236 INFO  [Thread-0] root: Connected to localhost on port 60756
2023-03-20 01:36:23,236 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:36:23,236 INFO  [Thread-4] root: Recieved message with raw bytes [B@37aef529
2023-03-20 01:36:23,238 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:23,239 INFO  [Thread-4] root: Message: DATATRANSFERthisthat

2023-03-20 01:36:23,240 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 01:36:23,242 INFO  [Thread-4] root: Added key 'this' and value 'that' to the database
2023-03-20 01:36:23,242 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-20 01:36:23,242 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:23,242 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2634d5c5
2023-03-20 01:36:23,242 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 01:36:23,242 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 01:36:23,242 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 01:36:23,242 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:36:23,242 INFO  [Thread-4] root: Recieved message with raw bytes [B@39690dac
2023-03-20 01:36:23,243 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:23,243 INFO  [Thread-4] root: Message: DATATRANSFERhateleague

2023-03-20 01:36:23,244 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:36:23,245 INFO  [Thread-4] root: Added key 'hate' and value 'league' to the database
2023-03-20 01:36:23,245 INFO  [Thread-4] root: MESSAGE TO SEND: league
2023-03-20 01:36:23,245 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:23,245 INFO  [main-EventThread] root: Recieved message with raw bytes [B@34a1a79a
2023-03-20 01:36:23,245 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:36:23,245 INFO  [main-EventThread] root: Message: PUT_SUCCESShateleague

2023-03-20 01:36:23,246 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:36:23,246 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:36:23,246 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:36:23,246 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:36:23,246 INFO  [Thread-4] root: Closing connection
2023-03-20 01:36:23,247 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 01:36:23,248 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 01:36:23,249 INFO  [main-EventThread] root: Checking key key: hate
2023-03-20 01:36:23,249 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 01:36:23,249 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:36:23,250 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 01:36:23,250 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 01:36:23,250 INFO  [main-EventThread] root: Closing connection
2023-03-20 01:36:23,250 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:36:23,250 INFO  [Thread-0] root: Connected to localhost on port 60760
2023-03-20 01:36:23,250 INFO  [Thread-5] root: Closing connection
2023-03-20 01:36:23,251 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 01:37:09,791 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 01:37:09,792 INFO  [Thread-1] root: Checking key key: this
2023-03-20 01:37:09,793 INFO  [Thread-1] root: Checking key key: hate
2023-03-20 01:37:09,793 INFO  [Thread-1] root: Transferring key: hate
2023-03-20 01:37:09,794 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 01:37:09,794 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 01:37:09,794 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 01:37:09,795 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:37:09,796 INFO  [Thread-3] root: Recieved message with raw bytes [B@2275b49c
2023-03-20 01:37:09,796 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:37:09,796 INFO  [Thread-0] root: Connected to localhost on port 36628
2023-03-20 01:37:09,797 INFO  [Thread-3] root: Message: DATATRANSFERhateleague

2023-03-20 01:37:09,798 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hate' and value 'league'
2023-03-20 01:37:09,799 INFO  [Thread-3] root: Added key 'hate' and value 'league' to the database
2023-03-20 01:37:09,799 INFO  [Thread-3] root: MESSAGE TO SEND: league
2023-03-20 01:37:09,799 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:37:09,800 INFO  [Thread-1] root: Recieved message with raw bytes [B@3b8aba65
2023-03-20 01:37:09,800 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 97, 116, 101, 31, 108, 101, 97, 103, 117, 101, 31, 10]
2023-03-20 01:37:09,800 INFO  [Thread-1] root: Message: PUT_SUCCESShateleague

2023-03-20 01:37:09,800 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'hate' and value 'league'
2023-03-20 01:37:09,800 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 01:37:09,800 INFO  [Thread-1] root: Closing connection
2023-03-20 01:37:09,800 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:37:09,800 INFO  [Thread-3] root: Closing connection
2023-03-20 01:37:09,807 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:37:09,807 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:37:09,811 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 01:37:09,812 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 01:37:09,813 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 01:37:09,814 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:37:09,814 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 01:37:10,774 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 01:37:10,775 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 01:37:10,783 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:37:10,787 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 01:37:11,658 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 01:37:11,659 INFO  [Thread-1] root: Checking key key: this
2023-03-20 01:37:11,660 INFO  [Thread-1] root: Checking key key: hate
2023-03-20 01:37:11,660 INFO  [Thread-1] root: Transferring key: hate
2023-03-20 01:37:11,662 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:42:42,058 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:42:42,058 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:42:42,059 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:42:42,059 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:42:42,060 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:42:42,060 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:42:42,061 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:42:42,061 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:42:42,062 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:42:42,062 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:42:42,063 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:42:42,063 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:42:42,064 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:42:42,064 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:42:42,065 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:42:42,066 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:42:42,076 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:42:42,080 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:42:42,085 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0002, negotiated timeout = 40000
2023-03-20 20:42:42,087 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:42:42,087 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:42:42,088 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:42:42,089 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0003, negotiated timeout = 40000
2023-03-20 20:42:42,097 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 20:42:42,099 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:596)
2023-03-20 20:42:42,108 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:42:42,108 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 20:42:42,114 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:42:42,116 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:42:42,117 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:42:42,117 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 20:42:42,117 ERROR [main-EventThread] org.apache.zookeeper.ClientCnxn: Error while calling watcher 
java.lang.NullPointerException
	at app_kvServer.KVServer.updateMetadataZK(KVServer.java:249)
	at ecs.ECS$4.process(ECS.java:215)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:531)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2023-03-20 20:42:42,118 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:44:47,396 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:44:47,396 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:44:47,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:44:47,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:44:47,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:44:47,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:44:47,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:44:47,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:44:47,398 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:44:47,407 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:44:47,411 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:44:47,416 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0006, negotiated timeout = 40000
2023-03-20 20:44:47,417 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:44:47,418 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:44:47,418 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:44:47,420 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0007, negotiated timeout = 40000
2023-03-20 20:44:47,426 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:600)
2023-03-20 20:44:47,428 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:600)
2023-03-20 20:44:47,433 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:44:47,434 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 20:44:47,440 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:44:47,441 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:44:47,442 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:44:47,443 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 20:44:47,443 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:45:22,107 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:45:22,109 INFO  [Thread-0] root: Connected to localhost on port 37706
2023-03-20 20:45:33,106 INFO  [Thread-2] root: Recieved message with raw bytes [B@4359caf4
2023-03-20 20:45:33,107 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:45:33,107 INFO  [Thread-2] root: Message: PUTabatukum

2023-03-20 20:45:33,108 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'abatu' and value 'kum'
2023-03-20 20:45:33,108 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:33,109 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:45:33,110 INFO  [Thread-2] root: THE KEY IS: 3c4d213e51b68639d7985d23387ac164
2023-03-20 20:45:33,110 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:45:33,111 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:33,111 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:45:33,112 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:45:33,112 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:33,113 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:45:33,114 INFO  [Thread-2] root: THE KEY IS: 3c4d213e51b68639d7985d23387ac164
2023-03-20 20:45:33,114 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:45:33,115 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:33,115 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:45:33,116 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:45:33,121 INFO  [Thread-2] root: Added key 'abatu' and value 'kum' to the database
2023-03-20 20:45:33,121 INFO  [Thread-2] root: MESSAGE TO SEND: kum
2023-03-20 20:45:33,121 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:45:39,553 INFO  [Thread-2] root: Recieved message with raw bytes [B@365fd4ba
2023-03-20 20:45:39,553 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 105, 31, 119, 97, 110, 116, 105, 116, 31, 10]
2023-03-20 20:45:39,553 INFO  [Thread-2] root: Message: PUTiwantit

2023-03-20 20:45:39,553 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'i' and value 'wantit'
2023-03-20 20:45:39,553 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:39,553 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:45:39,553 INFO  [Thread-2] root: THE KEY IS: 865c0c0b4ab0e063e5caa3387c1a8741
2023-03-20 20:45:39,554 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:45:39,554 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:39,555 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:45:39,555 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:45:39,556 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:39,556 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:45:39,557 INFO  [Thread-2] root: THE KEY IS: 865c0c0b4ab0e063e5caa3387c1a8741
2023-03-20 20:45:39,557 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:45:39,557 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:45:39,557 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:45:39,557 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:45:39,559 INFO  [Thread-2] root: Added key 'i' and value 'wantit' to the database
2023-03-20 20:45:39,559 INFO  [Thread-2] root: MESSAGE TO SEND: wantit
2023-03-20 20:45:39,559 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'i' and value 'wantit'
2023-03-20 20:45:49,954 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:45:49,954 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:45:49,954 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:45:49,955 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:45:49,956 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:45:49,956 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:45:49,957 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:45:49,958 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:45:49,958 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:45:49,959 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:45:49,959 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:45:49,960 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:45:49,961 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:45:49,961 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:45:49,962 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:45:49,963 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:45:49,971 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:45:49,975 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:45:49,979 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0008, negotiated timeout = 40000
2023-03-20 20:45:49,981 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:45:49,981 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:45:49,981 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:45:49,983 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0009, negotiated timeout = 40000
2023-03-20 20:45:49,989 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:600)
2023-03-20 20:45:49,991 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:600)
2023-03-20 20:45:49,996 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:45:49,996 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:45:49,997 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 20:45:49,999 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:45:49,999 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:45:49,999 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:45:50,000 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:45:50,001 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:45:50,001 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:45:50,001 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 20:45:50,002 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:45:50,002 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:45:50,003 INFO  [main-EventThread] root: Checking key key: abatu
2023-03-20 20:45:50,003 INFO  [main-EventThread] root: Transferring key: abatu
2023-03-20 20:45:50,004 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:45:50,004 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 20:45:50,005 INFO  [main-EventThread] root: Checking key key: i
2023-03-20 20:45:50,007 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:45:50,007 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:45:50,008 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:45:50,009 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:45:50,009 INFO  [Thread-2] root: Recieved message with raw bytes [B@3a366ef2
2023-03-20 20:45:50,009 INFO  [Thread-0] root: Connected to localhost on port 48726
2023-03-20 20:45:50,009 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:45:50,010 INFO  [Thread-2] root: Message: DATATRANSFERabatukum

2023-03-20 20:45:50,011 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:45:50,016 INFO  [Thread-2] root: Added key 'abatu' and value 'kum' to the database
2023-03-20 20:45:50,016 INFO  [Thread-2] root: MESSAGE TO SEND: kum
2023-03-20 20:45:50,016 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:45:50,016 INFO  [main-EventThread] root: Recieved message with raw bytes [B@71de63a0
2023-03-20 20:45:50,016 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:45:50,016 INFO  [main-EventThread] root: Message: PUT_SUCCESSabatukum

2023-03-20 20:45:50,016 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:45:50,016 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:45:50,016 INFO  [Thread-2] root: Recieved message with raw bytes [B@14e39f7c
2023-03-20 20:45:50,017 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:45:50,018 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 20:45:50,018 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:45:50,020 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 20:45:50,020 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 20:45:50,020 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:45:50,020 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2f7711f8
2023-03-20 20:45:50,020 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:45:50,020 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 20:45:50,020 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:45:50,020 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:45:50,020 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:45:50,020 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:45:50,020 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:45:50,021 INFO  [Thread-2] root: Closing connection
2023-03-20 20:45:50,022 INFO  [main-EventThread] root: Checking key key: abatu
2023-03-20 20:45:50,023 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:45:50,024 INFO  [main-EventThread] root: Checking key key: i
2023-03-20 20:45:50,024 INFO  [main-EventThread] root: Transferring key: i
2023-03-20 20:45:50,025 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:45:50,025 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:45:50,025 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:45:50,026 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'i' and value 'wantit'
2023-03-20 20:45:50,026 INFO  [Thread-0] root: Connected to localhost on port 48734
2023-03-20 20:45:50,026 INFO  [Thread-3] root: Recieved message with raw bytes [B@158f0749
2023-03-20 20:45:50,027 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 105, 31, 119, 97, 110, 116, 105, 116, 31, 10]
2023-03-20 20:45:50,028 INFO  [Thread-3] root: Message: DATATRANSFERiwantit

2023-03-20 20:45:50,028 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'i' and value 'wantit'
2023-03-20 20:45:50,029 INFO  [Thread-3] root: Added key 'i' and value 'wantit' to the database
2023-03-20 20:45:50,029 INFO  [Thread-3] root: MESSAGE TO SEND: wantit
2023-03-20 20:45:50,029 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'i' and value 'wantit'
2023-03-20 20:45:50,029 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2634d5c5
2023-03-20 20:45:50,029 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 105, 31, 119, 97, 110, 116, 105, 116, 31, 10]
2023-03-20 20:45:50,030 INFO  [main-EventThread] root: Message: PUT_SUCCESSiwantit

2023-03-20 20:45:50,030 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'i' and value 'wantit'
2023-03-20 20:45:50,030 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:45:50,030 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:45:50,030 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:45:50,030 INFO  [Thread-3] root: Closing connection
2023-03-20 20:45:50,030 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:46:06,369 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:46:06,369 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:46:06,369 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:46:06,370 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:46:06,371 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:46:06,371 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:46:06,372 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:46:06,372 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:46:06,373 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:46:06,373 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:46:06,374 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:46:06,375 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:46:06,375 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:46:06,376 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:46:06,376 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:46:06,377 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:46:06,386 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:46:06,390 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:46:06,394 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c000a, negotiated timeout = 40000
2023-03-20 20:46:06,395 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:46:06,396 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:46:06,396 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:46:06,398 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c000b, negotiated timeout = 40000
2023-03-20 20:46:06,403 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:600)
2023-03-20 20:46:06,405 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:600)
2023-03-20 20:46:06,410 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:46:06,410 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:46:06,411 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:46:06,412 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 20:46:06,415 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:46:06,416 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:46:06,416 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 20:46:06,417 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:46:06,419 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:46:06,419 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:46:06,420 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:46:06,421 INFO  [main-EventThread] root: Checking key key: abatu
2023-03-20 20:46:06,422 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:46:06,422 INFO  [main-EventThread] root: Checking key key: i
2023-03-20 20:46:06,425 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:46:06,425 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:46:06,425 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:46:06,426 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:46:06,426 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:46:06,426 INFO  [Thread-0] root: Connected to localhost on port 60826
2023-03-20 20:46:06,427 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:46:06,427 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:46:06,428 INFO  [main-EventThread] root: Checking key key: abatu
2023-03-20 20:46:06,428 INFO  [Thread-2] root: Closing connection
2023-03-20 20:46:06,429 INFO  [main-EventThread] root: Transferring key: abatu
2023-03-20 20:46:06,430 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:46:06,431 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 20:46:06,431 INFO  [main-EventThread] root: Checking key key: i
2023-03-20 20:46:06,432 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:46:06,432 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:46:06,432 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:46:06,434 INFO  [Thread-0] root: Connected to localhost on port 60834
2023-03-20 20:46:06,434 INFO  [Thread-3] root: Recieved message with raw bytes [B@1ed5091d
2023-03-20 20:46:06,434 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,435 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:46:06,436 INFO  [Thread-3] root: Message: DATATRANSFERabatukum

2023-03-20 20:46:06,437 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,441 INFO  [Thread-3] root: Added key 'abatu' and value 'kum' to the database
2023-03-20 20:46:06,441 INFO  [Thread-3] root: MESSAGE TO SEND: kum
2023-03-20 20:46:06,441 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,441 INFO  [main-EventThread] root: Recieved message with raw bytes [B@56284003
2023-03-20 20:46:06,441 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:46:06,441 INFO  [main-EventThread] root: Message: PUT_SUCCESSabatukum

2023-03-20 20:46:06,441 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,441 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:46:06,441 INFO  [Thread-3] root: Recieved message with raw bytes [B@52184660
2023-03-20 20:46:06,442 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:46:06,442 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 20:46:06,443 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:46:06,444 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 20:46:06,444 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 20:46:06,444 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:46:06,444 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6ac9cdd8
2023-03-20 20:46:06,444 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:46:06,444 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 20:46:06,444 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:46:06,445 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:46:06,445 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:46:06,445 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:46:06,445 INFO  [Thread-3] root: Closing connection
2023-03-20 20:46:06,445 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:46:06,446 INFO  [main-EventThread] root: Checking key key: abatu
2023-03-20 20:46:06,447 INFO  [main-EventThread] root: Transferring key: abatu
2023-03-20 20:46:06,447 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:46:06,448 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 20:46:06,448 INFO  [main-EventThread] root: Checking key key: i
2023-03-20 20:46:06,449 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:46:06,449 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:46:06,449 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:46:06,450 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,450 INFO  [Thread-4] root: Recieved message with raw bytes [B@5ba3234c
2023-03-20 20:46:06,450 INFO  [Thread-0] root: Connected to localhost on port 60838
2023-03-20 20:46:06,451 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:46:06,453 INFO  [Thread-4] root: Message: DATATRANSFERabatukum

2023-03-20 20:46:06,453 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,453 INFO  [Thread-4] root: Added key 'abatu' and value 'kum' to the database
2023-03-20 20:46:06,453 INFO  [Thread-4] root: MESSAGE TO SEND: kum
2023-03-20 20:46:06,454 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,454 INFO  [main-EventThread] root: Recieved message with raw bytes [B@21622732
2023-03-20 20:46:06,455 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:46:06,455 INFO  [main-EventThread] root: Message: PUT_SUCCESSabatukum

2023-03-20 20:46:06,455 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:46:06,455 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:46:06,455 INFO  [Thread-4] root: Recieved message with raw bytes [B@5564c648
2023-03-20 20:46:06,455 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:46:06,455 INFO  [Thread-4] root: Message: DATATRANSFERthisthat

2023-03-20 20:46:06,455 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:46:06,456 INFO  [Thread-4] root: Added key 'this' and value 'that' to the database
2023-03-20 20:46:06,456 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-20 20:46:06,456 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:46:06,456 INFO  [main-EventThread] root: Recieved message with raw bytes [B@115fbc9c
2023-03-20 20:46:06,456 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:46:06,456 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 20:46:06,456 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:46:06,456 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:46:06,456 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:46:06,456 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:46:06,456 INFO  [Thread-4] root: Closing connection
2023-03-20 20:46:06,457 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 20:46:06,458 INFO  [main-EventThread] root: Checking key key: abatu
2023-03-20 20:46:06,458 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:46:06,460 INFO  [main-EventThread] root: Checking key key: i
2023-03-20 20:46:06,460 INFO  [main-EventThread] root: Transferring key: i
2023-03-20 20:46:06,460 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:46:06,460 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:46:06,461 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:46:06,462 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'i' and value 'wantit'
2023-03-20 20:46:06,462 INFO  [Thread-5] root: Recieved message with raw bytes [B@3b6147f2
2023-03-20 20:46:06,462 INFO  [Thread-0] root: Connected to localhost on port 60846
2023-03-20 20:46:06,463 INFO  [Thread-5] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 105, 31, 119, 97, 110, 116, 105, 116, 31, 10]
2023-03-20 20:46:06,464 INFO  [Thread-5] root: Message: DATATRANSFERiwantit

2023-03-20 20:46:06,465 INFO  [Thread-5] root: Received a message of type 'DATATRANSFER' with key 'i' and value 'wantit'
2023-03-20 20:46:06,466 INFO  [Thread-5] root: Added key 'i' and value 'wantit' to the database
2023-03-20 20:46:06,466 INFO  [Thread-5] root: MESSAGE TO SEND: wantit
2023-03-20 20:46:06,467 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'i' and value 'wantit'
2023-03-20 20:46:06,467 INFO  [main-EventThread] root: Recieved message with raw bytes [B@4208ed6d
2023-03-20 20:46:06,467 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 105, 31, 119, 97, 110, 116, 105, 116, 31, 10]
2023-03-20 20:46:06,467 INFO  [main-EventThread] root: Message: PUT_SUCCESSiwantit

2023-03-20 20:46:06,467 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'i' and value 'wantit'
2023-03-20 20:46:06,467 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:46:06,467 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:46:06,467 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:46:06,467 INFO  [Thread-5] root: Closing connection
2023-03-20 20:46:06,468 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 20:50:54,234 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 20:50:54,235 INFO  [Thread-1] root: Checking key key: abatu
2023-03-20 20:50:54,236 INFO  [Thread-1] root: Transferring key: abatu
2023-03-20 20:50:54,236 INFO  [Thread-1] root: Checking key key: this
2023-03-20 20:50:54,237 INFO  [Thread-1] root: Checking key key: i
2023-03-20 20:50:54,238 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 20:50:54,238 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:50:54,238 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 20:50:54,239 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:50:54,239 INFO  [Thread-3] root: Recieved message with raw bytes [B@3b33de40
2023-03-20 20:50:54,239 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:50:54,240 INFO  [Thread-0] root: Connected to localhost on port 34388
2023-03-20 20:50:54,240 INFO  [Thread-3] root: Message: DATATRANSFERabatukum

2023-03-20 20:50:54,241 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'abatu' and value 'kum'
2023-03-20 20:50:54,243 INFO  [Thread-3] root: Added key 'abatu' and value 'kum' to the database
2023-03-20 20:50:54,243 INFO  [Thread-3] root: MESSAGE TO SEND: kum
2023-03-20 20:50:54,243 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:50:54,243 INFO  [Thread-1] root: Recieved message with raw bytes [B@649013c6
2023-03-20 20:50:54,243 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 97, 98, 97, 116, 117, 31, 107, 117, 109, 31, 10]
2023-03-20 20:50:54,243 INFO  [Thread-1] root: Message: PUT_SUCCESSabatukum

2023-03-20 20:50:54,243 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'abatu' and value 'kum'
2023-03-20 20:50:54,243 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 20:50:54,243 INFO  [Thread-1] root: Closing connection
2023-03-20 20:50:54,243 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:50:54,243 INFO  [Thread-3] root: Closing connection
2023-03-20 20:50:54,250 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:50:54,251 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:50:54,254 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:50:54,257 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 20:50:54,258 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:50:54,259 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:50:54,259 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:50:55,870 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:50:55,870 INFO  [Thread-1] root: Checking key key: i
2023-03-20 20:50:55,872 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:50:55,879 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:50:55,882 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:50:58,021 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:50:58,022 INFO  [Thread-1] root: Checking key key: abatu
2023-03-20 20:50:58,023 INFO  [Thread-1] root: Transferring key: abatu
2023-03-20 20:50:58,023 INFO  [Thread-1] root: Checking key key: this
2023-03-20 20:50:58,025 INFO  [Thread-1] root: Checking key key: i
2023-03-20 20:50:58,026 INFO  [Thread-1] root: Transferring key: i
2023-03-20 20:50:58,029 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:55:09,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:55:09,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:55:09,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:55:09,082 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:55:09,083 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:55:09,083 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:55:09,084 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:55:09,084 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:55:09,085 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:55:09,085 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:55:09,086 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:55:09,086 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:55:09,087 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:55:09,087 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:55:09,088 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:55:09,089 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:55:09,097 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:55:09,101 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:55:09,106 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0010, negotiated timeout = 40000
2023-03-20 20:55:09,107 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:55:09,108 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:55:09,108 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:55:09,110 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0011, negotiated timeout = 40000
2023-03-20 20:55:09,116 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:55:09,118 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:55:09,123 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:55:09,124 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 20:55:09,131 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:55:09,134 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:55:09,135 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:09,135 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 20:55:09,135 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:55:17,630 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:55:17,631 INFO  [Thread-0] root: Connected to localhost on port 34762
2023-03-20 20:55:19,770 INFO  [Thread-2] root: Recieved message with raw bytes [B@37732221
2023-03-20 20:55:19,771 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:55:19,771 INFO  [Thread-2] root: Message: PUTillness

2023-03-20 20:55:19,771 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'ill' and value 'ness'
2023-03-20 20:55:19,771 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:19,772 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:55:19,773 INFO  [Thread-2] root: THE KEY IS: 2f9c691594932556ef427450338a74b7
2023-03-20 20:55:19,773 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:55:19,774 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:19,774 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:55:19,775 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:55:19,776 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:19,776 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:55:19,777 INFO  [Thread-2] root: THE KEY IS: 2f9c691594932556ef427450338a74b7
2023-03-20 20:55:19,777 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:55:19,778 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:19,779 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:55:19,780 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:55:19,785 INFO  [Thread-2] root: Added key 'ill' and value 'ness' to the database
2023-03-20 20:55:19,785 INFO  [Thread-2] root: MESSAGE TO SEND: ness
2023-03-20 20:55:19,785 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:55:23,185 INFO  [Thread-2] root: Recieved message with raw bytes [B@ba46fb1
2023-03-20 20:55:23,185 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 97, 115, 100, 102, 31, 106, 107, 59, 108, 31, 10]
2023-03-20 20:55:23,185 INFO  [Thread-2] root: Message: PUTasdfjk;l

2023-03-20 20:55:23,185 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'asdf' and value 'jk;l'
2023-03-20 20:55:23,185 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:23,185 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:55:23,186 INFO  [Thread-2] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-20 20:55:23,186 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:55:23,186 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:23,186 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:55:23,186 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:55:23,186 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:23,186 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:55:23,187 INFO  [Thread-2] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-20 20:55:23,188 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:55:23,188 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:55:23,189 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:55:23,190 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:55:23,192 INFO  [Thread-2] root: Added key 'asdf' and value 'jk;l' to the database
2023-03-20 20:55:23,192 INFO  [Thread-2] root: MESSAGE TO SEND: jk;l
2023-03-20 20:55:23,192 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'asdf' and value 'jk;l'
2023-03-20 20:55:27,853 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:55:27,853 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:55:27,853 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:55:27,854 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:55:27,855 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:55:27,855 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:55:27,856 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:55:27,857 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:55:27,857 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:55:27,858 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:55:27,859 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:55:27,859 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:55:27,860 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:55:27,860 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:55:27,861 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:55:27,862 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:55:27,871 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:55:27,875 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:55:27,879 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0012, negotiated timeout = 40000
2023-03-20 20:55:27,881 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:55:27,881 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:55:27,881 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:55:27,883 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0013, negotiated timeout = 40000
2023-03-20 20:55:27,889 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:55:27,890 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:55:27,895 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:55:27,896 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:55:27,897 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 20:55:27,898 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:55:27,898 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:55:27,899 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:55:27,900 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:55:27,901 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:55:27,901 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 20:55:27,901 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:55:27,902 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:55:27,902 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:55:27,903 INFO  [main-EventThread] root: Checking key key: ill
2023-03-20 20:55:27,904 INFO  [main-EventThread] root: Transferring key: ill
2023-03-20 20:55:27,904 INFO  [main-EventThread] root: Checking key key: asdf
2023-03-20 20:55:27,906 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:55:27,906 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:55:27,907 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:55:27,908 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ill' and value 'ness'
2023-03-20 20:55:27,908 INFO  [Thread-2] root: Recieved message with raw bytes [B@41e5ddae
2023-03-20 20:55:27,908 INFO  [Thread-0] root: Connected to localhost on port 56450
2023-03-20 20:55:27,908 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:55:27,909 INFO  [Thread-2] root: Message: DATATRANSFERillness

2023-03-20 20:55:27,910 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'ill' and value 'ness'
2023-03-20 20:55:27,915 INFO  [Thread-2] root: Added key 'ill' and value 'ness' to the database
2023-03-20 20:55:27,915 INFO  [Thread-2] root: MESSAGE TO SEND: ness
2023-03-20 20:55:27,915 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:55:27,915 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5cb0c166
2023-03-20 20:55:27,916 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:55:27,916 INFO  [main-EventThread] root: Message: PUT_SUCCESSillness

2023-03-20 20:55:27,916 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:55:27,916 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:55:27,916 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:55:27,916 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:55:27,916 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:55:27,917 INFO  [Thread-2] root: Closing connection
2023-03-20 20:55:27,918 INFO  [main-EventThread] root: Checking key key: ill
2023-03-20 20:55:27,919 INFO  [main-EventThread] root: Checking key key: asdf
2023-03-20 20:55:27,920 INFO  [main-EventThread] root: Transferring key: asdf
2023-03-20 20:55:27,920 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:55:27,920 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:55:27,921 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:55:27,922 INFO  [Thread-0] root: Connected to localhost on port 56452
2023-03-20 20:55:27,922 INFO  [Thread-3] root: Recieved message with raw bytes [B@394d3437
2023-03-20 20:55:27,922 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'asdf' and value 'jk;l'
2023-03-20 20:55:27,923 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 97, 115, 100, 102, 31, 106, 107, 59, 108, 31, 10]
2023-03-20 20:55:27,925 INFO  [Thread-3] root: Message: DATATRANSFERasdfjk;l

2023-03-20 20:55:27,925 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'asdf' and value 'jk;l'
2023-03-20 20:55:27,927 INFO  [Thread-3] root: Added key 'asdf' and value 'jk;l' to the database
2023-03-20 20:55:27,927 INFO  [Thread-3] root: MESSAGE TO SEND: jk;l
2023-03-20 20:55:27,927 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'asdf' and value 'jk;l'
2023-03-20 20:55:27,927 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6ff1c69c
2023-03-20 20:55:27,927 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 97, 115, 100, 102, 31, 106, 107, 59, 108, 31, 10]
2023-03-20 20:55:27,927 INFO  [main-EventThread] root: Message: PUT_SUCCESSasdfjk;l

2023-03-20 20:55:27,927 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'asdf' and value 'jk;l'
2023-03-20 20:55:27,927 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:55:27,928 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:55:27,929 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:55:27,929 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:55:27,929 INFO  [Thread-3] root: Closing connection
2023-03-20 20:55:33,567 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:55:33,568 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:55:33,568 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:55:33,568 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:55:33,569 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:55:33,569 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:55:33,570 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:55:33,571 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:55:33,571 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:55:33,572 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:55:33,573 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:55:33,573 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:55:33,574 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:55:33,575 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:55:33,576 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:55:33,577 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:55:33,585 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:55:33,589 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:55:33,594 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0014, negotiated timeout = 40000
2023-03-20 20:55:33,595 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:55:33,596 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:55:33,596 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:55:33,597 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0015, negotiated timeout = 40000
2023-03-20 20:55:33,603 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:55:33,605 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:55:33,610 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:55:33,611 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:55:33,611 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:55:33,612 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 20:55:33,613 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:55:33,614 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:55:33,615 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 20:55:33,615 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:55:33,615 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:55:33,615 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:55:33,616 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:55:33,617 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:55:33,617 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:55:33,617 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:55:33,617 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 20:55:33,618 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 20:55:33,618 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:55:33,618 INFO  [main-EventThread] root: Checking key key: ill
2023-03-20 20:55:33,619 INFO  [main-EventThread] root: Checking key key: asdf
2023-03-20 20:55:33,621 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:55:33,621 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:55:33,621 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:55:33,622 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:55:33,623 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:55:33,623 INFO  [Thread-0] root: Connected to localhost on port 47368
2023-03-20 20:55:33,623 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:55:33,623 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:55:33,624 INFO  [main-EventThread] root: Checking key key: ill
2023-03-20 20:55:33,624 INFO  [Thread-2] root: Closing connection
2023-03-20 20:55:33,625 INFO  [main-EventThread] root: Transferring key: ill
2023-03-20 20:55:33,626 INFO  [main-EventThread] root: Checking key key: asdf
2023-03-20 20:55:33,627 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:55:33,627 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:55:33,627 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:55:33,628 INFO  [Thread-0] root: Connected to localhost on port 47372
2023-03-20 20:55:33,629 INFO  [Thread-3] root: Recieved message with raw bytes [B@2939df6e
2023-03-20 20:55:33,629 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'ill' and value 'ness'
2023-03-20 20:55:33,630 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:55:33,631 INFO  [Thread-3] root: Message: DATATRANSFERillness

2023-03-20 20:55:33,631 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'ill' and value 'ness'
2023-03-20 20:55:33,636 INFO  [Thread-3] root: Added key 'ill' and value 'ness' to the database
2023-03-20 20:55:33,636 INFO  [Thread-3] root: MESSAGE TO SEND: ness
2023-03-20 20:55:33,636 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:55:33,636 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c1d9636
2023-03-20 20:55:33,636 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:55:33,636 INFO  [main-EventThread] root: Message: PUT_SUCCESSillness

2023-03-20 20:55:33,636 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:55:33,636 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:55:33,636 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:55:33,636 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:55:33,637 INFO  [Thread-3] root: Closing connection
2023-03-20 20:55:33,637 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 20:56:17,417 INFO  [Thread-2] root: Recieved message with raw bytes [B@7b210db0
2023-03-20 20:56:17,417 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 97, 115, 100, 102, 31, 31, 10]
2023-03-20 20:56:17,417 INFO  [Thread-2] root: Message: GETasdf

2023-03-20 20:56:17,418 INFO  [Thread-2] root: Received a message of type 'GET' with key 'asdf' and value ''
2023-03-20 20:56:17,418 INFO  [Thread-2] root: SERVER_IDLE
2023-03-20 20:56:17,419 INFO  [Thread-2] root: SERVER_IDLE
2023-03-20 20:56:17,419 INFO  [Thread-2] root: false
2023-03-20 20:56:17,419 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:56:17,419 INFO  [Thread-2] root: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:56:17,419 INFO  [Thread-2] root: THE KEY IS: 912ec803b2ce49e4a541068d495ab570
2023-03-20 20:56:17,419 INFO  [Thread-2] root: THE RANGE LOWER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 20:56:17,419 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:56:17,420 INFO  [Thread-2] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 20:56:17,420 INFO  [Thread-2] root: key.compareTo(hashRange[1] true
2023-03-20 20:56:17,420 INFO  [Thread-2] root: MESSAGE TO SEND: jk;l
2023-03-20 20:56:17,421 INFO  [Thread-2] root: Sent a message of type 'GET_SUCCESS' with key 'asdf' and value 'jk;l'
2023-03-20 20:56:19,016 INFO  [Thread-2] root: Recieved message with raw bytes [B@c9f0d3d
2023-03-20 20:56:19,017 INFO  [Thread-2] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 20:56:19,017 INFO  [Thread-2] root: Message: GETthis

2023-03-20 20:56:19,017 INFO  [Thread-2] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 20:56:19,017 INFO  [Thread-2] root: SERVER_IDLE
2023-03-20 20:56:19,017 INFO  [Thread-2] root: SERVER_IDLE
2023-03-20 20:56:19,017 INFO  [Thread-2] root: false
2023-03-20 20:56:19,017 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:56:19,017 INFO  [Thread-2] root: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:56:19,018 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 20:56:19,018 INFO  [Thread-2] root: THE RANGE LOWER IS: 85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 20:56:19,019 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:56:19,019 INFO  [Thread-2] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 20:56:19,019 INFO  [Thread-2] root: key.compareTo(hashRange[1] false
2023-03-20 20:56:19,020 INFO  [Thread-2] root: Server cannot service for key 'this'. Sending back metadata
2023-03-20 20:56:19,021 INFO  [Thread-2] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-20 20:56:19,021 INFO  [Thread-2] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-20 20:56:19,030 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:56:19,030 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:56:19,030 INFO  [Thread-2] root: Closing connection
2023-03-20 20:56:19,031 INFO  [Thread-4] root: Recieved message with raw bytes [B@7fd9edb
2023-03-20 20:56:19,031 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 20:56:19,031 INFO  [Thread-4] root: Message: GETthis

2023-03-20 20:56:19,031 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 20:56:19,031 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 20:56:19,031 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 20:56:19,032 INFO  [Thread-4] root: false
2023-03-20 20:56:19,032 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:56:19,032 INFO  [Thread-0] root: Connected to localhost on port 37008
2023-03-20 20:56:19,032 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:56:19,032 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 20:56:19,033 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:56:19,033 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:56:19,033 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 20:56:19,033 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 20:56:19,033 ERROR [Thread-4] root: Key 'this' is not in the database
2023-03-20 20:56:19,033 INFO  [Thread-4] root: MESSAGE TO SEND: 
2023-03-20 20:56:19,033 INFO  [Thread-4] root: Sent a message of type 'GET_ERROR' with key 'this' and value ''
2023-03-20 20:56:24,388 INFO  [Thread-4] root: Recieved message with raw bytes [B@48076a6f
2023-03-20 20:56:24,388 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 105, 108, 108, 31, 31, 10]
2023-03-20 20:56:24,388 INFO  [Thread-4] root: Message: GETill

2023-03-20 20:56:24,388 INFO  [Thread-4] root: Received a message of type 'GET' with key 'ill' and value ''
2023-03-20 20:56:24,388 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 20:56:24,388 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 20:56:24,388 INFO  [Thread-4] root: false
2023-03-20 20:56:24,388 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:56:24,388 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:56:24,389 INFO  [Thread-4] root: THE KEY IS: 2f9c691594932556ef427450338a74b7
2023-03-20 20:56:24,389 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:56:24,390 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:56:24,391 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:56:24,391 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:56:24,392 INFO  [Thread-4] root: MESSAGE TO SEND: ness
2023-03-20 20:56:24,393 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:56:46,591 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 20:56:46,592 INFO  [Thread-1] root: Checking key key: ill
2023-03-20 20:56:46,592 INFO  [Thread-1] root: Transferring key: ill
2023-03-20 20:56:46,593 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 20:56:46,593 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:56:46,593 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 20:56:46,594 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'ill' and value 'ness'
2023-03-20 20:56:46,594 INFO  [Thread-3] root: Recieved message with raw bytes [B@19bd39f9
2023-03-20 20:56:46,595 INFO  [Thread-0] root: Connected to localhost on port 55610
2023-03-20 20:56:46,595 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:56:46,597 INFO  [Thread-3] root: Message: DATATRANSFERillness

2023-03-20 20:56:46,597 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'ill' and value 'ness'
2023-03-20 20:56:46,599 INFO  [Thread-3] root: Added key 'ill' and value 'ness' to the database
2023-03-20 20:56:46,599 INFO  [Thread-3] root: MESSAGE TO SEND: ness
2023-03-20 20:56:46,599 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:56:46,599 INFO  [Thread-1] root: Recieved message with raw bytes [B@5bf33ea6
2023-03-20 20:56:46,599 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 105, 108, 108, 31, 110, 101, 115, 115, 31, 10]
2023-03-20 20:56:46,599 INFO  [Thread-1] root: Message: PUT_SUCCESSillness

2023-03-20 20:56:46,599 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'ill' and value 'ness'
2023-03-20 20:56:46,599 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 20:56:46,599 INFO  [Thread-1] root: Closing connection
2023-03-20 20:56:46,599 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:56:46,600 INFO  [Thread-3] root: Closing connection
2023-03-20 20:56:46,606 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:56:46,608 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:56:46,611 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:56:46,612 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 20:56:46,613 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:56:46,613 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:56:46,615 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:56:49,712 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:56:49,713 INFO  [Thread-1] root: Checking key key: ill
2023-03-20 20:56:49,715 INFO  [Thread-1] root: Transferring key: ill
2023-03-20 20:56:49,715 INFO  [Thread-1] root: Checking key key: asdf
2023-03-20 20:56:49,715 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:56:49,722 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:56:49,726 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:56:58,582 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:56:58,582 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:56:58,582 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:56:58,583 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:56:58,583 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:56:58,584 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:56:58,584 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:56:58,585 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:56:58,585 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:56:58,586 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:56:58,586 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:56:58,587 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:56:58,587 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:56:58,588 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:56:58,589 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:56:58,590 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:56:58,598 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:56:58,603 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:56:58,607 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0016, negotiated timeout = 40000
2023-03-20 20:56:58,608 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:56:58,609 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:56:58,609 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:56:58,611 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0017, negotiated timeout = 40000
2023-03-20 20:56:58,616 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:56:58,618 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:56:58,624 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:56:58,624 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 20:56:58,627 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:56:58,628 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,91d8c8e93642cca5c0f2be69d199ee22,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:56:58,629 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:56:58,629 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 20:56:58,630 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:57:37,365 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 20:57:37,366 INFO  [Thread-1] root: Checking key key: ill
2023-03-20 20:57:37,367 INFO  [Thread-1] root: Transferring key: ill
2023-03-20 20:57:37,367 INFO  [Thread-1] root: Checking key key: asdf
2023-03-20 20:57:37,369 INFO  [Thread-1] root: Transferring key: asdf
2023-03-20 20:57:37,372 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:57:45,702 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:57:45,702 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:57:45,703 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:57:45,704 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:57:45,704 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:57:45,705 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:57:45,705 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:57:45,706 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:57:45,706 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:57:45,707 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:57:45,707 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:57:45,708 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:57:45,708 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:57:45,709 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:57:45,709 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:57:45,710 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:57:45,719 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:57:45,723 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:57:45,728 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0018, negotiated timeout = 40000
2023-03-20 20:57:45,729 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:57:45,730 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:57:45,730 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:57:45,732 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0019, negotiated timeout = 40000
2023-03-20 20:57:45,737 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:57:45,741 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:57:45,746 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:57:45,747 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 20:57:48,011 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:57:48,011 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:57:48,011 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:57:48,012 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:57:48,013 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:57:48,013 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:57:48,014 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:57:48,014 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:57:48,015 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:57:48,015 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:57:48,016 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:57:48,016 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:57:48,017 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:57:48,018 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:57:48,018 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:57:48,019 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:57:48,027 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:57:48,031 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:57:48,036 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c001a, negotiated timeout = 40000
2023-03-20 20:57:48,037 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:57:48,038 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:57:48,038 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:57:48,040 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c001b, negotiated timeout = 40000
2023-03-20 20:57:48,045 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:57:48,047 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:57:48,052 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:57:48,053 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 20:57:59,556 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:57:59,557 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:57:59,557 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:57:59,557 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:57:59,557 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:57:59,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:57:59,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:57:59,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:57:59,559 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:57:59,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:57:59,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:57:59,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:57:59,561 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:57:59,561 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:57:59,562 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:57:59,562 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:57:59,571 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:57:59,575 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:57:59,579 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c001e, negotiated timeout = 40000
2023-03-20 20:57:59,580 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:57:59,581 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:57:59,581 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:57:59,583 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c001f, negotiated timeout = 40000
2023-03-20 20:57:59,588 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:57:59,590 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:57:59,594 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:57:59,595 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 20:57:59,601 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:57:59,602 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:57:59,603 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:57:59,603 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 20:57:59,604 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:01,088 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:58:01,088 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:58:01,089 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:58:01,089 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:58:01,090 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:58:01,091 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:58:01,091 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:58:01,092 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:58:01,102 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:58:01,107 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:58:01,111 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0020, negotiated timeout = 40000
2023-03-20 20:58:01,112 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:58:01,113 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:58:01,113 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:58:01,115 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0021, negotiated timeout = 40000
2023-03-20 20:58:01,120 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:58:01,125 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:58:01,129 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:01,130 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:58:01,131 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 20:58:01,133 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:58:01,134 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:01,134 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:58:01,135 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:01,135 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:01,135 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 20:58:01,136 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:58:01,136 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:01,136 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:01,138 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:58:01,138 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:01,139 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:58:01,139 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:58:01,140 INFO  [Thread-0] root: Connected to localhost on port 52516
2023-03-20 20:58:01,140 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:58:01,142 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:58:01,142 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:01,143 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:01,143 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:58:01,144 INFO  [Thread-0] root: Connected to localhost on port 52528
2023-03-20 20:58:01,143 INFO  [Thread-2] root: Closing connection
2023-03-20 20:58:01,144 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:58:01,146 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:58:01,146 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:58:01,147 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:01,147 INFO  [Thread-3] root: Closing connection
2023-03-20 20:58:01,147 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:58:10,254 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 20:58:10,254 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 20:58:10,254 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 20:58:10,255 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:10,255 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 20:58:10,256 INFO  [Thread-1] root: Closing connection
2023-03-20 20:58:10,256 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:10,257 INFO  [Thread-0] root: Connected to localhost on port 53570
2023-03-20 20:58:10,257 INFO  [Thread-2] root: Closing connection
2023-03-20 20:58:10,266 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:10,269 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:58:10,270 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:10,270 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:10,270 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:18,681 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:18,682 INFO  [Thread-0] root: Connected to localhost on port 57404
2023-03-20 20:58:20,176 INFO  [Thread-3] root: Recieved message with raw bytes [B@53cafad3
2023-03-20 20:58:20,176 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:58:20,176 INFO  [Thread-3] root: Message: PUTthisthat

2023-03-20 20:58:20,177 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-20 20:58:20,177 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:20,178 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:58:20,179 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 20:58:20,179 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:58:20,180 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:20,181 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 20:58:20,181 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 20:58:20,182 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:20,182 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:58:20,183 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 20:58:20,183 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:58:20,184 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:20,185 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 20:58:20,185 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 20:58:20,190 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 20:58:20,190 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 20:58:20,190 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:58:25,043 INFO  [Thread-3] root: Recieved message with raw bytes [B@894e03c
2023-03-20 20:58:25,043 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:25,043 INFO  [Thread-3] root: Message: PUThithere

2023-03-20 20:58:25,043 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'hi' and value 'there'
2023-03-20 20:58:25,043 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:25,043 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:58:25,044 INFO  [Thread-3] root: THE KEY IS: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 20:58:25,044 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:58:25,044 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:25,044 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:58:25,044 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:58:25,044 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:25,044 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:58:25,045 INFO  [Thread-3] root: THE KEY IS: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 20:58:25,046 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:58:25,046 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:25,047 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 20:58:25,047 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 20:58:25,049 INFO  [Thread-3] root: Added key 'hi' and value 'there' to the database
2023-03-20 20:58:25,049 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 20:58:25,049 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:27,306 INFO  [Thread-3] root: Recieved message with raw bytes [B@6a3e9cec
2023-03-20 20:58:27,306 INFO  [Thread-3] root: Raw bytes: [80, 85, 84, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 20:58:27,306 INFO  [Thread-3] root: Message: PUTfoobar

2023-03-20 20:58:27,306 INFO  [Thread-3] root: Received a message of type 'PUT' with key 'foo' and value 'bar'
2023-03-20 20:58:27,306 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:27,306 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:58:27,306 INFO  [Thread-3] root: THE KEY IS: acbd18db4cc2f85cedef654fccc4a4d8
2023-03-20 20:58:27,306 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:58:27,306 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:27,307 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 20:58:27,307 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 20:58:27,307 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:27,307 INFO  [Thread-3] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 20:58:27,308 INFO  [Thread-3] root: THE KEY IS: acbd18db4cc2f85cedef654fccc4a4d8
2023-03-20 20:58:27,308 INFO  [Thread-3] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 20:58:27,309 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 20:58:27,309 INFO  [Thread-3] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 20:58:27,310 INFO  [Thread-3] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 20:58:27,311 INFO  [Thread-3] root: Added key 'foo' and value 'bar' to the database
2023-03-20 20:58:27,311 INFO  [Thread-3] root: MESSAGE TO SEND: bar
2023-03-20 20:58:27,311 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 20:58:30,634 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:58:30,634 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:58:30,634 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:58:30,635 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:58:30,635 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:58:30,636 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:58:30,636 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:58:30,637 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:58:30,638 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:58:30,638 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:58:30,639 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:58:30,639 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:58:30,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:58:30,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:58:30,641 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:58:30,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:58:30,650 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:58:30,655 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:58:30,659 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0022, negotiated timeout = 40000
2023-03-20 20:58:30,660 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:58:30,661 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:58:30,661 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:58:30,663 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0023, negotiated timeout = 40000
2023-03-20 20:58:30,668 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:58:30,670 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:58:30,675 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:30,675 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:58:30,676 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 20:58:30,677 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:58:30,677 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:30,677 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:58:30,678 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:30,679 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:30,679 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:30,679 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 20:58:30,680 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:58:30,680 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:30,680 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 20:58:30,681 INFO  [main-EventThread] root: Transferring key: hi
2023-03-20 20:58:30,681 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 20:58:30,682 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 20:58:30,682 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:58:30,683 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 20:58:30,685 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:58:30,685 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:30,685 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:58:30,686 INFO  [Thread-2] root: Recieved message with raw bytes [B@3a366ef2
2023-03-20 20:58:30,686 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 20:58:30,687 INFO  [Thread-0] root: Connected to localhost on port 39896
2023-03-20 20:58:30,686 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:30,688 INFO  [Thread-2] root: Message: DATATRANSFERhithere

2023-03-20 20:58:30,689 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 20:58:30,693 INFO  [Thread-2] root: Added key 'hi' and value 'there' to the database
2023-03-20 20:58:30,694 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 20:58:30,694 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:30,694 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3a5f8a9a
2023-03-20 20:58:30,694 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:30,694 INFO  [main-EventThread] root: Message: PUT_SUCCESShithere

2023-03-20 20:58:30,694 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:30,694 INFO  [Thread-2] root: Recieved message with raw bytes [B@14e39f7c
2023-03-20 20:58:30,694 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 20:58:30,694 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 20:58:30,696 INFO  [Thread-2] root: Message: DATATRANSFERfoobar

2023-03-20 20:58:30,696 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 20:58:30,698 INFO  [Thread-2] root: Added key 'foo' and value 'bar' to the database
2023-03-20 20:58:30,698 INFO  [Thread-2] root: MESSAGE TO SEND: bar
2023-03-20 20:58:30,698 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 20:58:30,698 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c45b5e2
2023-03-20 20:58:30,698 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 20:58:30,698 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 20:58:30,698 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 20:58:30,699 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:58:30,699 INFO  [Thread-2] root: Recieved message with raw bytes [B@43e46108
2023-03-20 20:58:30,699 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:58:30,699 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 20:58:30,700 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:58:30,701 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 20:58:30,701 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 20:58:30,701 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:58:30,701 INFO  [main-EventThread] root: Recieved message with raw bytes [B@514cf53a
2023-03-20 20:58:30,701 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:58:30,701 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 20:58:30,701 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:58:30,701 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:58:30,701 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:58:30,701 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:30,701 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 20:58:30,702 INFO  [Thread-2] root: Closing connection
2023-03-20 20:58:30,703 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 20:58:30,704 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 20:58:30,704 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:58:30,705 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:58:30,705 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:30,705 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 20:58:30,706 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:58:30,707 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:58:30,706 INFO  [Thread-0] root: Connected to localhost on port 39904
2023-03-20 20:58:30,707 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:58:30,707 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:30,709 INFO  [Thread-3] root: Closing connection
2023-03-20 20:58:33,556 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 20:58:33,556 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 20:58:33,557 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 20:58:33,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 20:58:33,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 20:58:33,559 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 20:58:33,559 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 20:58:33,559 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 20:58:33,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 20:58:33,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 20:58:33,561 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 20:58:33,561 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 20:58:33,562 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 20:58:33,563 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 20:58:33,563 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 20:58:33,564 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 20:58:33,573 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:58:33,577 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:58:33,581 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0024, negotiated timeout = 40000
2023-03-20 20:58:33,582 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 20:58:33,583 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 20:58:33,583 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 20:58:33,585 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0025, negotiated timeout = 40000
2023-03-20 20:58:33,590 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:58:33,592 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 20:58:33,597 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:58:33,598 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:33,598 INFO  [Thread-0] root: Initialize server ...
2023-03-20 20:58:33,599 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 20:58:33,601 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:58:33,602 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:33,602 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 20:58:33,603 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:33,603 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 20:58:33,603 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:33,604 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 20:58:33,604 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:33,605 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:58:33,605 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 20:58:33,605 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 20:58:33,606 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:33,606 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 20:58:33,606 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:33,607 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 20:58:33,607 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:58:33,609 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:58:33,609 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:33,610 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:58:33,610 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:58:33,611 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:58:33,611 INFO  [Thread-0] root: Connected to localhost on port 56950
2023-03-20 20:58:33,612 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:33,612 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:58:33,613 INFO  [Thread-2] root: Closing connection
2023-03-20 20:58:33,613 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 20:58:33,614 INFO  [main-EventThread] root: Transferring key: hi
2023-03-20 20:58:33,615 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 20:58:33,615 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 20:58:33,615 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 20:58:33,616 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 20:58:33,617 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 20:58:33,617 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:33,617 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 20:58:33,618 INFO  [Thread-0] root: Connected to localhost on port 56958
2023-03-20 20:58:33,618 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 20:58:33,618 INFO  [Thread-3] root: Recieved message with raw bytes [B@2939df6e
2023-03-20 20:58:33,620 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:33,620 INFO  [Thread-3] root: Message: DATATRANSFERhithere

2023-03-20 20:58:33,621 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 20:58:33,625 INFO  [Thread-3] root: Added key 'hi' and value 'there' to the database
2023-03-20 20:58:33,625 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 20:58:33,625 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:33,625 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2414a02b
2023-03-20 20:58:33,625 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:33,625 INFO  [main-EventThread] root: Message: PUT_SUCCESShithere

2023-03-20 20:58:33,625 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:33,626 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 20:58:33,626 INFO  [Thread-3] root: Recieved message with raw bytes [B@32798dbd
2023-03-20 20:58:33,627 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 20:58:33,628 INFO  [Thread-3] root: Message: DATATRANSFERfoobar

2023-03-20 20:58:33,628 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 20:58:33,629 INFO  [Thread-3] root: Added key 'foo' and value 'bar' to the database
2023-03-20 20:58:33,630 INFO  [Thread-3] root: MESSAGE TO SEND: bar
2023-03-20 20:58:33,630 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 20:58:33,630 INFO  [main-EventThread] root: Recieved message with raw bytes [B@4847e289
2023-03-20 20:58:33,630 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 20:58:33,630 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 20:58:33,630 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 20:58:33,630 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:58:33,630 INFO  [Thread-3] root: Recieved message with raw bytes [B@2e0efde7
2023-03-20 20:58:33,631 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:58:33,631 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 20:58:33,632 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 20:58:33,633 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 20:58:33,633 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 20:58:33,633 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:58:33,633 INFO  [main-EventThread] root: Recieved message with raw bytes [B@79389a25
2023-03-20 20:58:33,633 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 20:58:33,633 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 20:58:33,633 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 20:58:33,633 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 20:58:33,633 INFO  [main-EventThread] root: Closing connection
2023-03-20 20:58:33,633 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:33,634 INFO  [Thread-3] root: Closing connection
2023-03-20 20:58:33,634 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 20:58:42,567 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 20:58:42,569 INFO  [Thread-1] root: Checking key key: hi
2023-03-20 20:58:42,569 INFO  [Thread-1] root: Transferring key: hi
2023-03-20 20:58:42,569 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 20:58:42,570 INFO  [Thread-1] root: Checking key key: this
2023-03-20 20:58:42,570 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 20:58:42,570 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 20:58:42,571 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 20:58:42,572 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 20:58:42,572 INFO  [Thread-4] root: Recieved message with raw bytes [B@361febe
2023-03-20 20:58:42,572 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:42,573 INFO  [Thread-0] root: Connected to localhost on port 44864
2023-03-20 20:58:42,573 INFO  [Thread-4] root: Message: DATATRANSFERhithere

2023-03-20 20:58:42,574 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 20:58:42,576 INFO  [Thread-4] root: Added key 'hi' and value 'there' to the database
2023-03-20 20:58:42,576 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 20:58:42,576 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:42,576 INFO  [Thread-1] root: Recieved message with raw bytes [B@1ab2b767
2023-03-20 20:58:42,576 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 20:58:42,576 INFO  [Thread-1] root: Message: PUT_SUCCESShithere

2023-03-20 20:58:42,576 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 20:58:42,576 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 20:58:42,576 INFO  [Thread-1] root: Closing connection
2023-03-20 20:58:42,577 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:58:42,578 INFO  [Thread-4] root: Closing connection
2023-03-20 20:58:42,584 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:42,585 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:58:42,587 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 20:58:42,588 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 20:58:42,589 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 20:58:42,590 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:58:42,591 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 20:59:02,011 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 20:59:02,012 INFO  [Thread-1] root: Checking key key: hi
2023-03-20 20:59:02,013 INFO  [Thread-1] root: Transferring key: hi
2023-03-20 20:59:02,013 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 20:59:02,013 INFO  [Thread-1] root: Checking key key: this
2023-03-20 20:59:02,014 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 20:59:02,023 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 20:59:02,026 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:00:58,139 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:00:58,139 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:00:58,139 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:00:58,140 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:00:58,141 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:00:58,141 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:00:58,142 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:00:58,142 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:00:58,143 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:00:58,144 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:00:58,144 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:00:58,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:00:58,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:00:58,146 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:00:58,146 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:00:58,147 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:00:58,156 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:00:58,160 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:00:58,164 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0026, negotiated timeout = 40000
2023-03-20 21:00:58,165 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:00:58,166 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:00:58,166 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:00:58,168 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0027, negotiated timeout = 40000
2023-03-20 21:00:58,173 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:00:58,175 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:00:58,181 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:00:58,182 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:00:58,186 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:00:58,187 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,91d8c8e93642cca5c0f2be69d199ee22,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:00:58,187 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 21:00:58,187 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:00:58,188 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:01:07,054 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:01:07,054 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:01:07,054 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:01:07,055 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:01:07,055 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:01:07,056 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:01:07,057 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:01:07,057 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:01:07,058 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:01:07,059 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:01:07,059 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:01:07,060 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:01:07,060 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:01:07,061 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:01:07,061 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:01:07,062 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:01:07,071 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:01:07,075 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:01:07,079 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0028, negotiated timeout = 40000
2023-03-20 21:01:07,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:01:07,081 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:01:07,081 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:01:07,083 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0029, negotiated timeout = 40000
2023-03-20 21:01:07,088 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:01:07,090 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:01:07,096 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:01:07,096 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:01:07,096 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:01:07,097 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:01:07,098 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:01:07,099 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:01:07,099 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:01:07,100 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:01:07,100 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:01:07,101 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:01:07,101 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:01:07,101 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:01:07,102 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:01:07,102 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:01:07,102 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8083
2023-03-20 21:01:07,102 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:01:07,102 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 21:01:07,103 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:01:07,103 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 21:01:07,104 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:01:07,104 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:01:07,105 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:01:07,105 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:01:07,105 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:01:07,106 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:01:07,106 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:01:07,107 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:01:07,107 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:01:07,106 INFO  [Thread-0] root: Connected to localhost on port 60194
2023-03-20 21:01:07,107 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:01:07,107 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:01:07,108 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:01:07,107 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:01:07,108 INFO  [Thread-0] root: Connected to localhost on port 37588
2023-03-20 21:01:07,108 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 21:01:07,108 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:01:07,108 INFO  [Thread-2] root: Closing connection
2023-03-20 21:01:07,110 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:01:07,110 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:01:07,110 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:01:07,110 INFO  [Thread-2] root: Closing connection
2023-03-20 21:01:07,112 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:01:07,112 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:01:07,113 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:01:07,113 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 21:01:07,113 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:01:07,113 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:01:07,113 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:01:07,114 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:01:07,114 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:01:07,115 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:01:07,115 INFO  [Thread-0] root: Connected to localhost on port 60208
2023-03-20 21:01:07,115 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:01:07,115 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:01:07,115 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:01:07,116 INFO  [Thread-0] root: Connected to localhost on port 37594
2023-03-20 21:01:07,116 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:01:07,117 INFO  [Thread-3] root: Recieved message with raw bytes [B@76b56bd6
2023-03-20 21:01:07,117 INFO  [Thread-3] root: Closing connection
2023-03-20 21:01:07,117 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:01:07,117 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:01:07,117 INFO  [Thread-3] root: Message: DATATRANSFERfoobar

2023-03-20 21:01:07,116 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:01:07,117 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:01:07,121 INFO  [Thread-3] root: Added key 'foo' and value 'bar' to the database
2023-03-20 21:01:07,121 INFO  [Thread-3] root: MESSAGE TO SEND: bar
2023-03-20 21:01:07,122 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3a5f8a9a
2023-03-20 21:01:07,122 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:01:07,122 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:01:07,122 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 21:01:07,122 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:01:07,122 INFO  [Thread-3] root: Recieved message with raw bytes [B@1246b334
2023-03-20 21:01:07,122 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:01:07,122 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:01:07,123 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:01:07,124 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:01:07,126 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:01:07,126 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c45b5e2
2023-03-20 21:01:07,126 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:01:07,126 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:01:07,126 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:01:07,127 INFO  [Thread-3] root: Closing connection
2023-03-20 21:01:21,718 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 21:01:21,719 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:01:21,720 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:01:21,720 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:01:21,720 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:01:21,721 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:01:21,721 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:01:21,722 INFO  [Thread-0] root: Connected to localhost on port 40736
2023-03-20 21:01:21,722 INFO  [Thread-1] root: Closing connection
2023-03-20 21:01:21,722 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:01:21,723 INFO  [Thread-5] root: Closing connection
2023-03-20 21:01:21,729 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:01:21,730 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:01:21,732 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:01:21,733 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 21:01:21,734 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:01:21,734 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:01:21,735 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:02:06,715 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:02:06,716 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:02:06,716 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:02:06,717 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:06,728 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:06,731 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:21,590 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:02:21,598 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:32,431 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:02:32,431 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:02:32,431 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:02:32,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:02:32,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:02:32,433 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:02:32,433 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:02:32,434 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:02:32,435 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:02:32,435 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:02:32,436 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:02:32,436 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:02:32,437 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:02:32,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:02:32,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:02:32,439 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:02:32,448 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:32,452 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:32,456 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c002c, negotiated timeout = 40000
2023-03-20 21:02:32,457 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:02:32,458 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:32,458 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:32,460 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c002d, negotiated timeout = 40000
2023-03-20 21:02:32,466 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:32,468 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:32,473 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:02:32,474 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:02:32,479 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:02:32,480 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:02:32,481 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:02:32,481 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:02:32,482 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:02:34,192 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:02:34,192 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:02:34,198 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:02:34,199 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:02:34,199 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:02:34,200 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:02:34,200 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:02:34,201 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:02:34,201 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:02:34,202 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:02:34,202 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:02:34,203 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:02:34,204 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:02:34,204 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:02:34,211 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:02:34,212 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:02:34,220 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:34,224 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:34,228 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c002e, negotiated timeout = 40000
2023-03-20 21:02:34,230 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:02:34,230 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:34,240 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:34,242 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c002f, negotiated timeout = 40000
2023-03-20 21:02:34,255 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:34,262 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:34,275 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:02:34,277 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:02:34,279 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:02:34,280 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:02:34,281 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:02:34,281 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:34,281 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:34,282 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:02:34,282 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:02:34,282 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:02:34,282 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:02:34,282 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:02:34,298 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:02:34,299 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:02:34,301 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:02:34,301 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:34,301 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:02:34,301 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:02:34,301 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:02:34,301 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:02:34,302 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:34,302 INFO  [Thread-2] root: Closing connection
2023-03-20 21:02:34,302 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:02:34,303 INFO  [Thread-0] root: Connected to localhost on port 45938
2023-03-20 21:02:34,303 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 21:02:34,304 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:02:34,305 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:02:34,305 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:02:34,305 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:34,306 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:02:34,307 INFO  [Thread-0] root: Connected to localhost on port 45950
2023-03-20 21:02:34,307 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:02:34,307 INFO  [Thread-3] root: Recieved message with raw bytes [B@549ff7e9
2023-03-20 21:02:34,308 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:02:34,309 INFO  [Thread-3] root: Message: DATATRANSFERfoobar

2023-03-20 21:02:34,310 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:02:34,314 INFO  [Thread-3] root: Added key 'foo' and value 'bar' to the database
2023-03-20 21:02:34,314 INFO  [Thread-3] root: MESSAGE TO SEND: bar
2023-03-20 21:02:34,314 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:02:34,314 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2475ea05
2023-03-20 21:02:34,314 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:02:34,314 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 21:02:34,314 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:02:34,315 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:02:34,315 INFO  [Thread-3] root: Recieved message with raw bytes [B@3f988d78
2023-03-20 21:02:34,316 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:02:34,316 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:02:34,317 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:02:34,319 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:02:34,319 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:02:34,319 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:02:34,319 INFO  [main-EventThread] root: Recieved message with raw bytes [B@796afc3c
2023-03-20 21:02:34,319 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:02:34,319 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:02:34,319 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:02:34,320 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:02:34,320 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:02:34,321 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:34,331 INFO  [Thread-3] root: Closing connection
2023-03-20 21:02:34,321 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:38,653 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:02:38,654 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:02:38,654 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:02:38,657 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:38,657 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:02:38,658 INFO  [Thread-0] root: Connected to localhost on port 45964
2023-03-20 21:02:38,658 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:02:38,659 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:02:38,659 INFO  [Thread-1] root: Closing connection
2023-03-20 21:02:38,660 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:38,661 INFO  [Thread-4] root: Closing connection
2023-03-20 21:02:38,670 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:38,673 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:02:38,674 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:38,674 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:02:38,675 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:45,734 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:02:45,734 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:02:45,734 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:02:45,735 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:02:45,735 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:02:45,736 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:02:45,737 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:02:45,737 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:02:45,738 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:02:45,739 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:02:45,739 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:02:45,740 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:02:45,740 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:02:45,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:02:45,741 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:02:45,742 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:02:45,751 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:45,755 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:45,759 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0030, negotiated timeout = 40000
2023-03-20 21:02:45,760 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:02:45,761 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:45,761 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:45,763 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0031, negotiated timeout = 40000
2023-03-20 21:02:45,768 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:45,770 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:45,774 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:45,775 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:02:45,776 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:02:45,777 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:02:45,778 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,91d8c8e93642cca5c0f2be69d199ee22,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:45,778 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:02:45,779 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,91d8c8e93642cca5c0f2be69d199ee22,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:45,779 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 21:02:45,779 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 21:02:45,779 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 21:02:45,780 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:02:45,780 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:45,781 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:02:45,781 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 21:02:45,782 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:02:45,783 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:02:45,784 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:02:45,784 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:45,785 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:02:45,786 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:02:45,786 INFO  [Thread-2] root: Recieved message with raw bytes [B@659ae474
2023-03-20 21:02:45,786 INFO  [Thread-0] root: Connected to localhost on port 48416
2023-03-20 21:02:45,787 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:02:45,788 INFO  [Thread-2] root: Message: DATATRANSFERfoobar

2023-03-20 21:02:45,789 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:02:45,793 INFO  [Thread-2] root: Added key 'foo' and value 'bar' to the database
2023-03-20 21:02:45,793 INFO  [Thread-2] root: MESSAGE TO SEND: bar
2023-03-20 21:02:45,794 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:02:45,794 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2414a02b
2023-03-20 21:02:45,794 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:02:45,794 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 21:02:45,794 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:02:45,794 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:02:45,794 INFO  [Thread-2] root: Recieved message with raw bytes [B@44715dd5
2023-03-20 21:02:45,795 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:02:45,795 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:02:45,796 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:02:45,797 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:02:45,797 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:02:45,797 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:02:45,798 INFO  [main-EventThread] root: Recieved message with raw bytes [B@4847e289
2023-03-20 21:02:45,798 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:02:45,798 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:02:45,798 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:02:45,798 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:02:45,798 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:02:45,798 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:45,798 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:02:45,799 INFO  [Thread-2] root: Closing connection
2023-03-20 21:02:45,800 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:02:45,800 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:02:45,801 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:02:45,801 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:45,801 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:02:45,802 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:02:45,802 INFO  [Thread-0] root: Connected to localhost on port 48432
2023-03-20 21:02:45,803 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:02:45,804 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:45,804 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:02:45,805 INFO  [Thread-3] root: Closing connection
2023-03-20 21:02:50,210 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:02:50,211 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:02:50,211 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:02:50,212 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:02:50,213 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:02:50,213 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:02:50,214 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:02:50,215 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:02:50,215 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:02:50,216 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:02:50,217 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:02:50,217 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:02:50,218 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:02:50,218 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:02:50,219 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:02:50,220 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:02:50,229 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:50,233 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:50,236 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0032, negotiated timeout = 40000
2023-03-20 21:02:50,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:02:50,238 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:02:50,238 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:02:50,240 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0033, negotiated timeout = 40000
2023-03-20 21:02:50,245 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:50,247 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:02:50,252 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:02:50,252 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:02:50,253 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:50,253 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:02:50,255 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:02:50,256 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:50,256 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:02:50,257 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:50,257 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:02:50,258 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:02:50,258 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:02:50,258 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:02:50,258 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:02:50,258 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8083
2023-03-20 21:02:50,260 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:02:50,260 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:02:50,260 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:02:50,260 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:02:50,260 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 21:02:50,260 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:02:50,261 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:02:50,263 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:02:50,263 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:50,264 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:02:50,265 INFO  [Thread-2] root: Recieved message with raw bytes [B@d0ec4d
2023-03-20 21:02:50,265 INFO  [Thread-0] root: Connected to localhost on port 55002
2023-03-20 21:02:50,265 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:02:50,265 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:02:50,267 INFO  [Thread-2] root: Message: DATATRANSFERfoobar

2023-03-20 21:02:50,268 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:02:50,273 INFO  [Thread-2] root: Added key 'foo' and value 'bar' to the database
2023-03-20 21:02:50,273 INFO  [Thread-2] root: MESSAGE TO SEND: bar
2023-03-20 21:02:50,273 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:02:50,273 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5cb0c166
2023-03-20 21:02:50,273 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:02:50,273 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 21:02:50,273 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:02:50,273 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:02:50,273 INFO  [Thread-2] root: Recieved message with raw bytes [B@68bf51b0
2023-03-20 21:02:50,273 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:02:50,273 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:02:50,273 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:02:50,274 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:02:50,274 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:02:50,274 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:02:50,275 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6ff1c69c
2023-03-20 21:02:50,275 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:02:50,275 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:02:50,275 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:02:50,275 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:02:50,275 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:02:50,275 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:50,275 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:02:50,276 INFO  [Thread-2] root: Closing connection
2023-03-20 21:02:50,277 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:02:50,278 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:02:50,279 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:02:50,279 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:02:50,279 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:02:50,280 INFO  [Thread-0] root: Connected to localhost on port 55014
2023-03-20 21:02:50,280 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:02:50,282 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:02:50,282 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:02:50,283 INFO  [Thread-3] root: Closing connection
2023-03-20 21:02:50,282 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:00,834 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 21:03:00,835 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:03:00,835 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:03:00,836 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:03:00,836 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:03:00,836 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:03:00,838 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:03:00,838 INFO  [Thread-1] root: Closing connection
2023-03-20 21:03:00,838 INFO  [Thread-0] root: Connected to localhost on port 58422
2023-03-20 21:03:00,838 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:00,840 INFO  [Thread-5] root: Closing connection
2023-03-20 21:03:00,847 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:00,848 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:00,850 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:03:00,851 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 21:03:00,852 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:00,852 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:00,853 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:23,513 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:03:23,514 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:03:23,514 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:03:23,515 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:03:23,515 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:03:23,516 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:03:23,517 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:03:23,517 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:03:23,518 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:03:23,519 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:03:23,519 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:03:23,520 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:03:23,520 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:03:23,521 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:03:23,521 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:03:23,522 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:03:23,531 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:03:23,535 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:03:23,539 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0034, negotiated timeout = 40000
2023-03-20 21:03:23,541 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:03:23,541 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:03:23,541 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:03:23,543 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0035, negotiated timeout = 40000
2023-03-20 21:03:23,548 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:03:23,550 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:03:23,555 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:23,556 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:03:23,557 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:03:23,557 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:03:23,557 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:03:23,558 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:03:23,558 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:03:23,559 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:03:23,559 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:23,559 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:03:23,560 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:03:23,561 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:23,561 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:23,562 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 21:03:23,562 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:03:23,563 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:23,563 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:03:23,563 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:23,563 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:03:23,565 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:03:23,565 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:03:23,566 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:03:23,566 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:03:23,567 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:03:23,567 INFO  [Thread-0] root: Connected to localhost on port 59732
2023-03-20 21:03:23,567 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:03:23,567 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:23,569 INFO  [main-EventThread] root: Checking key key: foo
2023-03-20 21:03:23,569 INFO  [Thread-2] root: Closing connection
2023-03-20 21:03:23,570 INFO  [main-EventThread] root: Transferring key: foo
2023-03-20 21:03:23,570 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:03:23,571 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:03:23,572 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:03:23,572 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:03:23,572 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:03:23,573 INFO  [Thread-0] root: Connected to localhost on port 59748
2023-03-20 21:03:23,573 INFO  [Thread-3] root: Recieved message with raw bytes [B@549ff7e9
2023-03-20 21:03:23,573 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:03:23,574 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:03:23,575 INFO  [Thread-3] root: Message: DATATRANSFERfoobar

2023-03-20 21:03:23,576 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'foo' and value 'bar'
2023-03-20 21:03:23,580 INFO  [Thread-3] root: Added key 'foo' and value 'bar' to the database
2023-03-20 21:03:23,580 INFO  [Thread-3] root: MESSAGE TO SEND: bar
2023-03-20 21:03:23,580 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:03:23,580 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2475ea05
2023-03-20 21:03:23,581 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 102, 111, 111, 31, 98, 97, 114, 31, 10]
2023-03-20 21:03:23,581 INFO  [main-EventThread] root: Message: PUT_SUCCESSfoobar

2023-03-20 21:03:23,581 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'foo' and value 'bar'
2023-03-20 21:03:23,581 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:03:23,581 INFO  [Thread-3] root: Recieved message with raw bytes [B@3f988d78
2023-03-20 21:03:23,581 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:03:23,581 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:03:23,582 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:03:23,583 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:03:23,583 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:03:23,584 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Recieved message with raw bytes [B@796afc3c
2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:03:23,584 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:23,585 INFO  [Thread-3] root: Closing connection
2023-03-20 21:03:23,584 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:03:27,969 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 21:03:27,969 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:03:27,970 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:03:27,971 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:03:27,971 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:03:27,971 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:03:27,971 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:03:27,972 INFO  [Thread-1] root: Closing connection
2023-03-20 21:03:27,972 ERROR [Thread-6] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:27,973 INFO  [Thread-6] root: Closing connection
2023-03-20 21:03:27,972 INFO  [Thread-0] root: Connected to localhost on port 53524
2023-03-20 21:03:27,979 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:27,980 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:27,985 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:03:27,986 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 21:03:27,987 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:27,988 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:27,988 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:51,757 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:03:51,757 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:03:51,758 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:03:51,759 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:51,765 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:51,768 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:56,196 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:03:56,196 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:03:56,197 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:03:56,197 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:59,652 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:03:59,652 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:03:59,653 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:03:59,653 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:03:59,654 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:03:59,655 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:03:59,655 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:03:59,656 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:03:59,656 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:03:59,657 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:03:59,657 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:03:59,658 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:03:59,659 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:03:59,659 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:03:59,660 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:03:59,660 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:03:59,669 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:03:59,673 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:03:59,677 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0038, negotiated timeout = 40000
2023-03-20 21:03:59,679 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:03:59,679 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:03:59,679 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:03:59,681 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0039, negotiated timeout = 40000
2023-03-20 21:03:59,686 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:03:59,688 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:03:59,692 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:59,693 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:03:59,694 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:03:59,695 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:03:59,695 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:03:59,696 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:03:59,696 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:03:59,697 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:59,697 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:03:59,697 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:03:59,698 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:03:59,698 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:03:59,701 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:03:59,701 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:03:59,701 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:03:59,702 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:03:59,703 INFO  [Thread-0] root: Connected to localhost on port 57220
2023-03-20 21:03:59,703 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:03:59,704 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:59,704 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:03:59,704 INFO  [Thread-2] root: Closing connection
2023-03-20 21:03:59,705 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:03:59,705 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:03:59,706 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:03:59,706 INFO  [Thread-0] root: Connected to localhost on port 57230
2023-03-20 21:03:59,706 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:03:59,707 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:03:59,708 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:03:59,708 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:03:59,708 INFO  [Thread-3] root: Closing connection
2023-03-20 21:04:02,907 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:04:02,908 INFO  [Thread-1] root: Checking key key: foo
2023-03-20 21:04:02,908 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:04:02,909 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:04:02,909 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:04:02,909 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:04:02,910 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:04:02,911 INFO  [Thread-1] root: Closing connection
2023-03-20 21:04:02,911 INFO  [Thread-0] root: Connected to localhost on port 53556
2023-03-20 21:04:02,912 ERROR [Thread-7] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:04:02,913 INFO  [Thread-7] root: Closing connection
2023-03-20 21:04:02,921 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:04:02,924 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:04:02,925 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:04:02,925 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:04:02,925 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:04:22,518 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:04:22,518 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:04:22,518 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:04:22,519 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:04:22,519 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:04:22,520 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:04:22,521 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:04:22,521 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:04:22,522 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:04:22,522 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:04:22,523 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:04:22,523 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:04:22,523 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:04:22,524 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:04:22,524 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:04:22,525 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:04:22,534 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:04:22,538 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:04:22,542 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c003c, negotiated timeout = 40000
2023-03-20 21:04:22,544 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:04:22,544 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:04:22,545 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:04:22,546 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c003d, negotiated timeout = 40000
2023-03-20 21:04:22,551 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:04:22,553 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:04:22,558 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:04:22,559 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:04:22,566 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:04:22,567 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:04:22,568 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:04:22,568 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:04:22,569 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:04:49,590 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:04:49,590 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:04:49,590 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:04:49,591 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:04:49,592 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:04:49,592 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:04:49,593 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:04:49,593 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:04:49,594 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:04:49,595 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:04:49,595 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:04:49,596 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:04:49,596 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:04:49,597 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:04:49,598 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:04:49,599 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:04:49,607 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:04:49,611 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:04:49,622 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0040, negotiated timeout = 40000
2023-03-20 21:04:49,624 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:04:49,624 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:04:49,625 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:04:49,626 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0041, negotiated timeout = 40000
2023-03-20 21:04:49,632 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:04:49,634 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:04:49,639 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:04:49,640 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:04:49,645 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:04:49,646 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:04:49,647 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:04:49,647 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:04:49,648 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:04:59,540 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:04:59,542 INFO  [Thread-0] root: Connected to localhost on port 50724
2023-03-20 21:05:01,176 INFO  [Thread-2] root: Recieved message with raw bytes [B@42620f36
2023-03-20 21:05:01,176 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:05:01,176 INFO  [Thread-2] root: Message: PUTthisthat

2023-03-20 21:05:01,177 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'this' and value 'that'
2023-03-20 21:05:01,177 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:01,177 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:05:01,178 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:05:01,179 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:05:01,179 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:01,180 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 21:05:01,180 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:05:01,181 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:01,182 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:05:01,183 INFO  [Thread-2] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:05:01,183 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:05:01,183 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:01,184 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 21:05:01,184 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:05:01,189 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:05:01,189 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:05:01,189 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:05:02,737 INFO  [Thread-2] root: Recieved message with raw bytes [B@77b11309
2023-03-20 21:05:02,737 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:02,737 INFO  [Thread-2] root: Message: PUTherethere

2023-03-20 21:05:02,737 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'here' and value 'there'
2023-03-20 21:05:02,738 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:02,738 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:05:02,738 INFO  [Thread-2] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:05:02,738 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:05:02,739 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:02,739 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:05:02,740 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 21:05:02,741 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:02,742 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:05:02,743 INFO  [Thread-2] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:05:02,743 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:05:02,743 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:02,744 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:05:02,745 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 21:05:02,747 INFO  [Thread-2] root: Added key 'here' and value 'there' to the database
2023-03-20 21:05:02,747 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:05:02,747 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:07,248 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:05:07,248 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:05:07,249 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:05:07,250 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:05:07,250 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:05:07,251 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:05:07,251 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:05:07,252 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:05:07,253 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:05:07,253 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:05:07,254 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:05:07,254 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:05:07,255 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:05:07,255 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:05:07,256 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:05:07,257 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:05:07,266 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:05:07,270 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:05:07,274 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0042, negotiated timeout = 40000
2023-03-20 21:05:07,275 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:05:07,276 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:05:07,276 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:05:07,277 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0043, negotiated timeout = 40000
2023-03-20 21:05:07,282 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:05:07,284 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:05:07,289 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:07,289 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:05:07,290 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:05:07,291 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:05:07,292 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:05:07,292 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:05:07,292 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:05:07,293 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:05:07,293 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:05:07,293 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:05:07,294 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:05:07,294 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:07,295 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:05:07,296 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:05:07,296 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:05:07,298 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:05:07,298 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:05:07,299 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:05:07,300 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:05:07,300 INFO  [Thread-0] root: Connected to localhost on port 58928
2023-03-20 21:05:07,300 INFO  [Thread-2] root: Recieved message with raw bytes [B@d0ec4d
2023-03-20 21:05:07,301 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:05:07,302 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:05:07,302 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:05:07,307 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:05:07,307 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:05:07,307 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:05:07,307 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c1d9636
2023-03-20 21:05:07,308 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:05:07,308 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:05:07,308 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:05:07,308 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:05:07,308 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:05:07,308 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:05:07,308 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:05:07,309 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:05:07,309 INFO  [Thread-2] root: Closing connection
2023-03-20 21:05:07,310 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:05:07,311 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:05:07,312 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:05:07,312 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:05:07,312 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:05:07,313 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:05:07,314 INFO  [Thread-0] root: Connected to localhost on port 58940
2023-03-20 21:05:07,313 INFO  [Thread-3] root: Recieved message with raw bytes [B@5ba3234c
2023-03-20 21:05:07,315 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:07,315 INFO  [Thread-3] root: Message: DATATRANSFERherethere

2023-03-20 21:05:07,316 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:05:07,317 INFO  [Thread-3] root: Added key 'here' and value 'there' to the database
2023-03-20 21:05:07,317 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 21:05:07,317 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:07,317 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2ac6177c
2023-03-20 21:05:07,317 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:07,317 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:05:07,318 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:07,318 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:05:07,319 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:05:07,319 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:05:07,320 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:05:07,320 INFO  [Thread-3] root: Closing connection
2023-03-20 21:05:15,801 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:05:15,802 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:05:15,802 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:05:15,802 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:05:15,802 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:05:15,803 INFO  [Thread-0] root: Connected to localhost on port 60158
2023-03-20 21:05:15,803 INFO  [Thread-1] root: Closing connection
2023-03-20 21:05:15,804 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:05:15,805 INFO  [Thread-3] root: Closing connection
2023-03-20 21:05:15,810 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:15,813 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:05:15,814 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:05:15,815 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:15,815 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:24,453 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:05:24,453 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:05:24,454 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:05:24,455 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:05:24,455 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:05:24,456 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:05:24,456 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:05:24,457 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:05:24,457 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:05:24,458 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:05:24,458 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:05:24,459 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:05:24,459 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:05:24,460 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:05:24,460 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:05:24,461 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:05:24,469 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:05:24,473 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:05:24,477 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0044, negotiated timeout = 40000
2023-03-20 21:05:24,479 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:05:24,479 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:05:24,480 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:05:24,481 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0045, negotiated timeout = 40000
2023-03-20 21:05:24,487 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:05:24,488 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:05:24,494 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:24,494 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:05:24,495 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:05:24,496 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:05:24,496 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,91d8c8e93642cca5c0f2be69d199ee22,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:05:24,497 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:05:24,497 INFO  [main-EventThread] root: 127.0.0.1:8084,127.0.0.1,8084,91d8c8e93642cca5c0f2be69d199ee22,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:05:24,498 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 21:05:24,498 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:85d27949e81cbe4c3d605c59cd7d7dc3
2023-03-20 21:05:24,498 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 21:05:24,499 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:05:24,499 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:24,500 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:05:24,501 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:05:24,501 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:05:24,502 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:05:24,504 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:05:24,504 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:05:24,505 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:05:24,505 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:05:24,505 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b2e3e6a
2023-03-20 21:05:24,506 INFO  [Thread-0] root: Connected to localhost on port 40254
2023-03-20 21:05:24,506 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:24,507 INFO  [Thread-2] root: Message: DATATRANSFERherethere

2023-03-20 21:05:24,508 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:05:24,513 INFO  [Thread-2] root: Added key 'here' and value 'there' to the database
2023-03-20 21:05:24,513 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:05:24,513 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:24,513 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3ab404a
2023-03-20 21:05:24,513 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:24,513 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:05:24,513 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:24,514 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:05:24,514 INFO  [Thread-2] root: Recieved message with raw bytes [B@7b173050
2023-03-20 21:05:24,515 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:05:24,515 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:05:24,516 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:05:24,517 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:05:24,517 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:05:24,517 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:05:24,517 INFO  [main-EventThread] root: Recieved message with raw bytes [B@346d0820
2023-03-20 21:05:24,517 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:05:24,517 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:05:24,517 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:05:24,517 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:05:24,517 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:05:24,517 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:05:24,517 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:05:24,518 INFO  [Thread-2] root: Closing connection
2023-03-20 21:05:24,519 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:05:24,520 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:05:24,521 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:05:24,521 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:05:24,521 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:05:24,522 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:05:24,522 INFO  [Thread-0] root: Connected to localhost on port 40260
2023-03-20 21:05:24,522 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:05:24,523 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:05:24,524 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:05:24,524 INFO  [Thread-3] root: Closing connection
2023-03-20 21:05:30,696 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 21:05:30,697 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:05:30,697 INFO  [Thread-1] root: Transferring key: here
2023-03-20 21:05:30,698 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:05:30,699 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:05:30,699 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:05:30,699 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:05:30,700 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:05:30,700 INFO  [Thread-4] root: Recieved message with raw bytes [B@80b0fa
2023-03-20 21:05:30,701 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:30,701 INFO  [Thread-0] root: Connected to localhost on port 49782
2023-03-20 21:05:30,701 INFO  [Thread-4] root: Message: DATATRANSFERherethere

2023-03-20 21:05:30,703 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:05:30,704 INFO  [Thread-4] root: Added key 'here' and value 'there' to the database
2023-03-20 21:05:30,704 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 21:05:30,704 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:30,704 INFO  [Thread-1] root: Recieved message with raw bytes [B@50568c0c
2023-03-20 21:05:30,704 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:05:30,704 INFO  [Thread-1] root: Message: PUT_SUCCESSherethere

2023-03-20 21:05:30,704 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:05:30,704 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:05:30,704 INFO  [Thread-1] root: Closing connection
2023-03-20 21:05:30,705 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:05:30,705 INFO  [Thread-4] root: Closing connection
2023-03-20 21:05:30,711 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:05:30,713 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:05:30,714 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:05:30,714 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:05:30,714 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:40,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:08:40,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:08:40,433 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:08:40,434 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:08:40,434 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:08:40,435 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:08:40,435 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:08:40,436 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:08:40,437 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:08:40,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:08:40,438 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:08:40,439 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:08:40,439 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:08:40,440 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:08:40,440 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:08:40,441 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:08:40,450 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:08:40,454 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:08:40,458 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0046, negotiated timeout = 40000
2023-03-20 21:08:40,460 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:08:40,460 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:08:40,461 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:08:40,462 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0047, negotiated timeout = 40000
2023-03-20 21:08:40,467 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:08:40,469 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:08:40,473 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:40,474 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:08:40,475 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:08:40,476 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:08:40,477 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:40,477 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:08:40,478 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:40,478 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:40,478 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:40,479 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:08:40,479 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:08:40,479 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:40,480 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:08:40,480 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:08:40,481 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:08:40,483 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:08:40,483 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:08:40,483 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:08:40,484 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:08:40,484 INFO  [Thread-2] root: Recieved message with raw bytes [B@d0ec4d
2023-03-20 21:08:40,485 INFO  [Thread-0] root: Connected to localhost on port 38882
2023-03-20 21:08:40,485 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:08:40,486 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:08:40,487 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:08:40,491 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:08:40,491 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:08:40,491 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:08:40,491 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c1d9636
2023-03-20 21:08:40,491 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:08:40,491 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:08:40,491 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:08:40,492 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:08:40,492 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:08:40,493 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:08:40,494 INFO  [Thread-2] root: Closing connection
2023-03-20 21:08:40,493 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:08:40,496 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:08:40,496 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:08:40,496 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:08:40,498 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:08:40,498 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:08:40,498 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:08:40,499 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:08:40,499 INFO  [Thread-3] root: Recieved message with raw bytes [B@950f790
2023-03-20 21:08:40,499 INFO  [Thread-0] root: Connected to localhost on port 38890
2023-03-20 21:08:40,500 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:08:40,502 INFO  [Thread-3] root: Message: DATATRANSFERherethere

2023-03-20 21:08:40,502 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:08:40,504 INFO  [Thread-3] root: Added key 'here' and value 'there' to the database
2023-03-20 21:08:40,504 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 21:08:40,504 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:08:40,504 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2ac6177c
2023-03-20 21:08:40,504 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:08:40,504 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:08:40,504 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:08:40,505 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:08:40,505 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:08:40,506 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:08:40,507 INFO  [Thread-3] root: Closing connection
2023-03-20 21:08:40,506 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:41,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:08:41,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:08:41,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:08:41,946 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:08:41,947 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:08:41,948 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:08:41,949 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:08:41,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:08:41,950 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:08:41,951 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:08:41,952 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:08:41,953 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:08:41,953 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:08:41,954 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:08:41,954 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:08:41,955 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:08:41,965 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:08:41,969 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:08:41,973 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0048, negotiated timeout = 40000
2023-03-20 21:08:41,975 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:08:41,975 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:08:41,975 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:08:41,977 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0049, negotiated timeout = 40000
2023-03-20 21:08:41,982 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:08:41,985 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:08:41,989 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:41,990 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:41,990 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:08:41,991 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:08:41,991 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:08:41,992 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:41,993 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:08:41,993 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:41,994 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:41,994 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:08:41,995 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:41,996 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:41,996 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:41,996 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 21:08:41,996 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:08:41,997 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:41,998 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:08:41,998 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:41,998 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:08:41,998 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:08:42,001 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:08:42,001 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:08:42,002 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:08:42,003 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:08:42,003 INFO  [Thread-0] root: Connected to localhost on port 56172
2023-03-20 21:08:42,003 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b2e3e6a
2023-03-20 21:08:42,005 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:08:42,006 INFO  [Thread-2] root: Message: DATATRANSFERherethere

2023-03-20 21:08:42,007 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:08:42,012 INFO  [Thread-2] root: Added key 'here' and value 'there' to the database
2023-03-20 21:08:42,012 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:08:42,013 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:08:42,013 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5cb0c166
2023-03-20 21:08:42,013 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:08:42,013 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:08:42,013 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:08:42,013 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:08:42,013 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:08:42,013 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:08:42,013 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:08:42,014 INFO  [Thread-2] root: Closing connection
2023-03-20 21:08:42,015 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:08:42,016 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:08:42,017 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:08:42,018 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:08:42,018 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:08:42,018 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:08:42,019 INFO  [Thread-0] root: Connected to localhost on port 56174
2023-03-20 21:08:42,020 INFO  [Thread-3] root: Recieved message with raw bytes [B@1a794b4f
2023-03-20 21:08:42,020 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:08:42,021 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:08:42,022 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:08:42,023 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:08:42,025 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:08:42,025 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:08:42,025 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:08:42,025 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6ff1c69c
2023-03-20 21:08:42,025 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:08:42,025 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:08:42,025 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:08:42,025 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:08:42,026 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:08:42,027 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:08:42,027 INFO  [Thread-3] root: Closing connection
2023-03-20 21:08:42,027 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:08:45,427 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 21:08:45,427 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:08:45,428 INFO  [Thread-1] root: Transferring key: here
2023-03-20 21:08:45,429 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:08:45,430 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:08:45,430 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:08:45,430 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:08:45,432 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:08:45,432 INFO  [Thread-5] root: Recieved message with raw bytes [B@408c5a3d
2023-03-20 21:08:45,433 INFO  [Thread-0] root: Connected to localhost on port 53226
2023-03-20 21:08:45,433 INFO  [Thread-5] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:08:45,434 INFO  [Thread-5] root: Message: DATATRANSFERherethere

2023-03-20 21:08:45,435 INFO  [Thread-5] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:08:45,437 INFO  [Thread-5] root: Added key 'here' and value 'there' to the database
2023-03-20 21:08:45,437 INFO  [Thread-5] root: MESSAGE TO SEND: there
2023-03-20 21:08:45,437 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:08:45,437 INFO  [Thread-1] root: Recieved message with raw bytes [B@2a361627
2023-03-20 21:08:45,437 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:08:45,438 INFO  [Thread-1] root: Message: PUT_SUCCESSherethere

2023-03-20 21:08:45,438 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:08:45,438 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:08:45,438 INFO  [Thread-1] root: Closing connection
2023-03-20 21:08:45,438 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:08:45,438 INFO  [Thread-5] root: Closing connection
2023-03-20 21:08:45,444 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:45,445 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:45,449 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:08:45,450 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 21:08:45,450 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:45,451 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:45,452 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:50,854 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:08:50,855 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:50,855 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:08:50,856 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:50,856 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:53,415 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:08:53,415 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:08:53,415 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:08:53,416 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:08:53,417 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:08:53,418 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:08:53,418 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:08:53,419 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:08:53,420 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:08:53,421 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:08:53,421 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:08:53,422 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:08:53,423 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:08:53,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:08:53,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:08:53,425 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:08:53,435 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:08:53,439 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:08:53,443 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c004c, negotiated timeout = 40000
2023-03-20 21:08:53,444 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:08:53,445 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:08:53,445 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:08:53,447 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c004d, negotiated timeout = 40000
2023-03-20 21:08:53,452 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:08:53,454 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:08:53,459 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:53,460 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:08:53,460 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:08:53,461 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:08:53,462 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:53,462 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:08:53,463 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:53,463 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:08:53,464 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:08:53,465 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:08:53,465 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:08:53,466 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:09:05,175 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:09:05,175 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:09:05,176 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:09:05,177 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:09:05,178 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:09:05,178 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:09:05,179 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:09:05,180 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:09:05,180 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:09:05,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:09:05,182 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:09:05,182 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:09:05,183 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:09:05,184 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:09:05,185 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:09:05,186 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:09:05,194 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:09:05,199 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:09:05,203 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c004e, negotiated timeout = 40000
2023-03-20 21:09:05,204 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:09:05,205 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:09:05,205 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:09:05,207 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c004f, negotiated timeout = 40000
2023-03-20 21:09:05,212 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:09:05,214 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:603)
2023-03-20 21:09:05,219 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:09:05,219 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:09:05,220 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:09:05,220 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 21:09:05,222 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:09:05,223 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:09:05,224 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 21:09:05,224 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:09:05,225 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:09:05,225 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:09:05,225 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:09:05,226 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:09:05,226 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:09:05,226 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:09:05,227 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:09:05,227 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 21:09:05,228 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 21:09:05,229 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:09:05,230 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:09:05,230 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:09:05,233 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:09:05,233 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:09:05,233 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:09:05,235 INFO  [Thread-0] root: Connected to localhost on port 57812
2023-03-20 21:09:05,235 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b2e3e6a
2023-03-20 21:09:05,235 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:09:05,236 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:09:05,238 INFO  [Thread-2] root: Message: DATATRANSFERherethere

2023-03-20 21:09:05,238 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:09:05,243 INFO  [Thread-2] root: Added key 'here' and value 'there' to the database
2023-03-20 21:09:05,243 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:09:05,243 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:09:05,243 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5cb0c166
2023-03-20 21:09:05,243 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:09:05,243 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:09:05,243 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:09:05,243 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:09:05,243 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:09:05,243 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:09:05,243 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:09:05,244 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:09:05,245 INFO  [Thread-2] root: Closing connection
2023-03-20 21:09:05,246 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:09:05,247 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:09:05,248 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:09:05,248 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:09:05,249 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:09:05,251 INFO  [Thread-0] root: Connected to localhost on port 57820
2023-03-20 21:09:05,251 INFO  [Thread-3] root: Recieved message with raw bytes [B@1a794b4f
2023-03-20 21:09:05,251 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:09:05,253 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:09:05,254 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:09:05,255 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:09:05,257 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:09:05,257 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:09:05,257 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6ff1c69c
2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:09:05,257 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:09:05,257 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:09:05,257 INFO  [Thread-3] root: Closing connection
2023-03-20 21:09:10,248 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 21:09:10,249 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:09:10,249 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:09:10,250 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:09:10,250 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:09:10,251 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8084
2023-03-20 21:09:10,252 INFO  [Thread-0] root: Connected to localhost on port 57822
2023-03-20 21:09:10,252 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:09:10,253 INFO  [Thread-1] root: Closing connection
2023-03-20 21:09:10,253 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:09:10,254 INFO  [Thread-4] root: Closing connection
2023-03-20 21:09:10,261 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:09:10,261 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:09:10,266 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:09:10,267 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,d41d8cd98f00b204e9800998ecf8427e,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:09:10,267 INFO  [main-EventThread] root: d41d8cd98f00b204e9800998ecf8427e:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:09:10,268 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:09:10,268 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 21:14:07,624 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 21:14:07,625 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:14:07,627 INFO  [Thread-1] root: Transferring key: here
2023-03-20 21:14:07,627 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:14:07,629 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:14:07,629 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:14:07,629 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:14:07,630 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:14:07,631 INFO  [Thread-6] root: Recieved message with raw bytes [B@1d8ce899
2023-03-20 21:14:07,631 INFO  [Thread-6] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:14:07,632 INFO  [Thread-0] root: Connected to localhost on port 41124
2023-03-20 21:14:07,632 INFO  [Thread-6] root: Message: DATATRANSFERherethere

2023-03-20 21:14:07,634 INFO  [Thread-6] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:14:07,635 INFO  [Thread-6] root: Added key 'here' and value 'there' to the database
2023-03-20 21:14:07,635 INFO  [Thread-6] root: MESSAGE TO SEND: there
2023-03-20 21:14:07,635 INFO  [Thread-6] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:14:07,636 INFO  [Thread-1] root: Recieved message with raw bytes [B@3675d787
2023-03-20 21:14:07,636 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:14:07,636 INFO  [Thread-1] root: Message: PUT_SUCCESSherethere

2023-03-20 21:14:07,636 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:14:07,636 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:14:07,636 INFO  [Thread-1] root: Closing connection
2023-03-20 21:14:07,636 ERROR [Thread-6] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:14:07,636 INFO  [Thread-6] root: Closing connection
2023-03-20 21:14:08,359 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:14:08,360 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:14:08,361 INFO  [Thread-1] root: Transferring key: here
2023-03-20 21:14:08,362 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:14:08,370 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:185)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:219)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:223)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:14:30,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:14:30,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:14:30,424 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:14:30,425 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:14:30,426 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:14:30,426 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:14:30,427 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:14:30,428 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:14:30,428 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:14:30,429 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:14:30,430 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:14:30,431 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:14:30,431 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:14:30,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:14:30,432 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:14:30,433 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:14:30,441 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:14:30,446 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:14:30,450 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0052, negotiated timeout = 40000
2023-03-20 21:14:30,451 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:14:30,451 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:14:30,452 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:14:30,453 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0053, negotiated timeout = 40000
2023-03-20 21:14:30,459 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:14:30,460 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:14:30,465 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:14:30,466 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:14:30,472 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:14:30,473 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:14:30,474 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:14:30,474 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:14:30,474 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:14:48,329 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:14:48,329 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:14:48,330 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:14:48,331 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:14:48,332 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:14:48,332 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:14:48,333 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:14:48,333 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:14:48,334 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:14:48,335 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:14:48,336 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:14:48,336 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:14:48,337 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:14:48,338 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:14:48,339 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:14:48,340 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:14:48,348 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:14:48,352 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:14:48,356 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0054, negotiated timeout = 40000
2023-03-20 21:14:48,358 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:14:48,358 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:14:48,359 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:14:48,361 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0055, negotiated timeout = 40000
2023-03-20 21:14:48,366 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:14:48,368 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:14:48,374 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:14:48,374 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:14:48,375 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:14:48,376 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:14:48,377 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:14:48,377 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:14:48,378 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:14:48,379 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:14:48,379 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:14:48,379 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:14:48,379 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:14:48,380 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:14:48,381 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:14:48,381 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:14:48,383 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:14:48,383 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:14:48,383 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:14:48,385 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:14:48,385 INFO  [Thread-0] root: Connected to localhost on port 59152
2023-03-20 21:14:48,385 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b2e3e6a
2023-03-20 21:14:48,387 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:14:48,388 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:14:48,389 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:14:48,394 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:14:48,394 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:14:48,394 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:14:48,394 INFO  [main-EventThread] root: Recieved message with raw bytes [B@5cb0c166
2023-03-20 21:14:48,394 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:14:48,394 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:14:48,395 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:14:48,395 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:14:48,395 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:14:48,395 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:14:48,395 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:14:48,396 INFO  [Thread-2] root: Closing connection
2023-03-20 21:14:48,396 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:14:48,398 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:14:48,398 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:14:48,398 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:14:48,400 INFO  [Thread-0] root: Connected to localhost on port 59166
2023-03-20 21:14:48,400 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:14:48,401 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:14:48,402 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:14:48,402 INFO  [Thread-3] root: Closing connection
2023-03-20 21:14:48,402 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:15:01,444 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:15:01,445 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:15:01,445 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:15:01,445 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:15:01,445 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:15:01,446 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:15:01,446 INFO  [Thread-1] root: Closing connection
2023-03-20 21:15:01,446 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:15:01,447 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:15:01,448 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:15:01,448 INFO  [Thread-0] root: Connected to localhost on port 50798
2023-03-20 21:15:01,448 INFO  [Thread-2] root: Closing connection
2023-03-20 21:15:01,449 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:15:01,450 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:15:01,451 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:16:00,074 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:16:00,075 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:16:00,076 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:16:00,076 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:16:00,077 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:16:00,077 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:16:00,078 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:16:00,079 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:16:00,079 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:16:00,080 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:16:00,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:16:00,081 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:16:00,082 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:16:00,083 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:16:00,083 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:16:00,084 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:16:00,093 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:00,097 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:00,101 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0058, negotiated timeout = 40000
2023-03-20 21:16:00,102 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:16:00,103 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:00,103 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:00,105 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0059, negotiated timeout = 40000
2023-03-20 21:16:00,110 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:00,112 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:00,117 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:16:00,118 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:16:00,124 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:16:00,125 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:16:00,126 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:16:00,126 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:16:00,127 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:16:05,138 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:16:05,138 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:16:05,139 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:16:05,140 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:16:05,140 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:16:05,141 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:16:05,141 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:16:05,142 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:16:05,143 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:16:05,144 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:16:05,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:16:05,145 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:16:05,146 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:16:05,146 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:16:05,147 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:16:05,148 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:16:05,157 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:05,161 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:05,164 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c005a, negotiated timeout = 40000
2023-03-20 21:16:05,166 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:16:05,166 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:05,167 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:05,168 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c005b, negotiated timeout = 40000
2023-03-20 21:16:05,174 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:05,175 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:05,180 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:16:05,180 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:16:05,182 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:16:05,183 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:16:05,183 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:16:05,183 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:16:05,184 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:16:05,185 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:05,185 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:16:05,186 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:05,186 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:16:05,187 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:16:05,189 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:16:05,190 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:16:05,190 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:16:05,190 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:16:05,191 INFO  [Thread-0] root: Connected to localhost on port 47034
2023-03-20 21:16:05,191 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:16:05,192 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:16:05,192 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:16:05,193 INFO  [Thread-2] root: Closing connection
2023-03-20 21:16:05,194 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:16:05,194 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:16:05,195 INFO  [Thread-0] root: Connected to localhost on port 47036
2023-03-20 21:16:05,195 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:16:05,196 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:16:05,197 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:16:05,197 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:16:05,197 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:05,198 INFO  [Thread-3] root: Closing connection
2023-03-20 21:16:07,992 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:16:07,993 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:07,995 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:16:07,995 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:16:07,995 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:16:07,995 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:16:07,995 INFO  [Thread-1] root: Closing connection
2023-03-20 21:16:07,995 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:16:07,995 INFO  [Thread-0] root: Connected to localhost on port 47044
2023-03-20 21:16:07,995 INFO  [Thread-4] root: Closing connection
2023-03-20 21:16:07,996 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:16:07,997 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:16:07,998 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:07,998 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:09,236 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:16:09,236 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:16:09,236 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:16:09,237 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:16:09,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:16:09,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:16:09,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:16:09,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:16:09,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:16:09,238 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:16:09,247 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:09,251 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:09,255 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c005c, negotiated timeout = 40000
2023-03-20 21:16:09,257 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:16:09,257 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:09,258 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:09,259 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c005d, negotiated timeout = 40000
2023-03-20 21:16:09,264 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:09,266 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:09,271 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:09,271 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:16:09,272 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:16:09,273 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:16:09,274 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:16:09,274 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:16:09,275 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:16:09,275 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:09,276 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:09,276 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:09,276 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:16:09,277 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:16:09,278 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:16:09,280 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:16:09,280 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:16:09,280 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:16:09,282 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:16:09,282 INFO  [Thread-0] root: Connected to localhost on port 58950
2023-03-20 21:16:09,283 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:16:09,284 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:16:09,284 INFO  [Thread-2] root: Closing connection
2023-03-20 21:16:09,284 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:16:09,286 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:16:09,286 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:16:09,287 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:16:09,287 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:16:09,287 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:16:09,289 INFO  [Thread-0] root: Connected to localhost on port 58954
2023-03-20 21:16:09,289 INFO  [Thread-3] root: Recieved message with raw bytes [B@1ed5091d
2023-03-20 21:16:09,289 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:16:09,290 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:16:09,291 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:16:09,292 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:16:09,296 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:16:09,296 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:16:09,296 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:16:09,296 INFO  [main-EventThread] root: Recieved message with raw bytes [B@71de63a0
2023-03-20 21:16:09,296 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:16:09,296 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:16:09,297 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:16:09,297 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:16:09,297 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:16:09,297 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:16:09,297 INFO  [Thread-3] root: Closing connection
2023-03-20 21:16:09,297 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:16:15,240 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:16:15,240 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:16:15,241 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:16:15,241 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:16:15,241 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:15,241 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:16:15,242 INFO  [Thread-0] root: Connected to localhost on port 51144
2023-03-20 21:16:15,243 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:16:15,243 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:16:15,243 INFO  [Thread-1] root: Closing connection
2023-03-20 21:16:15,244 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:16:15,244 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:16:15,244 INFO  [Thread-5] root: Closing connection
2023-03-20 21:16:15,245 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:15,245 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:50,375 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:16:50,375 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:16:50,376 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:16:50,376 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:16:59,863 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:16:59,864 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:16:59,864 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:16:59,864 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:16:59,864 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:16:59,865 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:16:59,874 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:59,878 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:59,882 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0060, negotiated timeout = 40000
2023-03-20 21:16:59,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:16:59,884 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:16:59,884 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:16:59,886 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0061, negotiated timeout = 40000
2023-03-20 21:16:59,891 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:59,893 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:16:59,898 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:16:59,899 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:16:59,899 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:16:59,900 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:16:59,901 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:16:59,901 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:16:59,901 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:17:01,443 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:17:01,444 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:17:01,444 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:17:01,445 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:17:01,446 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:17:01,446 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:17:01,447 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:17:01,447 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:17:01,448 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:17:01,449 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:17:01,449 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:17:01,450 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:17:01,450 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:17:01,451 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:17:01,452 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:17:01,452 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:17:01,461 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:17:01,465 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:17:01,468 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0062, negotiated timeout = 40000
2023-03-20 21:17:01,470 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:17:01,470 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:17:01,470 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:17:01,472 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0063, negotiated timeout = 40000
2023-03-20 21:17:01,477 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:17:01,479 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:17:01,484 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:17:01,485 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:17:01,486 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:17:01,487 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:17:01,489 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:17:01,489 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:17:01,490 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:17:01,491 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:17:01,491 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:17:01,491 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:17:01,491 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:17:01,492 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:17:01,492 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:17:01,493 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:17:01,495 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:17:01,495 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:17:01,495 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:17:01,497 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:17:01,497 INFO  [Thread-2] root: Recieved message with raw bytes [B@41e5ddae
2023-03-20 21:17:01,497 INFO  [Thread-0] root: Connected to localhost on port 41520
2023-03-20 21:17:01,497 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:17:01,498 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:17:01,499 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:17:01,503 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:17:01,503 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:17:01,503 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:17:01,503 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3a5f8a9a
2023-03-20 21:17:01,503 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:17:01,503 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:17:01,503 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:17:01,504 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:17:01,504 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:17:01,504 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:17:01,504 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:17:01,505 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:17:01,505 INFO  [Thread-2] root: Closing connection
2023-03-20 21:17:01,506 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:17:01,506 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:17:01,507 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:17:01,508 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:17:01,508 INFO  [Thread-0] root: Connected to localhost on port 41536
2023-03-20 21:17:01,509 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:17:01,510 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:17:01,510 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:17:01,510 INFO  [Thread-3] root: Closing connection
2023-03-20 21:17:08,800 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:17:08,801 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:17:08,803 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:17:08,804 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:17:08,804 INFO  [Thread-0] root: Connected to localhost on port 43434
2023-03-20 21:17:08,805 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:17:08,805 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:17:08,805 INFO  [Thread-1] root: Closing connection
2023-03-20 21:17:08,806 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:17:08,807 INFO  [Thread-4] root: Closing connection
2023-03-20 21:17:08,816 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:17:08,818 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:17:08,819 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:17:08,819 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:17:08,820 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:18:03,575 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:18:03,575 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:18:03,575 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:18:03,576 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:18:03,576 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:18:03,577 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:18:03,577 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:18:03,578 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:18:03,578 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:18:03,579 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:18:03,580 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:18:03,580 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:18:03,581 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:18:03,581 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:18:03,582 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:18:03,583 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:18:03,591 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:18:03,595 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:18:03,599 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0064, negotiated timeout = 40000
2023-03-20 21:18:03,601 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:18:03,601 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:18:03,601 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:18:03,603 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0065, negotiated timeout = 40000
2023-03-20 21:18:03,609 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:18:03,611 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:18:03,614 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:18:03,615 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:18:03,616 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:18:03,616 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:18:03,617 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:18:03,618 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:18:03,618 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:03,619 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:18:03,619 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:18:03,620 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:03,621 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:18:03,621 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:18:03,623 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:18:03,623 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:03,624 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:18:03,624 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:18:03,625 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:18:03,625 INFO  [Thread-0] root: Connected to localhost on port 43088
2023-03-20 21:18:03,626 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:03,627 INFO  [Thread-2] root: Closing connection
2023-03-20 21:18:03,626 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:18:03,628 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:18:03,628 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:03,628 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:18:03,629 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:18:03,629 INFO  [Thread-0] root: Connected to localhost on port 43090
2023-03-20 21:18:03,629 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:18:03,630 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:03,630 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:18:03,631 INFO  [Thread-3] root: Closing connection
2023-03-20 21:18:08,996 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:18:08,997 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:18:08,997 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:18:08,997 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:08,999 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:18:08,999 INFO  [Thread-1] root: Closing connection
2023-03-20 21:18:08,999 INFO  [Thread-0] root: Connected to localhost on port 43098
2023-03-20 21:18:09,000 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:09,002 INFO  [Thread-4] root: Closing connection
2023-03-20 21:18:09,009 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:18:09,011 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:18:09,012 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:18:09,013 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:18:09,013 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:18:09,592 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:18:09,592 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:18:09,593 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:18:09,594 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:18:09,595 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:18:09,596 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:18:09,597 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:18:09,597 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:18:09,598 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:18:09,598 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:18:09,599 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:18:09,600 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:18:09,601 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:18:09,602 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:18:09,602 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:18:09,603 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:18:09,612 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:18:09,616 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:18:09,620 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0066, negotiated timeout = 40000
2023-03-20 21:18:09,622 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:18:09,622 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:18:09,623 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:18:09,624 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0067, negotiated timeout = 40000
2023-03-20 21:18:09,630 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:18:09,632 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:18:09,636 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:18:09,637 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:18:09,638 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:18:09,640 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:18:09,641 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:18:09,641 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:18:09,642 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:09,643 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:18:09,643 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:18:09,644 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:18:09,644 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:18:09,645 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:18:09,646 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:09,646 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:18:09,646 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:18:09,646 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:09,647 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:18:09,648 INFO  [Thread-0] root: Connected to localhost on port 40462
2023-03-20 21:18:09,648 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:18:09,648 INFO  [Thread-2] root: Recieved message with raw bytes [B@d0ec4d
2023-03-20 21:18:09,650 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:18:09,651 INFO  [Thread-2] root: Message: DATATRANSFERthisthat

2023-03-20 21:18:09,652 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:18:09,657 INFO  [Thread-2] root: Added key 'this' and value 'that' to the database
2023-03-20 21:18:09,657 INFO  [Thread-2] root: MESSAGE TO SEND: that
2023-03-20 21:18:09,658 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:18:09,658 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2475ea05
2023-03-20 21:18:09,658 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:18:09,658 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:18:09,658 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:18:09,658 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:18:09,658 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:18:09,658 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:09,658 INFO  [Thread-2] root: Closing connection
2023-03-20 21:18:09,658 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:18:09,659 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:18:09,660 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:18:09,660 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:09,660 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:18:09,662 INFO  [Thread-0] root: Connected to localhost on port 40470
2023-03-20 21:18:09,662 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:18:09,663 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:18:09,664 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:09,664 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:18:09,665 INFO  [Thread-3] root: Closing connection
2023-03-20 21:18:24,854 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:24,855 INFO  [Thread-0] root: Connected to localhost on port 58186
2023-03-20 21:18:28,110 INFO  [Thread-4] root: Recieved message with raw bytes [B@1033d8ce
2023-03-20 21:18:28,110 INFO  [Thread-4] root: Raw bytes: [80, 85, 84, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:18:28,110 INFO  [Thread-4] root: Message: PUTherethere

2023-03-20 21:18:28,110 INFO  [Thread-4] root: Received a message of type 'PUT' with key 'here' and value 'there'
2023-03-20 21:18:28,110 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:28,110 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:18:28,111 INFO  [Thread-4] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:18:28,111 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:18:28,112 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:28,113 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:18:28,114 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:18:28,114 INFO  [Thread-4] root: Server cannot service for key 'here'. Sending back metadata
2023-03-20 21:18:28,115 INFO  [Thread-4] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-20 21:18:28,116 INFO  [Thread-4] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'here' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-20 21:18:28,122 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:28,122 INFO  [Thread-4] root: Closing connection
2023-03-20 21:18:28,122 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:28,123 INFO  [Thread-0] root: Connected to localhost on port 33404
2023-03-20 21:18:28,123 INFO  [Thread-5] root: Recieved message with raw bytes [B@24d421ff
2023-03-20 21:18:28,124 INFO  [Thread-5] root: Raw bytes: [80, 85, 84, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:18:28,124 INFO  [Thread-5] root: Message: PUTherethere

2023-03-20 21:18:28,124 INFO  [Thread-5] root: Received a message of type 'PUT' with key 'here' and value 'there'
2023-03-20 21:18:28,124 INFO  [Thread-5] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:18:28,125 INFO  [Thread-5] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:18:28,125 INFO  [Thread-5] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:18:28,125 INFO  [Thread-5] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:28,125 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:18:28,125 INFO  [Thread-5] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 21:18:28,125 INFO  [Thread-5] root: key.compareTo(hashRange[1] true
2023-03-20 21:18:28,126 INFO  [Thread-5] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:18:28,126 INFO  [Thread-5] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:18:28,126 INFO  [Thread-5] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:18:28,126 INFO  [Thread-5] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:28,126 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:18:28,126 INFO  [Thread-5] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 21:18:28,126 INFO  [Thread-5] root: key.compareTo(hashRange[1] true
2023-03-20 21:18:28,130 INFO  [Thread-5] root: Added key 'here' and value 'there' to the database
2023-03-20 21:18:28,130 INFO  [Thread-5] root: MESSAGE TO SEND: there
2023-03-20 21:18:28,130 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:18:36,379 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:18:36,380 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:18:36,381 INFO  [Thread-1] root: Transferring key: here
2023-03-20 21:18:36,381 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:18:36,383 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:18:36,383 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:18:36,383 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:18:36,384 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:18:36,385 INFO  [Thread-5] root: Recieved message with raw bytes [B@509d5340
2023-03-20 21:18:36,385 INFO  [Thread-0] root: Connected to localhost on port 48066
2023-03-20 21:18:36,385 INFO  [Thread-5] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:18:36,387 INFO  [Thread-5] root: Message: DATATRANSFERherethere

2023-03-20 21:18:36,387 INFO  [Thread-5] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:18:36,389 INFO  [Thread-5] root: Added key 'here' and value 'there' to the database
2023-03-20 21:18:36,389 INFO  [Thread-5] root: MESSAGE TO SEND: there
2023-03-20 21:18:36,389 INFO  [Thread-5] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:18:36,389 INFO  [Thread-1] root: Recieved message with raw bytes [B@44f22a8f
2023-03-20 21:18:36,389 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:18:36,389 INFO  [Thread-1] root: Message: PUT_SUCCESSherethere

2023-03-20 21:18:36,389 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:18:36,389 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:18:36,389 INFO  [Thread-1] root: Closing connection
2023-03-20 21:18:36,390 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:18:36,390 INFO  [Thread-5] root: Closing connection
2023-03-20 21:18:36,398 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:18:36,399 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:18:36,400 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:18:36,400 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:18:36,400 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:19:23,241 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:19:23,241 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:19:23,241 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:19:23,242 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:19:23,242 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:19:23,243 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:19:23,244 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:19:23,244 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:19:23,245 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:19:23,246 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:19:23,246 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:19:23,247 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:19:23,248 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:19:23,248 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:19:23,249 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:19:23,250 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:19:23,259 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:19:23,263 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:19:23,267 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0068, negotiated timeout = 40000
2023-03-20 21:19:23,269 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:19:23,269 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:19:23,269 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:19:23,271 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0069, negotiated timeout = 40000
2023-03-20 21:19:23,277 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:19:23,279 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:19:23,282 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:19:23,283 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:19:23,284 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:19:23,284 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:19:23,286 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:19:23,286 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:19:23,286 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:19:23,287 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:19:23,287 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:19:23,288 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:19:23,289 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:19:23,289 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:19:23,290 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:19:23,291 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:19:23,291 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:19:23,294 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:19:23,294 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:19:23,294 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:19:23,295 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:19:23,296 INFO  [Thread-0] root: Connected to localhost on port 54942
2023-03-20 21:19:23,295 INFO  [Thread-2] root: Recieved message with raw bytes [B@d0ec4d
2023-03-20 21:19:23,298 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:19:23,298 INFO  [Thread-2] root: Message: DATATRANSFERherethere

2023-03-20 21:19:23,299 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:19:23,303 INFO  [Thread-2] root: Added key 'here' and value 'there' to the database
2023-03-20 21:19:23,303 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:19:23,304 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:19:23,304 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2475ea05
2023-03-20 21:19:23,304 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:19:23,304 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:19:23,304 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:19:23,304 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:19:23,304 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:19:23,304 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:19:23,304 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:19:23,305 INFO  [Thread-2] root: Closing connection
2023-03-20 21:19:23,306 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:19:23,307 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:19:23,307 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:19:23,308 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:19:23,308 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:19:23,308 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:19:23,309 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:19:23,309 INFO  [Thread-3] root: Recieved message with raw bytes [B@950f790
2023-03-20 21:19:23,309 INFO  [Thread-0] root: Connected to localhost on port 54950
2023-03-20 21:19:23,310 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:19:23,311 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:19:23,312 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:19:23,313 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:19:23,314 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:19:23,314 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Recieved message with raw bytes [B@796afc3c
2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:19:23,314 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:19:23,315 INFO  [Thread-3] root: Closing connection
2023-03-20 21:19:23,314 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:19:30,894 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:19:30,895 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:19:30,895 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:19:30,896 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:19:30,896 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:19:30,897 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:19:30,898 INFO  [Thread-0] root: Connected to localhost on port 54954
2023-03-20 21:19:30,898 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:19:30,899 INFO  [Thread-1] root: Closing connection
2023-03-20 21:19:30,899 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:19:30,899 INFO  [Thread-4] root: Closing connection
2023-03-20 21:19:30,905 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:19:30,907 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:19:30,908 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:19:30,908 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:19:30,908 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:25,682 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:22:25,682 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:22:25,683 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:22:25,684 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:22:25,684 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:22:25,685 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:22:25,686 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:22:25,686 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:22:25,687 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:22:25,688 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:22:25,688 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:22:25,689 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:22:25,689 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:22:25,690 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:22:25,690 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:22:25,691 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:22:25,701 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:22:25,705 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:22:25,709 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c006a, negotiated timeout = 40000
2023-03-20 21:22:25,710 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:22:25,711 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:22:25,711 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:22:25,713 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c006b, negotiated timeout = 40000
2023-03-20 21:22:25,718 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:22:25,720 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:22:25,724 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:25,725 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:22:25,726 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:22:25,727 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:22:25,728 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:22:25,728 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:22:25,729 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:25,729 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:22:25,729 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:22:25,730 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:22:25,730 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:25,731 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:25,733 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:22:25,733 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:25,733 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:22:25,734 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:22:25,735 INFO  [Thread-0] root: Connected to localhost on port 53832
2023-03-20 21:22:25,735 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:22:25,736 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:22:25,736 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:22:25,736 INFO  [Thread-2] root: Closing connection
2023-03-20 21:22:25,737 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:22:25,737 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:25,737 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:22:25,738 INFO  [Thread-0] root: Connected to localhost on port 53844
2023-03-20 21:22:25,739 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:22:25,740 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:22:25,740 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:22:25,741 INFO  [Thread-3] root: Closing connection
2023-03-20 21:22:25,740 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:22:32,359 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:22:32,359 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:22:32,360 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:22:32,361 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:22:32,361 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:32,361 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:22:32,362 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:22:32,362 INFO  [Thread-1] root: Closing connection
2023-03-20 21:22:32,362 INFO  [Thread-0] root: Connected to localhost on port 36736
2023-03-20 21:22:32,362 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:22:32,363 INFO  [Thread-5] root: Closing connection
2023-03-20 21:22:32,373 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:32,374 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:22:32,375 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:22:32,375 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:22:32,375 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:35,525 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:22:35,525 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:22:35,525 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:22:35,526 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:22:35,527 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:22:35,527 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:22:35,528 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:22:35,528 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:22:35,529 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:22:35,530 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:22:35,530 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:22:35,531 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:22:35,531 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:22:35,532 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:22:35,532 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:22:35,533 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:22:35,542 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:22:35,547 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:22:35,551 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c006c, negotiated timeout = 40000
2023-03-20 21:22:35,552 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:22:35,552 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:22:35,553 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:22:35,554 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c006d, negotiated timeout = 40000
2023-03-20 21:22:35,560 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:22:35,561 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:22:35,566 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:35,566 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:22:35,567 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:22:35,567 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:22:35,568 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:22:35,569 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:22:35,569 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:22:35,569 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:35,570 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:35,570 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:35,571 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:22:35,572 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:22:35,574 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:22:35,574 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:35,574 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:22:35,575 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:22:35,576 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:22:35,576 INFO  [Thread-0] root: Connected to localhost on port 54380
2023-03-20 21:22:35,577 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:22:35,577 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:22:35,578 INFO  [Thread-2] root: Closing connection
2023-03-20 21:22:35,579 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:35,579 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:22:35,580 INFO  [Thread-0] root: Connected to localhost on port 54388
2023-03-20 21:22:35,580 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:22:35,582 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:22:35,582 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:22:35,583 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:22:35,583 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:22:35,584 INFO  [Thread-3] root: Closing connection
2023-03-20 21:22:41,655 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:41,655 INFO  [Thread-0] root: Connected to localhost on port 54394
2023-03-20 21:22:41,656 INFO  [Thread-4] root: Recieved message with raw bytes [B@425a8f19
2023-03-20 21:22:41,657 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 21:22:41,658 INFO  [Thread-4] root: Message: GETthis

2023-03-20 21:22:41,658 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 21:22:41,658 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:22:41,659 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:22:41,660 INFO  [Thread-4] root: false
2023-03-20 21:22:41,660 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:41,660 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:22:41,662 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:22:41,662 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:22:41,662 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:41,663 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 21:22:41,663 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:22:41,664 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-20 21:22:41,665 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:22:43,887 INFO  [Thread-4] root: Recieved message with raw bytes [B@783d5b05
2023-03-20 21:22:43,887 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 21:22:43,887 INFO  [Thread-4] root: Message: GETthis

2023-03-20 21:22:43,887 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 21:22:43,887 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:22:43,887 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:22:43,887 INFO  [Thread-4] root: false
2023-03-20 21:22:43,887 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:43,888 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:22:43,888 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:22:43,888 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:22:43,888 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:22:43,889 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 21:22:43,890 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:22:43,891 INFO  [Thread-4] root: MESSAGE TO SEND: that
2023-03-20 21:22:43,891 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:22:49,303 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:22:49,303 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:22:49,304 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:22:49,305 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:22:49,305 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:22:49,305 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:22:49,306 INFO  [Thread-0] root: Connected to localhost on port 56230
2023-03-20 21:22:49,306 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:22:49,307 INFO  [Thread-1] root: Closing connection
2023-03-20 21:22:49,307 ERROR [Thread-6] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:22:49,308 INFO  [Thread-6] root: Closing connection
2023-03-20 21:22:49,318 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:22:49,319 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:22:49,320 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:22:49,321 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:22:49,321 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:23:17,031 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:23:17,032 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:23:17,032 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:23:17,032 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:23:17,034 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:23:17,034 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:23:17,035 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:23:17,036 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:23:17,036 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:23:17,037 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:23:17,038 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:23:17,039 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:23:17,040 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:23:17,041 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:23:17,042 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:23:17,043 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:23:17,051 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:23:17,056 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:23:17,060 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c006e, negotiated timeout = 40000
2023-03-20 21:23:17,062 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:23:17,062 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:23:17,063 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:23:17,064 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c006f, negotiated timeout = 40000
2023-03-20 21:23:17,069 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:23:17,071 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:23:17,076 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:23:17,077 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:23:17,077 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:23:17,078 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:23:17,079 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:23:17,079 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:23:17,080 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:23:30,552 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:23:30,553 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:23:30,553 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:23:30,553 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:23:30,554 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:23:30,555 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:23:30,555 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:23:30,556 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:23:30,556 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:23:30,557 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:23:30,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:23:30,558 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:23:30,559 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:23:30,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:23:30,560 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:23:30,561 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:23:30,570 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:23:30,574 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:23:30,579 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0070, negotiated timeout = 40000
2023-03-20 21:23:30,580 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:23:30,581 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:23:30,581 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:23:30,583 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0071, negotiated timeout = 40000
2023-03-20 21:23:30,589 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:23:30,591 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:604)
2023-03-20 21:23:30,595 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:23:30,598 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:23:30,598 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:23:30,598 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:23:30,599 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:23:30,599 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:23:30,600 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:23:30,600 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:23:30,600 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:23:30,602 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:23:30,602 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:23:30,603 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:23:30,603 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:23:30,604 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:23:30,604 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:23:30,607 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:23:30,607 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:23:30,607 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:23:30,608 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:23:30,608 INFO  [Thread-2] root: Recieved message with raw bytes [B@3a366ef2
2023-03-20 21:23:30,608 INFO  [Thread-0] root: Connected to localhost on port 33148
2023-03-20 21:23:30,609 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:23:30,610 INFO  [Thread-2] root: Message: DATATRANSFERherethere

2023-03-20 21:23:30,610 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'there'
2023-03-20 21:23:30,615 INFO  [Thread-2] root: Added key 'here' and value 'there' to the database
2023-03-20 21:23:30,615 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:23:30,615 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:23:30,615 INFO  [main-EventThread] root: Recieved message with raw bytes [B@71de63a0
2023-03-20 21:23:30,615 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:23:30,615 INFO  [main-EventThread] root: Message: PUT_SUCCESSherethere

2023-03-20 21:23:30,615 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'there'
2023-03-20 21:23:30,615 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:23:30,616 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:23:30,616 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:23:30,616 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:23:30,617 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:23:30,618 INFO  [Thread-2] root: Closing connection
2023-03-20 21:23:30,619 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:23:30,620 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:23:30,620 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:23:30,620 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:23:30,620 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:23:30,622 INFO  [Thread-0] root: Connected to localhost on port 33152
2023-03-20 21:23:30,622 INFO  [Thread-3] root: Recieved message with raw bytes [B@158f0749
2023-03-20 21:23:30,622 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:23:30,623 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:23:30,624 INFO  [Thread-3] root: Message: DATATRANSFERthisthat

2023-03-20 21:23:30,625 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'that'
2023-03-20 21:23:30,626 INFO  [Thread-3] root: Added key 'this' and value 'that' to the database
2023-03-20 21:23:30,626 INFO  [Thread-3] root: MESSAGE TO SEND: that
2023-03-20 21:23:30,626 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:23:30,626 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2f7711f8
2023-03-20 21:23:30,626 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 97, 116, 31, 10]
2023-03-20 21:23:30,626 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthat

2023-03-20 21:23:30,627 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'that'
2023-03-20 21:23:30,627 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:23:30,627 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:23:30,627 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:23:30,628 INFO  [Thread-3] root: Closing connection
2023-03-20 21:23:30,627 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:23:35,591 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:23:35,591 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:23:35,592 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:23:35,594 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:23:35,594 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:23:35,595 INFO  [Thread-0] root: Connected to localhost on port 45068
2023-03-20 21:23:35,595 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:23:35,595 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:23:35,596 INFO  [Thread-1] root: Closing connection
2023-03-20 21:23:35,596 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:23:35,597 INFO  [Thread-4] root: Closing connection
2023-03-20 21:23:35,606 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:23:35,607 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:23:35,608 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:23:35,609 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:23:35,609 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:26:16,813 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:26:16,813 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:26:16,814 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:26:16,815 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:26:16,815 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:26:16,816 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:26:16,817 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:26:16,818 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:26:16,819 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:26:16,828 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:26:16,832 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:26:16,836 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0074, negotiated timeout = 40000
2023-03-20 21:26:16,838 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:26:16,838 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:26:16,838 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:26:16,840 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0075, negotiated timeout = 40000
2023-03-20 21:26:16,846 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:26:16,848 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:26:16,853 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:26:16,854 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:26:16,860 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:26:16,861 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:26:16,862 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:26:16,862 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:26:16,863 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:26:27,387 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:26:27,388 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:26:27,388 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:26:27,388 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:26:27,389 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:26:27,390 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:26:27,391 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:26:27,392 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:26:27,392 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:26:27,393 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:26:27,393 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:26:27,394 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:26:27,395 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:26:27,395 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:26:27,396 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:26:27,397 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:26:27,406 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:26:27,410 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:26:27,414 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0076, negotiated timeout = 40000
2023-03-20 21:26:27,415 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:26:27,416 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:26:27,416 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:26:27,418 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0077, negotiated timeout = 40000
2023-03-20 21:26:27,424 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:26:27,426 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:26:27,430 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:26:27,431 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:26:27,432 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:26:27,433 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:26:27,434 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:26:27,434 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:26:27,434 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:26:27,435 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:26:27,436 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:26:27,436 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:26:27,436 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:26:27,437 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:26:27,438 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:26:27,439 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:26:27,440 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:26:27,440 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:26:27,442 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:26:27,442 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:26:27,442 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:26:27,444 INFO  [Thread-0] root: Connected to localhost on port 49910
2023-03-20 21:26:27,444 INFO  [Thread-2] root: Recieved message with raw bytes [B@5b2e3e6a
2023-03-20 21:26:27,444 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:26:27,445 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:26:27,447 INFO  [Thread-2] root: Message: DATATRANSFERthisthere

2023-03-20 21:26:27,447 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:26:27,453 INFO  [Thread-2] root: Added key 'this' and value 'there' to the database
2023-03-20 21:26:27,453 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:26:27,453 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:26:27,453 INFO  [main-EventThread] root: Recieved message with raw bytes [B@2475ea05
2023-03-20 21:26:27,453 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:26:27,453 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthere

2023-03-20 21:26:27,453 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:26:27,453 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:26:27,453 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:26:27,453 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:26:27,453 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:26:27,454 INFO  [Thread-2] root: Closing connection
2023-03-20 21:26:27,455 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:26:27,458 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:26:27,458 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:26:27,458 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:26:27,459 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:26:27,459 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:26:27,459 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:26:27,461 INFO  [Thread-0] root: Connected to localhost on port 49916
2023-03-20 21:26:27,461 INFO  [Thread-3] root: Recieved message with raw bytes [B@1a794b4f
2023-03-20 21:26:27,461 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'hi'
2023-03-20 21:26:27,462 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 104, 105, 31, 10]
2023-03-20 21:26:27,463 INFO  [Thread-3] root: Message: DATATRANSFERherehi

2023-03-20 21:26:27,464 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'hi'
2023-03-20 21:26:27,466 INFO  [Thread-3] root: Added key 'here' and value 'hi' to the database
2023-03-20 21:26:27,466 INFO  [Thread-3] root: MESSAGE TO SEND: hi
2023-03-20 21:26:27,466 INFO  [main-EventThread] root: Recieved message with raw bytes [B@796afc3c
2023-03-20 21:26:27,466 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'hi'
2023-03-20 21:26:27,466 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 104, 105, 31, 10]
2023-03-20 21:26:27,466 INFO  [main-EventThread] root: Message: PUT_SUCCESSherehi

2023-03-20 21:26:27,466 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'hi'
2023-03-20 21:26:27,466 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:26:27,466 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:26:27,467 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:26:27,468 INFO  [Thread-3] root: Closing connection
2023-03-20 21:26:27,467 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:26:37,273 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:26:37,273 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:26:37,274 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:26:37,274 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:26:37,275 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:26:37,275 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:26:37,276 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:26:37,276 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:26:37,278 INFO  [Thread-1] root: Closing connection
2023-03-20 21:26:37,278 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:26:37,278 INFO  [Thread-2] root: Closing connection
2023-03-20 21:26:37,279 INFO  [Thread-0] root: Connected to localhost on port 41124
2023-03-20 21:26:37,285 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:26:37,289 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:26:37,291 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:26:37,292 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:26:37,292 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:28:31,818 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:28:31,818 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:28:31,820 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:28:31,820 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:28:31,821 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:28:31,822 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:28:31,823 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:28:31,824 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:28:31,825 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:28:31,826 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:28:31,827 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:28:31,828 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:28:31,828 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:28:31,829 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:28:31,830 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:28:31,831 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:28:31,840 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:28:31,844 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:28:31,848 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0078, negotiated timeout = 40000
2023-03-20 21:28:31,850 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:28:31,850 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:28:31,850 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:28:31,852 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0079, negotiated timeout = 40000
2023-03-20 21:28:31,857 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:28:31,859 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:28:31,864 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:28:31,864 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:28:31,865 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:28:31,866 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:28:31,866 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:28:31,866 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:28:31,867 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:28:31,867 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:28:31,868 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:28:31,868 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:28:31,869 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:28:31,869 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:28:31,869 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:28:31,871 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:28:31,872 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:28:31,872 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:28:31,873 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:28:31,873 INFO  [Thread-0] root: Connected to localhost on port 43034
2023-03-20 21:28:31,874 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:28:31,876 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:28:31,876 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:28:31,876 INFO  [Thread-2] root: Closing connection
2023-03-20 21:28:31,878 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:28:31,880 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:28:31,880 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:28:31,880 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:28:31,882 INFO  [Thread-0] root: Connected to localhost on port 43036
2023-03-20 21:28:31,882 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:28:31,884 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:28:31,885 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:28:31,885 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:28:31,886 INFO  [Thread-3] root: Closing connection
2023-03-20 21:29:04,822 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:29:04,824 INFO  [Thread-0] root: Connected to localhost on port 35406
2023-03-20 21:29:07,341 INFO  [Thread-3] root: Recieved message with raw bytes [B@6b2c0112
2023-03-20 21:29:07,342 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 21:29:07,343 INFO  [Thread-3] root: Message: GETthis

2023-03-20 21:29:07,344 INFO  [Thread-3] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 21:29:07,345 INFO  [Thread-3] root: SERVER_IDLE
2023-03-20 21:29:07,346 INFO  [Thread-3] root: SERVER_IDLE
2023-03-20 21:29:07,347 INFO  [Thread-3] root: false
2023-03-20 21:29:07,348 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:29:07,349 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:29:07,350 INFO  [Thread-3] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:29:07,350 INFO  [Thread-3] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:29:07,351 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:29:07,352 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 21:29:07,353 INFO  [Thread-3] root: key.compareTo(hashRange[1] false
2023-03-20 21:29:07,354 INFO  [Thread-3] root: Server cannot service for key 'this'. Sending back metadata
2023-03-20 21:29:07,355 INFO  [Thread-3] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-20 21:29:07,355 INFO  [Thread-3] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-20 21:29:07,366 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:29:07,366 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:29:07,366 INFO  [Thread-3] root: Closing connection
2023-03-20 21:29:07,367 INFO  [Thread-4] root: Recieved message with raw bytes [B@14d3e52
2023-03-20 21:29:07,368 INFO  [Thread-0] root: Connected to localhost on port 54594
2023-03-20 21:29:07,368 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 21:29:07,368 INFO  [Thread-4] root: Message: GETthis

2023-03-20 21:29:07,369 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 21:29:07,370 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:29:07,370 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:29:07,370 INFO  [Thread-4] root: false
2023-03-20 21:29:07,370 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:29:07,370 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:29:07,371 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:29:07,371 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:29:07,372 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:29:07,373 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 21:29:07,374 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:29:07,374 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 21:29:07,375 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:29:18,895 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:29:18,895 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:29:18,896 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:29:18,897 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:29:18,898 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:29:18,898 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:29:18,898 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:29:18,900 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:29:18,900 INFO  [Thread-0] root: Connected to localhost on port 47928
2023-03-20 21:29:18,901 INFO  [Thread-1] root: Closing connection
2023-03-20 21:29:18,903 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:29:18,903 INFO  [Thread-4] root: Closing connection
2023-03-20 21:29:18,913 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:29:18,915 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:29:18,915 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:29:18,916 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:29:18,916 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:32:23,287 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:32:23,288 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:32:23,288 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:32:23,288 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:32:23,289 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:32:23,289 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:32:23,290 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:32:23,291 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:32:23,291 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:32:23,292 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:32:23,292 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:32:23,293 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:32:23,293 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:32:23,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:32:23,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:32:23,295 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:32:23,304 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:32:23,308 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:32:23,312 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c007c, negotiated timeout = 40000
2023-03-20 21:32:23,313 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:32:23,314 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:32:23,314 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:32:23,316 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c007d, negotiated timeout = 40000
2023-03-20 21:32:23,321 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:32:23,323 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:32:23,328 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:32:23,328 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:32:23,334 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:32:23,335 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,6a93711a8c3f9c2641dfc71c359a1abf,6a93711a8c3f9c2641dfc71c359a1abe,16;
2023-03-20 21:32:23,335 INFO  [main-EventThread] root: 6a93711a8c3f9c2641dfc71c359a1abf:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:32:23,336 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:32:23,336 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:32:25,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:32:25,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:32:25,181 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:32:25,182 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:32:25,183 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:32:25,183 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:32:25,184 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:32:25,184 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:32:25,185 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:32:25,186 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:32:25,186 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:32:25,187 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:32:25,187 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:32:25,188 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:32:25,188 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:32:25,189 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:32:25,198 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:32:25,202 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:32:25,206 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c007e, negotiated timeout = 40000
2023-03-20 21:32:25,207 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:32:25,208 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:32:25,208 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:32:25,209 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c007f, negotiated timeout = 40000
2023-03-20 21:32:25,215 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:32:25,217 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:32:25,221 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:32:25,222 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:32:25,223 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:32:25,224 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:32:25,226 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:32:25,226 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:32:25,227 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:32:25,227 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:32:25,227 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:32:25,228 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:32:25,228 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:32:25,229 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:32:25,229 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:32:25,230 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:32:25,231 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 21:32:25,231 INFO  [main-EventThread] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:32:25,231 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:32:25,232 INFO  [main-EventThread] root: Transferring key: here
2023-03-20 21:32:25,232 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:32:25,233 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 21:32:25,233 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:32:25,233 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:32:25,235 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:32:25,236 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:32:25,236 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:32:25,237 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'here' and value 'hi'
2023-03-20 21:32:25,237 INFO  [Thread-2] root: Recieved message with raw bytes [B@1ae203e5
2023-03-20 21:32:25,237 INFO  [Thread-0] root: Connected to localhost on port 37670
2023-03-20 21:32:25,238 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 101, 114, 101, 31, 104, 105, 31, 10]
2023-03-20 21:32:25,239 INFO  [Thread-2] root: Message: DATATRANSFERherehi

2023-03-20 21:32:25,240 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'here' and value 'hi'
2023-03-20 21:32:25,245 INFO  [Thread-2] root: Added key 'here' and value 'hi' to the database
2023-03-20 21:32:25,245 INFO  [Thread-2] root: MESSAGE TO SEND: hi
2023-03-20 21:32:25,245 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'here' and value 'hi'
2023-03-20 21:32:25,245 INFO  [main-EventThread] root: Recieved message with raw bytes [B@38b4b3ca
2023-03-20 21:32:25,245 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 101, 114, 101, 31, 104, 105, 31, 10]
2023-03-20 21:32:25,245 INFO  [main-EventThread] root: Message: PUT_SUCCESSherehi

2023-03-20 21:32:25,245 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'here' and value 'hi'
2023-03-20 21:32:25,245 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:32:25,245 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:32:25,246 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:32:25,246 INFO  [Thread-2] root: Closing connection
2023-03-20 21:32:25,246 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:32:25,247 INFO  [main-EventThread] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:32:25,249 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 21:32:25,249 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 21:32:25,249 INFO  [main-EventThread] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:32:25,250 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:32:25,250 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:32:25,251 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 21:32:25,251 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:32:25,252 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:32:25,252 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:32:25,253 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:32:25,253 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:32:25,253 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:32:25,254 INFO  [Thread-0] root: Connected to localhost on port 37678
2023-03-20 21:32:25,254 INFO  [Thread-3] root: Recieved message with raw bytes [B@7fedd162
2023-03-20 21:32:25,254 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:32:25,255 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:32:25,256 INFO  [Thread-3] root: Message: DATATRANSFERthisthere

2023-03-20 21:32:25,256 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:32:25,258 INFO  [Thread-3] root: Added key 'this' and value 'there' to the database
2023-03-20 21:32:25,258 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 21:32:25,258 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Recieved message with raw bytes [B@416710fc
2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthere

2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:32:25,258 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:32:25,258 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:32:25,259 INFO  [Thread-3] root: Closing connection
2023-03-20 21:32:30,473 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:32:30,473 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:32:30,475 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:32:30,476 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:32:30,476 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:32:30,476 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:32:30,477 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:32:30,478 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:32:30,478 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:32:30,478 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:32:30,481 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:32:30,481 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:32:30,481 INFO  [Thread-0] root: Connected to localhost on port 37692
2023-03-20 21:32:30,482 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:32:30,482 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:32:30,482 INFO  [Thread-1] root: Closing connection
2023-03-20 21:32:30,483 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:32:30,483 INFO  [Thread-4] root: Closing connection
2023-03-20 21:32:30,493 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:32:30,495 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:32:30,496 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:32:30,496 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:32:30,497 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:32:47,188 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:32:47,189 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:32:47,189 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:32:47,190 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:32:47,191 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:32:47,191 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:32:47,192 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:32:47,192 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:32:47,193 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:32:47,193 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:32:47,194 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:32:47,194 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:32:47,195 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:32:47,196 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:32:47,196 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:32:47,197 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:32:47,207 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:32:47,211 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:32:47,215 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0080, negotiated timeout = 40000
2023-03-20 21:32:47,216 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:32:47,217 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:32:47,217 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:32:47,219 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0081, negotiated timeout = 40000
2023-03-20 21:32:47,224 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:32:47,226 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:32:47,230 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:32:47,231 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:32:47,232 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:32:47,233 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:32:47,234 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:32:47,234 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:32:47,235 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:32:47,235 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:32:47,235 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:32:47,235 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:32:47,236 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:32:47,237 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:32:47,237 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:32:47,240 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:32:47,240 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:32:47,240 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:32:47,241 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:32:47,241 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:32:47,242 INFO  [Thread-0] root: Connected to localhost on port 34926
2023-03-20 21:32:47,242 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:32:47,242 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:32:47,243 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:32:47,243 INFO  [Thread-2] root: Closing connection
2023-03-20 21:32:47,244 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:32:47,244 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:32:47,246 INFO  [Thread-0] root: Connected to localhost on port 34940
2023-03-20 21:32:47,246 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:32:47,247 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:32:47,247 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:32:47,248 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:32:47,248 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:32:47,248 INFO  [Thread-3] root: Closing connection
2023-03-20 21:33:03,323 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:33:03,324 INFO  [Thread-0] root: Connected to localhost on port 51900
2023-03-20 21:33:04,746 INFO  [Thread-5] root: Recieved message with raw bytes [B@46cc1fd4
2023-03-20 21:33:04,746 INFO  [Thread-5] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 21:33:04,746 INFO  [Thread-5] root: Message: GETthis

2023-03-20 21:33:04,746 INFO  [Thread-5] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 21:33:04,746 INFO  [Thread-5] root: SERVER_IDLE
2023-03-20 21:33:04,746 INFO  [Thread-5] root: SERVER_IDLE
2023-03-20 21:33:04,747 INFO  [Thread-5] root: false
2023-03-20 21:33:04,747 INFO  [Thread-5] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:33:04,747 INFO  [Thread-5] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:33:04,747 INFO  [Thread-5] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:33:04,747 INFO  [Thread-5] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:33:04,748 INFO  [Thread-5] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:33:04,749 INFO  [Thread-5] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 21:33:04,749 INFO  [Thread-5] root: key.compareTo(hashRange[1] false
2023-03-20 21:33:04,749 INFO  [Thread-5] root: Server cannot service for key 'this'. Sending back metadata
2023-03-20 21:33:04,749 INFO  [Thread-5] root: MESSAGE TO SEND: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16
2023-03-20 21:33:04,749 INFO  [Thread-5] root: Sent a message of type 'SERVER_NOT_RESPONSIBLE' with key 'this' and value '127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16'
2023-03-20 21:33:04,757 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:33:04,757 ERROR [Thread-5] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:33:04,757 INFO  [Thread-5] root: Closing connection
2023-03-20 21:33:04,758 INFO  [Thread-4] root: Recieved message with raw bytes [B@751f3f4a
2023-03-20 21:33:04,758 INFO  [Thread-0] root: Connected to localhost on port 38974
2023-03-20 21:33:04,759 INFO  [Thread-4] root: Raw bytes: [71, 69, 84, 31, 116, 104, 105, 115, 31, 31, 10]
2023-03-20 21:33:04,759 INFO  [Thread-4] root: Message: GETthis

2023-03-20 21:33:04,759 INFO  [Thread-4] root: Received a message of type 'GET' with key 'this' and value ''
2023-03-20 21:33:04,760 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:33:04,760 INFO  [Thread-4] root: SERVER_IDLE
2023-03-20 21:33:04,760 INFO  [Thread-4] root: false
2023-03-20 21:33:04,760 INFO  [Thread-4] root: This server's IP:Port Hash6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:33:04,761 INFO  [Thread-4] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:33:04,761 INFO  [Thread-4] root: THE KEY IS: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:33:04,762 INFO  [Thread-4] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:33:04,762 INFO  [Thread-4] root: THE RANGE UPPER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:33:04,763 INFO  [Thread-4] root: key.compareTo(hashRange[0]) < 0: false
2023-03-20 21:33:04,763 INFO  [Thread-4] root: key.compareTo(hashRange[1]) > 0 true
2023-03-20 21:33:04,764 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 21:33:04,765 INFO  [Thread-4] root: Sent a message of type 'GET_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:33:51,678 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:33:51,678 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:33:51,679 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:33:51,679 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:33:51,680 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:33:51,680 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:33:51,680 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:33:51,682 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:33:51,682 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:33:51,682 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:33:51,682 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:33:51,682 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:33:51,683 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:33:51,684 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:33:51,684 INFO  [Thread-1] root: Closing connection
2023-03-20 21:33:51,684 INFO  [Thread-0] root: Connected to localhost on port 40764
2023-03-20 21:33:51,684 ERROR [Thread-6] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:33:51,685 INFO  [Thread-6] root: Closing connection
2023-03-20 21:33:51,695 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:33:51,697 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:33:51,697 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:33:51,698 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:33:51,698 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:36:00,704 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:36:00,717 INFO  [Thread-0] root: Connected to localhost on port 53900
2023-03-20 21:36:02,985 INFO  [Thread-7] root: Recieved message with raw bytes [B@107be07
2023-03-20 21:36:02,985 INFO  [Thread-7] root: Raw bytes: [75, 69, 89, 82, 65, 78, 71, 69, 31, 31, 31, 10]
2023-03-20 21:36:02,985 INFO  [Thread-7] root: Message: KEYRANGE

2023-03-20 21:36:02,986 INFO  [Thread-7] root: Received a message of type 'KEYRANGE' with key '' and value ''
2023-03-20 21:36:02,986 INFO  [Thread-7] root: Sending keyrange according to metadata
2023-03-20 21:36:02,986 INFO  [Thread-7] root: MESSAGE TO SEND: 91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;
2023-03-20 21:36:02,986 INFO  [Thread-7] root: Sent a message of type 'KEYRANGE_SUCCESS' with key '' and value '91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,<127.0.0.1:8082>;'
2023-03-20 21:38:18,755 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:38:18,756 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:38:18,756 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:38:18,757 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:38:18,757 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:38:18,758 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:38:18,758 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:38:18,759 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:38:18,759 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:38:18,760 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:38:18,761 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:38:18,761 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:38:18,762 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:38:18,762 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:38:18,763 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:38:18,764 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:38:18,772 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:38:18,776 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:38:18,780 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0083, negotiated timeout = 40000
2023-03-20 21:38:18,782 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:38:18,783 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:38:18,783 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:38:18,784 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0084, negotiated timeout = 40000
2023-03-20 21:38:18,789 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:38:18,791 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:38:18,795 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:38:18,796 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:38:18,797 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:38:18,797 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:38:18,798 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:38:18,798 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:38:18,798 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:38:18,799 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:38:18,799 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:38:18,799 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:38:18,800 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:38:18,800 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:38:18,801 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:38:18,803 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:38:18,803 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:38:18,804 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:38:18,804 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:38:18,805 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:38:18,805 INFO  [Thread-0] root: Connected to localhost on port 46008
2023-03-20 21:38:18,805 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:38:18,805 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:38:18,806 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:38:18,807 INFO  [Thread-2] root: Closing connection
2023-03-20 21:38:18,808 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:38:18,808 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:38:18,809 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:38:18,809 INFO  [Thread-0] root: Connected to localhost on port 46012
2023-03-20 21:38:18,809 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:38:18,810 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:38:18,811 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:38:18,811 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:38:18,812 INFO  [Thread-3] root: Closing connection
2023-03-20 21:39:48,862 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:39:48,862 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:39:48,863 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:39:48,864 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:39:48,864 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:39:48,865 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:39:48,866 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:39:48,867 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:39:48,867 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:39:48,868 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:39:48,868 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:39:48,868 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:39:48,869 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:39:48,870 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:39:48,870 INFO  [Thread-1] root: Closing connection
2023-03-20 21:39:48,870 INFO  [Thread-0] root: Connected to localhost on port 45438
2023-03-20 21:39:48,871 ERROR [Thread-8] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:39:48,872 INFO  [Thread-8] root: Closing connection
2023-03-20 21:39:48,881 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:39:48,883 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:39:48,884 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:39:48,886 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:39:48,886 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:40:17,636 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:40:17,636 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:40:17,636 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:40:17,637 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:40:17,637 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:40:17,638 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:40:17,639 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:40:17,639 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:40:17,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:40:17,640 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:40:17,641 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:40:17,641 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:40:17,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:40:17,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:40:17,643 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:40:17,644 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:40:17,653 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:40:17,657 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:40:17,661 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0085, negotiated timeout = 40000
2023-03-20 21:40:17,662 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:40:17,663 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:40:17,663 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:40:17,665 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0086, negotiated timeout = 40000
2023-03-20 21:40:17,670 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:40:17,671 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:605)
2023-03-20 21:40:17,675 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:40:17,677 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:40:17,678 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:40:17,678 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:40:17,679 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:40:17,679 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:40:17,680 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:40:17,680 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:40:17,680 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:40:17,681 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:40:17,681 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:40:17,681 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:40:17,682 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:40:17,685 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:40:17,685 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:40:17,685 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:40:17,686 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:40:17,687 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:40:17,687 INFO  [Thread-0] root: Connected to localhost on port 44534
2023-03-20 21:40:17,687 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:40:17,687 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:40:17,689 INFO  [Thread-2] root: Closing connection
2023-03-20 21:40:17,688 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:40:17,691 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:40:17,691 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:40:17,691 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:40:17,692 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:40:17,692 INFO  [Thread-0] root: Connected to localhost on port 44546
2023-03-20 21:40:17,692 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:40:17,693 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:40:17,693 INFO  [Thread-3] root: Closing connection
2023-03-20 21:40:17,693 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:48:39,485 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:48:39,485 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:48:39,486 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:48:39,486 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:48:39,486 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:48:39,486 INFO  [Thread-1] root: Closing connection
2023-03-20 21:48:39,486 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:48:39,486 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:48:39,487 INFO  [Thread-4] root: Closing connection
2023-03-20 21:48:39,500 INFO  [Thread-0] root: Connected to localhost on port 55540
2023-03-20 21:48:40,018 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:48:40,018 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:48:40,018 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:48:40,019 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:48:40,019 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:48:40,019 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:48:40,019 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:48:40,019 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:48:40,019 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:48:40,019 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:48:40,020 ERROR [Thread-1] root: Failed to transfer data
java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:412)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:255)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:237)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.base/java.net.Socket.connect(Socket.java:609)
	at java.base/java.net.Socket.connect(Socket.java:558)
	at java.base/java.net.Socket.<init>(Socket.java:454)
	at java.base/java.net.Socket.<init>(Socket.java:231)
	at client.KVStore.connect(KVStore.java:41)
	at app_kvServer.KVServer.transferData(KVServer.java:186)
	at app_kvServer.KVServer.transferData(KVServer.java:171)
	at app_kvServer.KVServer.transferAllDataToSuccessor(KVServer.java:220)
	at app_kvServer.KVServer.handleShutdown(KVServer.java:224)
	at runnables.ShutdownRunnable.run(ShutdownRunnable.java:16)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:48:48,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:48:48,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:48:48,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:48:48,295 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:48:48,296 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:48:48,296 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:48:48,297 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:48:48,297 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:48:48,298 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:48:48,298 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:48:48,299 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:48:48,300 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:48:48,300 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:48:48,301 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:48:48,301 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:48:48,302 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:48:48,311 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:48:48,315 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:48:48,319 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0089, negotiated timeout = 40000
2023-03-20 21:48:48,321 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:48:48,321 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:48:48,322 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:48:48,324 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c008a, negotiated timeout = 40000
2023-03-20 21:48:48,329 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:48:48,331 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:48:48,337 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:48:48,338 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:48:48,344 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:48:48,345 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:48:48,347 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:48:48,347 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:48:48,348 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:48:50,013 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:48:50,013 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:48:50,014 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:48:50,015 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:48:50,015 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:48:50,016 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:48:50,016 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:48:50,017 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:48:50,018 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:48:50,018 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:48:50,019 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:48:50,019 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:48:50,020 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:48:50,020 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:48:50,021 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:48:50,022 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:48:50,031 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:48:50,035 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:48:50,038 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c008b, negotiated timeout = 40000
2023-03-20 21:48:50,039 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:48:50,040 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:48:50,040 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:48:50,042 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c008c, negotiated timeout = 40000
2023-03-20 21:48:50,047 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:48:50,049 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:48:50,053 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:48:50,054 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:48:50,055 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:48:50,056 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:48:50,058 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:48:50,058 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:48:50,058 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:48:50,059 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:48:50,060 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:48:50,060 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:48:50,060 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:48:50,060 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:48:50,060 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:48:50,063 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:48:50,063 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:48:50,064 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:48:50,065 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:48:50,065 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:48:50,065 INFO  [Thread-0] root: Connected to localhost on port 34912
2023-03-20 21:48:50,066 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:48:50,066 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:48:50,067 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:48:50,067 INFO  [Thread-2] root: Closing connection
2023-03-20 21:48:50,069 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:48:50,069 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:48:50,069 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:48:50,070 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:48:50,070 INFO  [Thread-0] root: Connected to localhost on port 34920
2023-03-20 21:48:50,071 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:48:50,072 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:48:50,073 INFO  [Thread-3] root: Closing connection
2023-03-20 21:48:50,072 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:48:52,953 INFO  [Thread-1] root: The hash range of the server being shut down: [Ljava.lang.String;@425a8f19
2023-03-20 21:48:52,953 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:48:52,953 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:48:52,954 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:48:52,955 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:48:52,955 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:48:52,955 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:48:52,956 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:48:52,957 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:48:52,958 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:48:52,958 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:48:52,959 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:48:52,960 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:48:52,960 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:48:52,960 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:48:52,961 INFO  [Thread-1] root: Closing connection
2023-03-20 21:48:52,961 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:48:52,962 INFO  [Thread-0] root: Connected to localhost on port 45674
2023-03-20 21:48:52,962 INFO  [Thread-2] root: Closing connection
2023-03-20 21:48:52,971 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:48:52,974 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:48:52,975 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:48:52,975 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:48:52,975 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:49:27,309 INFO  [Thread-1] root: The hash range of the server being shut down: [Ljava.lang.String;@f58896b
2023-03-20 21:50:18,022 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:50:18,022 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:50:18,023 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:50:18,024 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:50:18,024 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:50:18,025 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:50:18,026 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:50:18,026 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:50:18,027 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:50:18,027 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:50:18,028 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:50:18,028 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:50:18,029 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:50:18,030 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:50:18,031 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:50:18,032 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:50:18,045 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:50:18,049 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:50:18,054 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c008f, negotiated timeout = 40000
2023-03-20 21:50:18,056 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:50:18,056 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:50:18,056 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:50:18,058 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0090, negotiated timeout = 40000
2023-03-20 21:50:18,064 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:50:18,066 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:50:18,072 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:50:18,072 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:50:18,079 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:50:18,079 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:50:18,080 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:50:18,080 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:50:18,081 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:50:19,664 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:50:19,664 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:50:19,664 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:50:19,665 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:50:19,665 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:50:19,666 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:50:19,667 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:50:19,667 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:50:19,668 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:50:19,669 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:50:19,679 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:50:19,683 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:50:19,687 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0091, negotiated timeout = 40000
2023-03-20 21:50:19,688 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:50:19,689 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:50:19,689 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:50:19,691 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0092, negotiated timeout = 40000
2023-03-20 21:50:19,696 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:50:19,698 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:606)
2023-03-20 21:50:19,702 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:50:19,703 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:50:19,704 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:50:19,706 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:50:19,707 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:50:19,707 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:50:19,708 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:50:19,708 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:50:19,708 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:50:19,709 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:50:19,709 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:50:19,709 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:50:19,710 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:50:19,712 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:50:19,712 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:50:19,713 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:50:19,713 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:50:19,714 INFO  [Thread-0] root: Connected to localhost on port 46648
2023-03-20 21:50:19,714 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:50:19,715 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:50:19,715 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:50:19,716 INFO  [Thread-2] root: Closing connection
2023-03-20 21:50:19,717 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:50:19,718 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:50:19,718 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:50:19,718 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:50:19,720 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:50:19,720 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:50:19,720 INFO  [Thread-0] root: Connected to localhost on port 46662
2023-03-20 21:50:19,721 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:50:19,721 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:50:19,723 INFO  [Thread-3] root: Closing connection
2023-03-20 21:50:21,841 INFO  [Thread-1] root: The hash range of the server being shut down: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:50:21,841 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:50:21,841 INFO  [Thread-1] root: Transfering all data in key range [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:50:21,842 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:50:21,843 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:50:21,843 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:50:21,844 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:50:21,844 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:50:21,845 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:50:21,845 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:50:21,846 INFO  [Thread-1] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:50:21,847 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:50:21,847 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:50:21,847 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:50:21,848 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:50:21,848 INFO  [Thread-1] root: Closing connection
2023-03-20 21:50:21,848 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:50:21,849 INFO  [Thread-2] root: Closing connection
2023-03-20 21:50:21,849 INFO  [Thread-0] root: Connected to localhost on port 59266
2023-03-20 21:50:21,858 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:50:21,860 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:50:21,861 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:50:21,862 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:50:21,862 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:51:57,738 INFO  [Thread-1] root: The hash range of the server being shut down: [91d8c8e93642cca5c0f2be69d199ee23, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:52:29,406 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:52:29,406 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:52:29,407 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:52:29,407 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:52:29,408 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:52:29,409 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:52:29,409 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:52:29,410 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:52:29,410 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:52:29,411 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:52:29,411 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:52:29,412 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:52:29,412 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:52:29,413 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:52:29,414 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:52:29,414 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:52:29,423 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:52:29,427 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:52:29,431 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0095, negotiated timeout = 40000
2023-03-20 21:52:29,433 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:52:29,433 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:52:29,433 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:52:29,435 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0096, negotiated timeout = 40000
2023-03-20 21:52:29,440 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:52:29,442 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:52:29,446 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:52:29,447 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:52:29,454 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:52:29,455 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:52:29,456 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:52:29,456 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:52:29,456 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:30,880 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:52:30,880 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:52:30,881 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:52:30,881 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:52:30,881 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:52:30,882 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:52:30,882 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:52:30,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:52:30,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:52:30,883 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:52:30,884 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:52:30,884 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:52:30,885 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:52:30,885 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:52:30,886 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:52:30,887 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:52:30,896 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:52:30,900 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:52:30,904 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0097, negotiated timeout = 40000
2023-03-20 21:52:30,905 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:52:30,906 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:52:30,906 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:52:30,907 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0098, negotiated timeout = 40000
2023-03-20 21:52:30,913 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:52:30,916 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:52:30,920 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:30,922 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:52:30,922 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:52:30,924 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:52:30,924 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:52:30,924 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:52:30,925 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:52:30,925 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:52:30,926 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:52:30,926 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:52:30,926 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:52:30,927 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:30,927 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:52:30,930 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:52:30,930 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:52:30,930 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:52:30,931 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:52:30,931 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:52:30,931 INFO  [Thread-0] root: Connected to localhost on port 37142
2023-03-20 21:52:30,932 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:52:30,932 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:52:30,933 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:52:30,934 INFO  [Thread-2] root: Closing connection
2023-03-20 21:52:30,935 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:52:30,935 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:52:30,935 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:52:30,936 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:52:30,937 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:52:30,936 INFO  [Thread-0] root: Connected to localhost on port 37156
2023-03-20 21:52:30,938 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:52:30,938 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:52:30,939 INFO  [Thread-3] root: Closing connection
2023-03-20 21:52:34,382 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:52:34,382 INFO  [Thread-1] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:52:34,383 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:52:34,383 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:52:34,383 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:52:34,384 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:52:34,384 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:52:34,385 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:52:34,385 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:52:34,385 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:52:34,386 INFO  [Thread-1] root: Transferring key: this
2023-03-20 21:52:34,387 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:52:34,387 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:52:34,387 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:52:34,388 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:52:34,388 INFO  [Thread-2] root: Recieved message with raw bytes [B@6698c10d
2023-03-20 21:52:34,389 INFO  [Thread-0] root: Connected to localhost on port 38898
2023-03-20 21:52:34,389 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:52:34,390 INFO  [Thread-2] root: Message: DATATRANSFERthisthere

2023-03-20 21:52:34,391 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:52:34,395 INFO  [Thread-2] root: Added key 'this' and value 'there' to the database
2023-03-20 21:52:34,395 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:52:34,395 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:52:34,395 INFO  [Thread-1] root: Recieved message with raw bytes [B@60edd8c5
2023-03-20 21:52:34,395 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:52:34,395 INFO  [Thread-1] root: Message: PUT_SUCCESSthisthere

2023-03-20 21:52:34,395 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:52:34,396 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:52:34,396 INFO  [Thread-1] root: Closing connection
2023-03-20 21:52:34,397 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:52:34,398 INFO  [Thread-2] root: Closing connection
2023-03-20 21:52:34,406 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:34,408 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:52:34,409 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:52:34,410 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:52:34,410 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:48,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:52:48,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:52:48,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:52:48,643 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:52:48,643 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:52:48,644 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:52:48,644 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:52:48,644 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:52:48,645 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:52:48,646 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:52:48,646 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:52:48,646 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:52:48,647 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:52:48,647 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:52:48,648 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:52:48,649 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:52:48,657 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:52:48,661 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:52:48,665 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c0099, negotiated timeout = 40000
2023-03-20 21:52:48,667 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:52:48,667 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:52:48,667 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:52:48,669 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c009a, negotiated timeout = 40000
2023-03-20 21:52:48,674 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:52:48,676 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:52:48,680 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:48,680 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:52:48,682 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 21:52:48,683 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 21:52:48,684 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:52:48,684 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:52:48,685 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:52:48,685 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 21:52:48,686 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:52:48,686 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 21:52:48,686 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:52:48,687 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:52:48,688 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 21:52:48,688 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:52:48,688 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:52:48,688 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:52:48,688 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:52:48,689 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 21:52:48,691 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:52:48,691 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:52:48,691 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:52:48,693 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:52:48,693 INFO  [Thread-0] root: Connected to localhost on port 37972
2023-03-20 21:52:48,693 INFO  [Thread-2] root: Recieved message with raw bytes [B@659ae474
2023-03-20 21:52:48,694 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:52:48,695 INFO  [Thread-2] root: Message: DATATRANSFERthisthere

2023-03-20 21:52:48,695 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:52:48,699 INFO  [Thread-2] root: Added key 'this' and value 'there' to the database
2023-03-20 21:52:48,699 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:52:48,699 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:52:48,699 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c1d9636
2023-03-20 21:52:48,699 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:52:48,700 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthere

2023-03-20 21:52:48,700 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:52:48,700 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:52:48,700 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:52:48,700 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:52:48,700 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 21:52:48,700 INFO  [Thread-2] root: Closing connection
2023-03-20 21:52:48,701 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:52:48,702 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 21:52:48,703 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 21:52:48,703 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:52:48,703 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:52:48,704 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 21:52:48,704 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:52:48,704 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 21:52:48,705 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 21:52:48,706 INFO  [Thread-0] root: Connected to localhost on port 37982
2023-03-20 21:52:48,706 INFO  [main-EventThread] root: Closing connection
2023-03-20 21:52:48,707 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:52:48,708 INFO  [Thread-3] root: Closing connection
2023-03-20 21:52:48,707 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 21:53:07,448 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:53:07,449 INFO  [Thread-0] root: Connected to localhost on port 47014
2023-03-20 21:53:12,392 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:53:12,392 INFO  [Thread-4] root: Closing connection
2023-03-20 21:53:15,635 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:53:15,637 INFO  [Thread-0] root: Connected to localhost on port 57464
2023-03-20 21:53:18,133 INFO  [Thread-3] root: Recieved message with raw bytes [B@1ecc2f06
2023-03-20 21:53:18,133 INFO  [Thread-3] root: Raw bytes: [71, 69, 84, 31, 104, 101, 114, 101, 31, 31, 10]
2023-03-20 21:53:18,133 INFO  [Thread-3] root: Message: GEThere

2023-03-20 21:53:18,134 INFO  [Thread-3] root: Received a message of type 'GET' with key 'here' and value ''
2023-03-20 21:53:18,134 INFO  [Thread-3] root: SERVER_IDLE
2023-03-20 21:53:18,134 INFO  [Thread-3] root: SERVER_IDLE
2023-03-20 21:53:18,134 INFO  [Thread-3] root: false
2023-03-20 21:53:18,134 INFO  [Thread-3] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:53:18,134 INFO  [Thread-3] root: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:53:18,134 INFO  [Thread-3] root: THE KEY IS: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:53:18,135 INFO  [Thread-3] root: THE RANGE LOWER IS: 6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 21:53:18,135 INFO  [Thread-3] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:53:18,136 INFO  [Thread-3] root: key.compareTo(hashRange[0]) > 0: true
2023-03-20 21:53:18,137 INFO  [Thread-3] root: key.compareTo(hashRange[1] true
2023-03-20 21:53:18,138 ERROR [Thread-3] root: Key 'here' is not in the database
2023-03-20 21:53:18,138 INFO  [Thread-3] root: MESSAGE TO SEND: 
2023-03-20 21:53:18,139 INFO  [Thread-3] root: Sent a message of type 'GET_ERROR' with key 'here' and value ''
2023-03-20 21:53:33,756 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:53:33,756 INFO  [Thread-3] root: Closing connection
2023-03-20 21:53:37,197 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8082
2023-03-20 21:53:37,197 INFO  [Thread-1] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:53:37,198 INFO  [Thread-1] root: Checking key key: here
2023-03-20 21:53:37,198 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:53:37,199 INFO  [Thread-1] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 21:53:37,199 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:53:37,200 INFO  [Thread-1] root: Checking key key: this
2023-03-20 21:53:37,201 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 21:53:37,201 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 21:53:37,202 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 21:53:37,202 INFO  [Thread-1] root: Transferring key: this
2023-03-20 21:53:37,203 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 21:53:37,203 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:53:37,203 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 21:53:37,205 INFO  [Thread-0] root: Connected to localhost on port 35538
2023-03-20 21:53:37,205 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:53:37,205 INFO  [Thread-4] root: Recieved message with raw bytes [B@40c3bf35
2023-03-20 21:53:37,206 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:53:37,206 INFO  [Thread-4] root: Message: DATATRANSFERthisthere

2023-03-20 21:53:37,207 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 21:53:37,209 INFO  [Thread-4] root: Added key 'this' and value 'there' to the database
2023-03-20 21:53:37,209 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 21:53:37,209 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:53:37,209 INFO  [Thread-1] root: Recieved message with raw bytes [B@2262de93
2023-03-20 21:53:37,209 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:53:37,209 INFO  [Thread-1] root: Message: PUT_SUCCESSthisthere

2023-03-20 21:53:37,209 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 21:53:37,209 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 21:53:37,209 INFO  [Thread-1] root: Closing connection
2023-03-20 21:53:37,209 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 21:53:37,210 INFO  [Thread-4] root: Closing connection
2023-03-20 21:53:37,215 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:53:37,218 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:53:37,219 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:53:37,219 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:53:37,220 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:59:26,027 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 21:59:26,027 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 21:59:26,028 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 21:59:26,029 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 21:59:26,029 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 21:59:26,030 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 21:59:26,030 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 21:59:26,031 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 21:59:26,032 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 21:59:26,032 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 21:59:26,033 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 21:59:26,033 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 21:59:26,034 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 21:59:26,035 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 21:59:26,035 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 21:59:26,036 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 21:59:26,045 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:59:26,049 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:59:26,054 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c009d, negotiated timeout = 40000
2023-03-20 21:59:26,055 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 21:59:26,056 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 21:59:26,056 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 21:59:26,057 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c009e, negotiated timeout = 40000
2023-03-20 21:59:26,062 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:59:26,064 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 21:59:26,069 INFO  [Thread-0] root: Initialize server ...
2023-03-20 21:59:26,070 INFO  [Thread-0] root: Server listening on port: 8082
2023-03-20 21:59:26,076 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 21:59:26,077 INFO  [main-EventThread] root: 127.0.0.1:8082,127.0.0.1,8082,91d8c8e93642cca5c0f2be69d199ee23,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 21:59:26,078 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee23:91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:26,078 INFO  [main-EventThread] root: 127.0.0.1:8082 was added and is obtaining keys from successor
2023-03-20 21:59:26,079 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 21:59:47,927 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 21:59:47,929 INFO  [Thread-0] root: Connected to localhost on port 58998
2023-03-20 21:59:51,118 INFO  [Thread-2] root: Recieved message with raw bytes [B@4b8a0f95
2023-03-20 21:59:51,118 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 21:59:51,118 INFO  [Thread-2] root: Message: PUThithere

2023-03-20 21:59:51,118 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'hi' and value 'there'
2023-03-20 21:59:51,119 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:51,120 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:59:51,121 INFO  [Thread-2] root: THE KEY IS: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 21:59:51,121 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:59:51,122 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:51,123 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:59:51,123 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 21:59:51,124 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:51,125 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:59:51,126 INFO  [Thread-2] root: THE KEY IS: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 21:59:51,126 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:59:51,126 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:51,127 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:59:51,127 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 21:59:51,132 INFO  [Thread-2] root: Added key 'hi' and value 'there' to the database
2023-03-20 21:59:51,132 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 21:59:51,132 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 21:59:58,038 INFO  [Thread-2] root: Recieved message with raw bytes [B@3188f9a7
2023-03-20 21:59:58,038 INFO  [Thread-2] root: Raw bytes: [80, 85, 84, 31, 106, 111, 101, 31, 98, 97, 100, 31, 10]
2023-03-20 21:59:58,038 INFO  [Thread-2] root: Message: PUTjoebad

2023-03-20 21:59:58,038 INFO  [Thread-2] root: Received a message of type 'PUT' with key 'joe' and value 'bad'
2023-03-20 21:59:58,038 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:58,038 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:59:58,038 INFO  [Thread-2] root: THE KEY IS: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 21:59:58,039 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:59:58,040 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:58,040 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:59:58,041 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 21:59:58,042 INFO  [Thread-2] root: This server's IP:Port Hash91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:58,042 INFO  [Thread-2] root: [91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 21:59:58,043 INFO  [Thread-2] root: THE KEY IS: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 21:59:58,043 INFO  [Thread-2] root: THE RANGE LOWER IS: 91d8c8e93642cca5c0f2be69d199ee23
2023-03-20 21:59:58,044 INFO  [Thread-2] root: THE RANGE UPPER IS: 91d8c8e93642cca5c0f2be69d199ee22
2023-03-20 21:59:58,044 INFO  [Thread-2] root: key.compareTo(hashRange[0]) < 0: true
2023-03-20 21:59:58,045 INFO  [Thread-2] root: key.compareTo(hashRange[1]) > 0 false
2023-03-20 21:59:58,047 INFO  [Thread-2] root: Added key 'joe' and value 'bad' to the database
2023-03-20 21:59:58,047 INFO  [Thread-2] root: MESSAGE TO SEND: bad
2023-03-20 21:59:58,047 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'joe' and value 'bad'
2023-03-20 22:00:01,618 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 22:00:01,618 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 22:00:01,618 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 22:00:01,619 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 22:00:01,619 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 22:00:01,619 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 22:00:01,620 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 22:00:01,621 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 22:00:01,621 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 22:00:01,621 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 22:00:01,621 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 22:00:01,621 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 22:00:01,622 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 22:00:01,622 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 22:00:01,622 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 22:00:01,622 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 22:00:01,631 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 22:00:01,635 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 22:00:01,641 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c009f, negotiated timeout = 40000
2023-03-20 22:00:01,642 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 22:00:01,643 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 22:00:01,643 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 22:00:01,645 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c00a0, negotiated timeout = 40000
2023-03-20 22:00:01,650 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 22:00:01,652 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 22:00:01,656 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:01,657 INFO  [Thread-0] root: Initialize server ...
2023-03-20 22:00:01,658 INFO  [Thread-0] root: Server listening on port: 8083
2023-03-20 22:00:01,659 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 22:00:01,660 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:01,660 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 22:00:01,660 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8082,127.0.0.1,8082,6a93711a8c3f9c2641dfc71c359a1abe,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:01,661 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:01,661 INFO  [main-EventThread] root: 127.0.0.1:8083 was added and is obtaining keys from successor
2023-03-20 22:00:01,661 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:01,662 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 22:00:01,662 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:01,663 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 22:00:01,664 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 22:00:01,664 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:01,665 INFO  [main-EventThread] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:01,665 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:01,666 INFO  [main-EventThread] root: Transferring key: hi
2023-03-20 22:00:01,666 INFO  [main-EventThread] root: Checking key key: joe
2023-03-20 22:00:01,667 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:01,667 INFO  [main-EventThread] root: Key: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 22:00:01,668 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:01,668 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 22:00:01,669 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:01,669 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:01,670 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:01,670 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 22:00:01,673 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 22:00:01,673 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:01,673 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 22:00:01,674 INFO  [Thread-2] root: Recieved message with raw bytes [B@c988c38
2023-03-20 22:00:01,674 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:01,674 INFO  [Thread-0] root: Connected to localhost on port 39204
2023-03-20 22:00:01,674 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:01,676 INFO  [Thread-2] root: Message: DATATRANSFERhithere

2023-03-20 22:00:01,677 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:01,681 INFO  [Thread-2] root: Added key 'hi' and value 'there' to the database
2023-03-20 22:00:01,681 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 22:00:01,682 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:01,682 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7c7ebbb3
2023-03-20 22:00:01,682 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:01,682 INFO  [main-EventThread] root: Message: PUT_SUCCESShithere

2023-03-20 22:00:01,682 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:01,683 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:01,683 INFO  [Thread-2] root: Recieved message with raw bytes [B@5774654c
2023-03-20 22:00:01,683 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:01,684 INFO  [Thread-2] root: Message: DATATRANSFERthisthere

2023-03-20 22:00:01,684 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:01,686 INFO  [Thread-2] root: Added key 'this' and value 'there' to the database
2023-03-20 22:00:01,686 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 22:00:01,686 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:01,686 INFO  [main-EventThread] root: Recieved message with raw bytes [B@65078f26
2023-03-20 22:00:01,686 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:01,686 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthere

2023-03-20 22:00:01,686 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:01,686 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 22:00:01,686 INFO  [main-EventThread] root: Closing connection
2023-03-20 22:00:01,687 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:01,687 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8083
2023-03-20 22:00:01,687 INFO  [Thread-2] root: Closing connection
2023-03-20 22:00:01,688 INFO  [main-EventThread] root: Transfering all data in key range [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 22:00:01,689 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 22:00:01,690 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:01,690 INFO  [main-EventThread] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:01,691 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 22:00:01,691 INFO  [main-EventThread] root: Checking key key: joe
2023-03-20 22:00:01,692 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:01,692 INFO  [main-EventThread] root: Key: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 22:00:01,693 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 22:00:01,693 INFO  [main-EventThread] root: Transferring key: joe
2023-03-20 22:00:01,694 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 22:00:01,695 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:01,695 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:01,696 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 91d8c8e93642cca5c0f2be69d199ee22]
2023-03-20 22:00:01,696 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 22:00:01,696 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:01,697 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8083
2023-03-20 22:00:01,698 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'joe' and value 'bad'
2023-03-20 22:00:01,698 INFO  [Thread-3] root: Recieved message with raw bytes [B@2d2b1e3e
2023-03-20 22:00:01,698 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 106, 111, 101, 31, 98, 97, 100, 31, 10]
2023-03-20 22:00:01,698 INFO  [Thread-3] root: Message: DATATRANSFERjoebad

2023-03-20 22:00:01,698 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'joe' and value 'bad'
2023-03-20 22:00:01,698 INFO  [Thread-0] root: Connected to localhost on port 39212
2023-03-20 22:00:01,699 INFO  [Thread-3] root: Added key 'joe' and value 'bad' to the database
2023-03-20 22:00:01,699 INFO  [Thread-3] root: MESSAGE TO SEND: bad
2023-03-20 22:00:01,700 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'joe' and value 'bad'
2023-03-20 22:00:01,700 INFO  [main-EventThread] root: Recieved message with raw bytes [B@6644c610
2023-03-20 22:00:01,700 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 106, 111, 101, 31, 98, 97, 100, 31, 10]
2023-03-20 22:00:01,700 INFO  [main-EventThread] root: Message: PUT_SUCCESSjoebad

2023-03-20 22:00:01,700 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'joe' and value 'bad'
2023-03-20 22:00:01,700 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 22:00:01,700 INFO  [main-EventThread] root: Closing connection
2023-03-20 22:00:01,701 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:01,701 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:01,701 INFO  [Thread-3] root: Closing connection
2023-03-20 22:00:03,358 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 22:00:03,358 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 22:00:03,358 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 22:00:03,359 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 22:00:03,360 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 22:00:03,360 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 22:00:03,361 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 22:00:03,362 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 22:00:03,362 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 22:00:03,363 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 22:00:03,364 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 22:00:03,364 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 22:00:03,365 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 22:00:03,365 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 22:00:03,366 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 22:00:03,367 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 22:00:03,375 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 22:00:03,379 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 22:00:03,383 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c00a1, negotiated timeout = 40000
2023-03-20 22:00:03,385 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 22:00:03,385 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 22:00:03,386 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 22:00:03,387 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c00a2, negotiated timeout = 40000
2023-03-20 22:00:03,392 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 22:00:03,394 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 22:00:03,398 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:03,399 INFO  [Thread-0] root: Initialize server ...
2023-03-20 22:00:03,399 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:03,400 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 22:00:03,402 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 22:00:03,403 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:03,404 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 22:00:03,404 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 22:00:03,404 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:03,405 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:03,405 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,6a93711a8c3f9c2641dfc71c359a1abe,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:03,406 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:03,406 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:03,407 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:03,407 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:03,408 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 22:00:03,408 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 22:00:03,409 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 22:00:03,410 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 22:00:03,410 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,410 INFO  [main-EventThread] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:03,411 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-20 22:00:03,411 INFO  [main-EventThread] root: Checking key key: joe
2023-03-20 22:00:03,412 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,412 INFO  [main-EventThread] root: Key: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 22:00:03,413 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-20 22:00:03,413 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 22:00:03,414 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,414 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:03,415 INFO  [main-EventThread] root: HashRange: [6a93711a8c3f9c2641dfc71c359a1abe, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-20 22:00:03,417 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 22:00:03,417 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:03,417 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 22:00:03,418 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 22:00:03,419 INFO  [main-EventThread] root: Closing connection
2023-03-20 22:00:03,419 INFO  [Thread-0] root: Connected to localhost on port 49542
2023-03-20 22:00:03,419 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 22:00:03,419 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:03,421 INFO  [Thread-2] root: Closing connection
2023-03-20 22:00:03,421 INFO  [main-EventThread] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:03,423 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 22:00:03,423 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,423 INFO  [main-EventThread] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 22:00:03,424 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:03,424 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 22:00:03,425 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,425 INFO  [main-EventThread] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:03,426 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:03,426 INFO  [main-EventThread] root: Transferring key: hi
2023-03-20 22:00:03,427 INFO  [main-EventThread] root: Checking key key: joe
2023-03-20 22:00:03,427 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,428 INFO  [main-EventThread] root: Key: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 22:00:03,428 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:03,428 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 22:00:03,429 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:03,429 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:03,430 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:03,431 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 22:00:03,431 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 22:00:03,431 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:03,432 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 22:00:03,433 INFO  [Thread-0] root: Connected to localhost on port 49546
2023-03-20 22:00:03,433 INFO  [Thread-3] root: Recieved message with raw bytes [B@5996bc0
2023-03-20 22:00:03,433 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:03,434 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:03,435 INFO  [Thread-3] root: Message: DATATRANSFERhithere

2023-03-20 22:00:03,436 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:03,440 INFO  [Thread-3] root: Added key 'hi' and value 'there' to the database
2023-03-20 22:00:03,440 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 22:00:03,440 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:03,440 INFO  [main-EventThread] root: Recieved message with raw bytes [B@e7d8a21
2023-03-20 22:00:03,440 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:03,440 INFO  [main-EventThread] root: Message: PUT_SUCCESShithere

2023-03-20 22:00:03,440 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:03,440 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:03,440 INFO  [Thread-3] root: Recieved message with raw bytes [B@3051a1af
2023-03-20 22:00:03,440 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:03,441 INFO  [Thread-3] root: Message: DATATRANSFERthisthere

2023-03-20 22:00:03,442 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:03,443 INFO  [Thread-3] root: Added key 'this' and value 'there' to the database
2023-03-20 22:00:03,443 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 22:00:03,443 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Recieved message with raw bytes [B@3ab04ac4
2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthere

2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Closing connection
2023-03-20 22:00:03,443 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:03,443 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 22:00:03,444 INFO  [Thread-3] root: Closing connection
2023-03-20 22:00:20,171 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 22:00:20,171 INFO  [Thread-1] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:20,172 INFO  [Thread-1] root: Checking key key: hi
2023-03-20 22:00:20,172 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 22:00:20,173 INFO  [Thread-1] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:20,174 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:20,174 INFO  [Thread-1] root: Transferring key: hi
2023-03-20 22:00:20,175 INFO  [Thread-1] root: Checking key key: this
2023-03-20 22:00:20,176 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 22:00:20,176 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:20,177 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:20,177 INFO  [Thread-1] root: Transferring key: this
2023-03-20 22:00:20,177 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 22:00:20,177 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:20,178 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 22:00:20,179 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:20,179 INFO  [Thread-3] root: Recieved message with raw bytes [B@70901606
2023-03-20 22:00:20,179 INFO  [Thread-0] root: Connected to localhost on port 49242
2023-03-20 22:00:20,180 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:20,181 INFO  [Thread-3] root: Message: DATATRANSFERhithere

2023-03-20 22:00:20,182 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:20,183 INFO  [Thread-3] root: Added key 'hi' and value 'there' to the database
2023-03-20 22:00:20,183 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 22:00:20,183 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:20,183 INFO  [Thread-1] root: Recieved message with raw bytes [B@50a79114
2023-03-20 22:00:20,183 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:20,183 INFO  [Thread-1] root: Message: PUT_SUCCESShithere

2023-03-20 22:00:20,183 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:20,184 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:20,184 INFO  [Thread-3] root: Recieved message with raw bytes [B@7e57e664
2023-03-20 22:00:20,185 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:20,185 INFO  [Thread-3] root: Message: DATATRANSFERthisthere

2023-03-20 22:00:20,186 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:20,187 INFO  [Thread-3] root: Added key 'this' and value 'there' to the database
2023-03-20 22:00:20,187 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 22:00:20,187 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:20,187 INFO  [Thread-1] root: Recieved message with raw bytes [B@5e607570
2023-03-20 22:00:20,187 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:20,187 INFO  [Thread-1] root: Message: PUT_SUCCESSthisthere

2023-03-20 22:00:20,187 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:20,187 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 22:00:20,187 INFO  [Thread-1] root: Closing connection
2023-03-20 22:00:20,187 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:20,188 INFO  [Thread-3] root: Closing connection
2023-03-20 22:00:20,193 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:20,194 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:20,197 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 22:00:20,197 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 22:00:20,198 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:20,199 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:20,200 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:41,288 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.4.11-37e277162d567b55a07d1755f0b31c32e93c01a0, built on 11/01/2017 18:06 GMT
2023-03-20 22:00:41,288 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:host.name=ug227.eecg.toronto.edu
2023-03-20 22:00:41,288 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.18
2023-03-20 22:00:41,289 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Debian
2023-03-20 22:00:41,290 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/usr/lib/jvm/java-11-openjdk-amd64
2023-03-20 22:00:41,290 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=m2-server.jar
2023-03-20 22:00:41,291 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/usr/java/packages/lib:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2023-03-20 22:00:41,292 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/tmp
2023-03-20 22:00:41,292 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2023-03-20 22:00:41,293 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Linux
2023-03-20 22:00:41,293 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=amd64
2023-03-20 22:00:41,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:os.version=5.10.0-21-amd64
2023-03-20 22:00:41,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.name=tranjus3
2023-03-20 22:00:41,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/homes/t/tranjus3
2023-03-20 22:00:41,294 INFO  [main] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/nfs/ug/homes-1/t/tranjus3/ece419/m3
2023-03-20 22:00:41,295 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=ecs.ECS$5@768debd
2023-03-20 22:00:41,303 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 22:00:41,307 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 22:00:41,311 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c00a3, negotiated timeout = 40000
2023-03-20 22:00:41,313 INFO  [main] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=300000000 watcher=shared.zookeeper_comms.ZKConnection$1@7bb11784
2023-03-20 22:00:41,313 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2023-03-20 22:00:41,314 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session
2023-03-20 22:00:41,315 INFO  [main-SendThread(127.0.0.1:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x10043ed228c00a4, negotiated timeout = 40000
2023-03-20 22:00:41,320 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /workers
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createWorkersNode(ECS.java:333)
	at ecs.ECS.initializeZK(ECS.java:153)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 22:00:41,322 ERROR [main] root: Unable to create znodes
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /server_status
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:122)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:786)
	at shared.zookeeper_comms.ZKManagerImpl.create(ZKManagerImpl.java:34)
	at ecs.ECS.createServerNode(ECS.java:381)
	at ecs.ECS.initializeZK(ECS.java:154)
	at ecs.ECS.<init>(ECS.java:56)
	at app_kvECS.ECSClient.<init>(ECSClient.java:38)
	at app_kvServer.KVServer.<init>(KVServer.java:96)
	at app_kvServer.KVServer.<init>(KVServer.java:68)
	at app_kvServer.KVServer.main(KVServer.java:609)
2023-03-20 22:00:41,327 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:41,327 INFO  [Thread-0] root: Initialize server ...
2023-03-20 22:00:41,328 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 22:00:41,328 INFO  [Thread-0] root: Server listening on port: 8084
2023-03-20 22:00:41,329 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 22:00:41,330 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:41,330 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8084
2023-03-20 22:00:41,331 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:41,331 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8082
2023-03-20 22:00:41,332 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:41,333 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:41,333 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;127.0.0.1:8082,127.0.0.1,8082,85d27949e81cbe4c3d605c59cd7d7dc3,91d8c8e93642cca5c0f2be69d199ee22,16;
2023-03-20 22:00:41,333 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:41,334 INFO  [main-EventThread] root: 127.0.0.1:8084 was added and is obtaining keys from successor
2023-03-20 22:00:41,334 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:41,334 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:41,334 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8082to node 127.0.0.1:8084
2023-03-20 22:00:41,335 INFO  [main-EventThread] root: Transfering all data in key range null
2023-03-20 22:00:41,337 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 22:00:41,337 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,337 INFO  [main-EventThread] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:41,338 INFO  [main-EventThread] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-20 22:00:41,338 INFO  [main-EventThread] root: Transferring key: hi
2023-03-20 22:00:41,339 INFO  [main-EventThread] root: Checking key key: joe
2023-03-20 22:00:41,340 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,340 INFO  [main-EventThread] root: Key: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 22:00:41,341 INFO  [main-EventThread] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-20 22:00:41,341 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 22:00:41,342 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,342 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:41,343 INFO  [main-EventThread] root: HashRange: [d41d8cd98f00b204e9800998ecf8427e, 85d27949e81cbe4c3d605c59cd7d7dc3]
2023-03-20 22:00:41,345 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 22:00:41,345 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:41,346 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 22:00:41,347 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:41,347 INFO  [Thread-0] root: Connected to localhost on port 55140
2023-03-20 22:00:41,347 INFO  [Thread-2] root: Recieved message with raw bytes [B@1ae203e5
2023-03-20 22:00:41,348 INFO  [Thread-2] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:41,349 INFO  [Thread-2] root: Message: DATATRANSFERhithere

2023-03-20 22:00:41,349 INFO  [Thread-2] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:41,354 INFO  [Thread-2] root: Added key 'hi' and value 'there' to the database
2023-03-20 22:00:41,354 INFO  [Thread-2] root: MESSAGE TO SEND: there
2023-03-20 22:00:41,354 INFO  [Thread-2] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:41,354 INFO  [main-EventThread] root: Recieved message with raw bytes [B@164ea6b6
2023-03-20 22:00:41,354 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:41,354 INFO  [main-EventThread] root: Message: PUT_SUCCESShithere

2023-03-20 22:00:41,354 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:41,354 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 22:00:41,354 INFO  [main-EventThread] root: Closing connection
2023-03-20 22:00:41,354 INFO  [main-EventThread] root: I am here transfering node data from 127.0.0.1:8083to node 127.0.0.1:8084
2023-03-20 22:00:41,355 INFO  [main-EventThread] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:41,354 ERROR [Thread-2] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:41,356 INFO  [main-EventThread] root: Checking key key: here
2023-03-20 22:00:41,356 INFO  [Thread-2] root: Closing connection
2023-03-20 22:00:41,357 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,358 INFO  [main-EventThread] root: Key: 6c92285fa6d3e827b198d120ea3ac674
2023-03-20 22:00:41,359 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:41,359 INFO  [main-EventThread] root: Checking key key: hi
2023-03-20 22:00:41,360 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,361 INFO  [main-EventThread] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:41,361 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:41,362 INFO  [main-EventThread] root: Transferring key: hi
2023-03-20 22:00:41,362 INFO  [main-EventThread] root: Checking key key: joe
2023-03-20 22:00:41,363 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,364 INFO  [main-EventThread] root: Key: 8ff32489f92f33416694be8fdc2d4c22
2023-03-20 22:00:41,364 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:41,365 INFO  [main-EventThread] root: Checking key key: this
2023-03-20 22:00:41,366 INFO  [main-EventThread] root: Checking if key is in specified hash range
2023-03-20 22:00:41,366 INFO  [main-EventThread] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:41,367 INFO  [main-EventThread] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:41,367 INFO  [main-EventThread] root: Transferring key: this
2023-03-20 22:00:41,368 INFO  [main-EventThread] root: Socket timeout: 0
2023-03-20 22:00:41,368 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:41,369 INFO  [main-EventThread] root: connected to address 127.0.0.1 at port 8084
2023-03-20 22:00:41,370 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:41,370 INFO  [Thread-3] root: Recieved message with raw bytes [B@7fedd162
2023-03-20 22:00:41,370 INFO  [Thread-0] root: Connected to localhost on port 55154
2023-03-20 22:00:41,371 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:41,372 INFO  [Thread-3] root: Message: DATATRANSFERhithere

2023-03-20 22:00:41,373 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:41,374 INFO  [Thread-3] root: Added key 'hi' and value 'there' to the database
2023-03-20 22:00:41,374 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 22:00:41,374 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:41,374 INFO  [main-EventThread] root: Recieved message with raw bytes [B@61eee46
2023-03-20 22:00:41,374 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:41,374 INFO  [main-EventThread] root: Message: PUT_SUCCESShithere

2023-03-20 22:00:41,374 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:41,375 INFO  [main-EventThread] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:41,375 INFO  [Thread-3] root: Recieved message with raw bytes [B@712a30ef
2023-03-20 22:00:41,375 INFO  [Thread-3] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:41,375 INFO  [Thread-3] root: Message: DATATRANSFERthisthere

2023-03-20 22:00:41,375 INFO  [Thread-3] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:41,377 INFO  [Thread-3] root: Added key 'this' and value 'there' to the database
2023-03-20 22:00:41,377 INFO  [Thread-3] root: MESSAGE TO SEND: there
2023-03-20 22:00:41,377 INFO  [Thread-3] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:41,377 INFO  [main-EventThread] root: Recieved message with raw bytes [B@7637965f
2023-03-20 22:00:41,377 INFO  [main-EventThread] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:41,377 INFO  [main-EventThread] root: Message: PUT_SUCCESSthisthere

2023-03-20 22:00:41,377 INFO  [main-EventThread] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:41,377 INFO  [main-EventThread] root: Client is closing communication!
2023-03-20 22:00:41,377 INFO  [main-EventThread] root: Closing connection
2023-03-20 22:00:41,377 ERROR [Thread-3] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:41,378 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8084
2023-03-20 22:00:41,378 INFO  [Thread-3] root: Closing connection
2023-03-20 22:00:53,584 INFO  [Thread-1] root: I am here transfering node data from 127.0.0.1:8084to node 127.0.0.1:8082
2023-03-20 22:00:53,584 INFO  [Thread-1] root: Transfering all data in key range [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:53,585 INFO  [Thread-1] root: Checking key key: hi
2023-03-20 22:00:53,585 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 22:00:53,586 INFO  [Thread-1] root: Key: 49f68a5c8493ec2c0bf489821c21fc3b
2023-03-20 22:00:53,586 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:53,587 INFO  [Thread-1] root: Transferring key: hi
2023-03-20 22:00:53,588 INFO  [Thread-1] root: Checking key key: this
2023-03-20 22:00:53,588 INFO  [Thread-1] root: Checking if key is in specified hash range
2023-03-20 22:00:53,589 INFO  [Thread-1] root: Key: 9e925e9341b490bfd3b4c4ca3b0c1ef2
2023-03-20 22:00:53,589 INFO  [Thread-1] root: HashRange: [91d8c8e93642cca5c0f2be69d199ee22, 6a93711a8c3f9c2641dfc71c359a1abe]
2023-03-20 22:00:53,589 INFO  [Thread-1] root: Transferring key: this
2023-03-20 22:00:53,589 INFO  [Thread-1] root: Socket timeout: 0
2023-03-20 22:00:53,589 INFO  [Thread-0] root: Socket timeout: 0
2023-03-20 22:00:53,589 INFO  [Thread-1] root: connected to address 127.0.0.1 at port 8082
2023-03-20 22:00:53,590 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:53,590 INFO  [Thread-4] root: Recieved message with raw bytes [B@61e8830e
2023-03-20 22:00:53,591 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:53,591 INFO  [Thread-0] root: Connected to localhost on port 45182
2023-03-20 22:00:53,591 INFO  [Thread-4] root: Message: DATATRANSFERhithere

2023-03-20 22:00:53,592 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'hi' and value 'there'
2023-03-20 22:00:53,594 INFO  [Thread-4] root: Added key 'hi' and value 'there' to the database
2023-03-20 22:00:53,594 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 22:00:53,594 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:53,594 INFO  [Thread-1] root: Recieved message with raw bytes [B@108a82da
2023-03-20 22:00:53,594 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 104, 105, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:53,594 INFO  [Thread-1] root: Message: PUT_SUCCESShithere

2023-03-20 22:00:53,594 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'hi' and value 'there'
2023-03-20 22:00:53,594 INFO  [Thread-1] root: Sent a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:53,594 INFO  [Thread-4] root: Recieved message with raw bytes [B@6f2f7143
2023-03-20 22:00:53,594 INFO  [Thread-4] root: Raw bytes: [68, 65, 84, 65, 84, 82, 65, 78, 83, 70, 69, 82, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:53,594 INFO  [Thread-4] root: Message: DATATRANSFERthisthere

2023-03-20 22:00:53,595 INFO  [Thread-4] root: Received a message of type 'DATATRANSFER' with key 'this' and value 'there'
2023-03-20 22:00:53,596 INFO  [Thread-4] root: Added key 'this' and value 'there' to the database
2023-03-20 22:00:53,596 INFO  [Thread-4] root: MESSAGE TO SEND: there
2023-03-20 22:00:53,596 INFO  [Thread-4] root: Sent a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:53,596 INFO  [Thread-1] root: Recieved message with raw bytes [B@1e4d7ebb
2023-03-20 22:00:53,596 INFO  [Thread-1] root: Raw bytes: [80, 85, 84, 95, 83, 85, 67, 67, 69, 83, 83, 31, 116, 104, 105, 115, 31, 116, 104, 101, 114, 101, 31, 10]
2023-03-20 22:00:53,596 INFO  [Thread-1] root: Message: PUT_SUCCESSthisthere

2023-03-20 22:00:53,596 INFO  [Thread-1] root: Received a message of type 'PUT_SUCCESS' with key 'this' and value 'there'
2023-03-20 22:00:53,596 INFO  [Thread-1] root: Client is closing communication!
2023-03-20 22:00:53,596 INFO  [Thread-1] root: Closing connection
2023-03-20 22:00:53,596 ERROR [Thread-4] root: Error! Connection lost!
java.io.IOException: Input stream closed
	at shared.communication.KVCommunication.receiveMessage(KVCommunication.java:63)
	at app_kvServer.TempClientConnection.run(TempClientConnection.java:50)
	at java.base/java.lang.Thread.run(Thread.java:829)
2023-03-20 22:00:53,597 INFO  [Thread-4] root: Closing connection
2023-03-20 22:00:53,603 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:53,604 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
2023-03-20 22:00:53,607 INFO  [main-EventThread] root: Server status change on /workers/127.0.0.1:8083
2023-03-20 22:00:53,608 INFO  [main-EventThread] root: 127.0.0.1:8083,127.0.0.1,8083,91d8c8e93642cca5c0f2be69d199ee22,6a93711a8c3f9c2641dfc71c359a1abe,16;127.0.0.1:8084,127.0.0.1,8084,d41d8cd98f00b204e9800998ecf8427e,85d27949e81cbe4c3d605c59cd7d7dc3,16;
2023-03-20 22:00:53,609 INFO  [main-EventThread] root: 91d8c8e93642cca5c0f2be69d199ee22:6a93711a8c3f9c2641dfc71c359a1abe
2023-03-20 22:00:53,609 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8082
2023-03-20 22:00:53,610 INFO  [main-EventThread] root: Server status change on /server_status/127.0.0.1:8083
